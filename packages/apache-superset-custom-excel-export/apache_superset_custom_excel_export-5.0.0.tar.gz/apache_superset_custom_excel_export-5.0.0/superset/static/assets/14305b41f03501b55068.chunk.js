"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7616],{20473:(e,a,t)=>{t.d(a,{A:()=>_});var n=t(2445),i=t(96540),d=t(58561),l=t.n(d),o=t(84335),s=t(15509),r=t(62799),c=t(17355),u=t(39304),h=t(25729),m=t(72234),g=t(35742),p=t(95579),b=t(97567),y=t(70856);const v=m.I4.div`
  .ant-select-dropdown {
    max-height: ${({theme:e})=>40*e.sizeUnit}px;
  }
  .tag-input {
    margin-bottom: ${({theme:e})=>3*e.sizeUnit}px;
  }
`;var S;!function(e){e.Chart="chart",e.Dashboard="dashboard",e.SavedQuery="query"}(S||(S={}));const _=({show:e,onHide:a,editTag:t,refreshData:d,addSuccessToast:m,addDangerToast:_,clearOnHide:C=!1})=>{const[Y,f]=(0,i.useState)([]),[T,w]=(0,i.useState)([]),[D,A]=(0,i.useState)([]),[k,F]=(0,i.useState)(""),[z,H]=(0,i.useState)(""),N=!!t,E=()=>{F(""),H(""),f([]),w([]),A([])};(0,i.useEffect)((()=>{const e={[S.Dashboard]:[],[S.Chart]:[],[S.SavedQuery]:[]},a=({id:a,name:t,type:n})=>{const i=e[n];i&&i.push({value:a,label:t,key:a})};f([]),w([]),A([]),N&&((0,b.Ik)({tagIds:[t.id],types:null},(t=>{t.forEach(a),f(e[S.Dashboard]),w(e[S.Chart]),A(e[S.SavedQuery])}),(e=>{_("Error Fetching Tagged Objects")})),F(t.name),H(t.description))}),[t]);const O=async(e,a,t,n,i,d,o)=>{const s=l().encode({columns:n,filters:[{col:i,opr:"ct",value:e}],page:a,order_column:d}),{json:r}=await g.A.get({endpoint:`/api/v1/${o}/?q=${s}`}),{result:c,count:u}=r;return{data:c.map((e=>({value:e.id,label:e[i]}))),totalCount:u}},x=(e,a)=>{e===S.Dashboard?f(a):e===S.Chart?w(a):e===S.SavedQuery&&A(a)};return(0,n.Y)(o.aF,{name:N?(0,p.t)("Edit Tag"):(0,p.t)("Create Tag"),title:(0,n.Y)(y.r,{isEditMode:N,title:N?(0,p.t)("Edit Tag"):(0,p.t)("Create Tag")}),onHide:()=>{C&&E(),a()},show:e,footer:(0,n.FD)("div",{children:[(0,n.Y)(s.$,{buttonStyle:"secondary",onClick:a,children:(0,p.t)("Cancel")}),(0,n.Y)(s.$,{buttonStyle:"primary",onClick:()=>{const e=Y.map((e=>["dashboard",e.value])),n=T.map((e=>["chart",e.value])),i=D.map((e=>["query",e.value]));N?g.A.put({endpoint:`/api/v1/tag/${t.id}`,jsonPayload:{description:z,name:k,objects_to_tag:[...e,...n,...i]}}).then((()=>{d(),E(),m((0,p.t)("Tag updated")),a()})).catch((e=>{_(e.message||"Error Updating Tag")})):g.A.post({endpoint:"/api/v1/tag/",jsonPayload:{description:z,name:k,objects_to_tag:[...e,...n,...i]}}).then((()=>{d(),E(),m((0,p.t)("Tag created")),a()})).catch((e=>_(e.message||"Error Creating Tag")))},children:(0,p.t)("Save")})]}),children:(0,n.FD)(v,{children:[(0,n.Y)(r.l,{children:(0,p.t)("Tag name")}),(0,n.Y)(c.A,{className:"tag-input",onChange:e=>F(e.target.value),placeholder:(0,p.t)("Name of your tag"),value:k}),(0,n.Y)(r.l,{children:(0,p.t)("Description")}),(0,n.Y)(c.A,{className:"tag-input",onChange:e=>H(e.target.value),placeholder:(0,p.t)("Add description of your tag"),value:z}),(0,n.Y)(u.c,{}),(0,n.Y)(h.A,{className:"tag-input",ariaLabel:(0,p.t)("Select dashboards"),mode:"multiple",name:"dashboards",value:Y,options:async(e,a,t)=>O(e,a,0,["id","dashboard_title"],"dashboard_title","dashboard_title","dashboard"),onChange:e=>x(S.Dashboard,e),header:(0,n.Y)(r.l,{children:(0,p.t)("Dashboards")}),allowClear:!0}),(0,n.Y)(h.A,{className:"tag-input",ariaLabel:(0,p.t)("Select charts"),mode:"multiple",name:"charts",value:T,options:async(e,a,t)=>O(e,a,0,["id","slice_name"],"slice_name","slice_name","chart"),onChange:e=>x(S.Chart,e),header:(0,n.Y)(r.l,{children:(0,p.t)("Charts")}),allowClear:!0}),(0,n.Y)(h.A,{className:"tag-input",ariaLabel:(0,p.t)("Select saved queries"),mode:"multiple",name:"savedQueries",value:D,options:async(e,a,t)=>O(e,a,0,["id","label"],"label","label","saved_query"),onChange:e=>x(S.SavedQuery,e),header:(0,n.Y)(r.l,{children:(0,p.t)("Saved queries")}),allowClear:!0})]})})}},28009:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var n=t(2445),i=t(96540),d=t(95579),l=t(27366),o=t(30703),s=t(50500),r=t(41933),c=t(83197),u=t(97470),h=t(44344),m=t(51713),g=t(62221),p=t(5261),b=t(38380),y=t(71519),v=t(97567),S=t(23193),_=t(20473);const C=(0,p.Ay)((function(e){const{addDangerToast:a,addSuccessToast:t,user:p}=e,{userId:C}=p,Y=(0,i.useMemo)((()=>[{id:"type",operator:"custom_tag",value:!0}]),[]),{state:{loading:f,resourceCount:T,resourceCollection:w,bulkSelectEnabled:D},hasPerm:A,fetchData:k,toggleBulkSelect:F,refreshData:z}=(0,s.RU)("tag",(0,d.t)("tag"),a,void 0,void 0,Y),[H,N]=(0,i.useState)(!1),[E,O]=(0,i.useState)(null),x=(0,i.useMemo)((()=>w.map((e=>e.id))),[w]),[$,I]=(0,s.oG)("tag",x,a),M=(0,g.SX)(null==C?void 0:C.toString(),null),B=A("can_write"),L=A("can_write"),P=[{id:"changed_on_delta_humanized",desc:!0}];function j(e){(0,v.dH)(e,(e=>{t(e),z()}),(e=>{a(e),z()}))}const q={title:(0,d.t)("No Tags created"),image:"dashboard.svg",description:"Create a new tag and assign it to existing entities like charts or dashboards",buttonAction:()=>N(!0),buttonIcon:(0,n.Y)(b.F.PlusOutlined,{iconSize:"m"}),buttonText:(0,d.t)("Create a new Tag")},Q=(0,i.useMemo)((()=>[{Cell:({row:{original:{id:e}}})=>C&&(0,n.Y)(r.$,{itemId:e,saveFaveStar:$,isStarred:I[e]}),Header:"",id:"id",disableSortBy:!0,size:"xs",hidden:!C},{Cell:({row:{original:{id:e,name:a}}})=>(0,n.Y)(h.vw,{children:(0,n.Y)(y.N_,{to:`/superset/all_entities/?id=${e}`,children:a})}),Header:(0,d.t)("Name"),accessor:"name",id:"name"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:a}}})=>(0,n.Y)(h.UW,{date:e,user:a}),Header:(0,d.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl",id:"changed_on_delta_humanized"},{Cell:({row:{original:e}})=>(0,n.FD)(o.En,{className:"actions",children:[B&&(0,n.Y)(c.h,{title:(0,d.t)("Please confirm"),description:(0,n.FD)(n.FK,{children:[(0,d.t)("Are you sure you want to delete")," ",(0,n.Y)("b",{children:e.dashboard_title}),"?"]}),onConfirm:()=>j([e]),children:e=>(0,n.Y)(u.m,{id:"delete-action-tooltip",title:(0,d.t)("Delete"),placement:"bottom",children:(0,n.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:e,children:(0,n.Y)(b.F.DeleteOutlined,{iconSize:"l"})})})}),L&&(0,n.Y)(u.m,{id:"edit-action-tooltip",title:(0,d.t)("Edit"),placement:"bottom",children:(0,n.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>{return a=e,N(!0),void O(a);var a},children:(0,n.Y)(b.F.EditOutlined,{iconSize:"l"})})})]}),Header:(0,d.t)("Actions"),id:"actions",hidden:!B,disableSortBy:!0},{accessor:S.H.ChangedBy,hidden:!0,id:S.H.ChangedBy}]),[C,B,z,t,a]),U=(0,i.useMemo)((()=>[{Header:(0,d.t)("Name"),id:"name",input:"search",operator:h.c0.Contains},{Header:(0,d.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:h.c0.RelationOneMany,unfilteredLabel:(0,d.t)("All"),fetchSelects:(0,o.u1)("tag","changed_by",(0,o.JF)((e=>(0,d.t)("An error occurred while fetching dataset datasource values: %s",e))),p),paginate:!0}]),[a,e.user]),G=[{desc:!1,id:"name",label:(0,d.t)("Alphabetical"),value:"alphabetical"},{desc:!0,id:"changed_on_delta_humanized",label:(0,d.t)("Recently modified"),value:"recently_modified"},{desc:!1,id:"changed_on_delta_humanized",label:(0,d.t)("Least recently modified"),value:"least_recently_modified"}],K=[];return B&&K.push({name:(0,d.t)("Bulk select"),buttonStyle:"secondary",onClick:F}),K.push({icon:(0,n.Y)(b.F.PlusOutlined,{iconSize:"m"}),name:(0,d.t)("Tag"),buttonStyle:"primary",onClick:()=>N(!0)}),(0,n.FD)(n.FK,{children:[(0,n.Y)(_.A,{show:H,onHide:()=>{N(!1),O(null)},editTag:E,refreshData:z,addSuccessToast:t,addDangerToast:a,clearOnHide:!0}),(0,n.Y)(m.A,{name:(0,d.t)("Tags"),buttons:K}),(0,n.Y)(c.h,{title:(0,d.t)("Please confirm"),description:(0,d.t)("Are you sure you want to delete the selected tags?"),onConfirm:e=>j(e),children:e=>{const i=[];return B&&i.push({key:"delete",name:(0,d.t)("Delete"),type:"danger",onSelect:e}),(0,n.Y)(n.FK,{children:(0,n.Y)(h.uO,{bulkActions:i,bulkSelectEnabled:D,cardSortSelectOptions:G,className:"tags-list-view",columns:Q,count:T,data:w,disableBulkSelect:F,refreshData:z,emptyState:q,fetchData:k,filters:U,initialSort:P,loading:f,addDangerToast:a,addSuccessToast:t,pageSize:25,showThumbnails:M?M.thumbnails:(0,l.G7)(l.TO.Thumbnails),defaultViewMode:(0,l.G7)(l.TO.ListviewsDefaultCardView)?"card":"table"})})}})]})}))},39304:(e,a,t)=>{t.d(a,{c:()=>l});var n=t(2445),i=t(17437),d=t(36552);function l(e){return(0,n.Y)(d.A,{css:e=>i.AH`
        margin: ${e.margin}px 0;
      `,...e})}}}]);