import{_ as S,b as D,u as g,g as m,h as l,i as t,j as p,c as x,o as b}from"./index-DV9Li2cg.js";import{p as E}from"./parameters-Lgiqp7aw.js";import{_ as N}from"./ConnectedLayout-BQ3ug6Jh.js";import{u as h}from"./parameters.store-C9k9DuTj.js";import"./VContainer-Btam4lk2.js";/* empty css              */import"./tag-CFK9dzMJ.js";import"./VApp-BKxnjOoi.js";import"./layout-CHO37cA6.js";import"./ssrBoot-BsxW6uW4.js";import"./global.store-DUP26-A5.js";import"./admin-CJVLMHh9.js";import"./layout.store-BxBoBlgf.js";import"./VAvatar-BAgTUIvX.js";import"./VProgressCircular-CrEXxs7k.js";import"./forwardRefs-Cpc3YYl6.js";import"./VMenu-B_dVqOmo.js";import"./VCard-DFWiFORP.js";import"./VRow-C_Ydf6yr.js";import"./VSheet-5VVWtHvs.js";const L={getCapabilities(){return S.get("/capabilities/")}},Q={__name:"AdminLayout",async setup(P){let a,o;const{$gettext:i}=D(),_=g(),s=h(),r=m(!1),c=m("/rspamd"),d=m([]),A=l(()=>_.authUser),M=l(()=>s.imapMigrationEnabled),R=()=>{window.location=c.value},I=l(()=>{const e=[{text:i("Dashboard"),to:{name:"Dashboard"},exact:!0,icon:"mdi-view-dashboard-outline"},{text:i("Domains"),to:{name:"DomainList"},icon:"mdi-domain",roles:[t.DOMAIN_ADMIN,t.RESELLER,t.SUPER_ADMIN]},{text:i("Identities"),to:{name:"Identities"},icon:"mdi-account",roles:[t.DOMAIN_ADMIN,t.RESELLER,t.SUPER_ADMIN]},{text:i("Alarms"),to:{name:"Alarms"},icon:"mdi-bell"},{icon:"mdi-history",text:i("Monitoring"),roles:[t.SUPER_ADMIN,t.RESELLER,t.DOMAIN_ADMIN],children:[{text:i("Statistics"),to:{name:"Statistics"},roles:[t.SUPER_ADMIN]},{text:i("Audit trail"),to:{name:"AuditTrail"},roles:[t.SUPER_ADMIN]},{text:i("Messages"),to:{name:"MessageLog"},roles:[t.DOMAIN_ADMIN,t.RESELLER,t.SUPER_ADMIN]}]},{icon:"mdi-email-sync-outline",text:i("IMAP Migration"),roles:[t.SUPER_ADMIN,t.RESELLER],condition:()=>M.value,children:[{text:i("Email providers"),to:{name:"ProvidersList"},roles:[t.SUPER_ADMIN,t.RESELLER]},{text:i("Migrations"),to:{name:"MigrationsList"},roles:[t.RESELLER,t.SUPER_ADMIN]}]}],n=[];return d.value.forEach(u=>{n.push({text:u.label,to:{name:"ParametersEdit",params:{app:u.name}}})}),e.concat([{icon:"mdi-cog",text:i("Settings"),children:n,roles:[t.SUPER_ADMIN]},{icon:"mdi-email-check-outline",text:"Rspamd",action:R,roles:[t.SUPER_ADMIN],condition:()=>r.value},{icon:"mdi-information",text:i("Information"),roles:[t.SUPER_ADMIN],to:{name:"Information"},withBell:!0}])});if(A.value.role===t.SUPER_ADMIN){let e=([a,o]=p(()=>E.getGlobalApplications()),a=await a,o(),a);d.value=e.data,s.imapMigrationEnabled===null&&(e=([a,o]=p(()=>E.getGlobalApplication("imap_migration")),a=await a,o(),a),s.imapMigrationEnabled=e.data.params.enabled_imapmigration),e=([a,o]=p(()=>L.getCapabilities()),a=await a,o(),a),r.value="rspamd"in e.data.capabilities,r.value&&(c.value=e.data.capabilities.rspamd.location||"/rspamd")}return(e,n)=>(b(),x(N,{"menu-items":I.value},null,8,["menu-items"]))}};export{Q as default};
