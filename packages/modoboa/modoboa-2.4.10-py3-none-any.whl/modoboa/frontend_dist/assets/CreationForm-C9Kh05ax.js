import{_ as me}from"./ConfirmDialog-BvqxQsD1.js";import{k as pe,b as se,m as T,o as g,G as j,F as W,e as f,t as V,f as h,c as I,w as c,H as M,q as re,a as l,l as x,v as F,x as P,y as ve,h as b,D as fe,J as ye,I as C,S as Ve,T as Se,B as q,U as be,V as oe,W as ge,X as Q,Y as ke,Z as _e,$ as he,g as U,a0 as xe,a1 as we,a2 as Ie,a3 as Ce}from"./index-DV9Li2cg.js";import{a as L,V as ie}from"./VRow-C_Ydf6yr.js";import{V as B,h as ee,i as Pe,R as te,j as $e,k as Ae,d as Be,f as Te,l as We,n as Re,o as Le,p as je}from"./VAvatar-BAgTUIvX.js";import{u as O}from"./tag-CFK9dzMJ.js";import{V as ae,m as Fe,a as le,b as Oe}from"./VWindowItem-wWSFAGI-.js";import{V as Ee}from"./VContainer-Btam4lk2.js";import{V as ne,m as Ne}from"./VSheet-5VVWtHvs.js";import{c as De}from"./forwardRefs-Cpc3YYl6.js";const Ge={class:"subtitle mt-4 d-flex"},ze={class:"text-h6"},Ue=["onClick"],Me={class:"text-grey"},He={__name:"CreationSummary",props:{sections:{type:Array,default:()=>[]}},emits:["modify-step"],setup(e,{emit:S}){const{$gettext:t}=se(),a=S;function o(s){return s.length?s.join(", "):t("Empty")}return(s,i)=>(g(!0),T(W,null,j(e.sections,(d,v)=>(g(),T(W,{key:v},[f("div",Ge,[f("span",ze,V(d.title),1),f("a",{href:"#",class:"edit-link ml-auto",onClick:n=>a("modify-step",v+1)},V(h(t)("Modify")),9,Ue)]),(g(!0),T(W,null,j(d.items,(n,_)=>(g(),I(ie,{key:_,dense:""},{default:c(()=>[n.value!==void 0?M(s.$slots,`item.${n.name}`,{key:0,item:n,displayList:o},()=>[l(L,null,{default:c(()=>[f("span",Me,V(n.key),1)]),_:2},1024),n.type==="yesno"?(g(),I(L,{key:0,class:"text-right"},{default:c(()=>[x(V(s.$yesno(n.value)),1)]),_:2},1024)):n.type==="list"?(g(),I(L,{key:1,class:"text-right"},{default:c(()=>[x(V(o(n.value)),1)]),_:2},1024)):(g(),I(L,{key:2,class:"text-right"},{default:c(()=>[x(V(n.value),1)]),_:2},1024))],!0):re("",!0)]),_:2},1024))),128))],64))),128))}},Ye=pe(He,[["__scopeId","data-v-6e743e1a"]]),J=Symbol.for("vuetify:v-stepper"),ue=P({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),qe=F()({name:"VStepperActions",props:ue(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(e,S){let{emit:t,slots:a}=S;const{t:o}=ve();function s(){t("click:prev")}function i(){t("click:next")}return O(()=>{const d={onClick:s},v={onClick:i};return f("div",{class:"v-stepper-actions"},[l(ee,{defaults:{VBtn:{disabled:["prev",!0].includes(e.disabled),text:o(e.prevText),variant:"text"}}},{default:()=>{var n;return[((n=a.prev)==null?void 0:n.call(a,{props:d}))??l(B,d,null)]}}),l(ee,{defaults:{VBtn:{color:e.color,disabled:["next",!0].includes(e.disabled),text:o(e.nextText),variant:"tonal"}}},{default:()=>{var n;return[((n=a.next)==null?void 0:n.call(a,{props:v}))??l(B,v,null)]}})])}),{}}}),ce=Pe("v-stepper-header"),Je=P({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:C,default:"$complete"},editable:Boolean,editIcon:{type:C,default:"$edit"},error:Boolean,errorIcon:{type:C,default:"$error"},icon:C,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),Ke=P({...Je(),...We()},"VStepperItem"),H=F()({name:"VStepperItem",directives:{vRipple:te},props:Ke(),emits:{"group:selected":e=>!0},setup(e,S){let{slots:t}=S;const a=$e(e,J,!0),o=b(()=>(a==null?void 0:a.value.value)??e.value),s=b(()=>e.rules.every(w=>w()===!0)),i=b(()=>!e.disabled&&e.editable),d=b(()=>!e.disabled&&e.editable),v=b(()=>e.error||!s.value),n=b(()=>e.complete||e.rules.length>0&&s.value),_=b(()=>v.value?e.errorIcon:n.value?e.completeIcon:a.isSelected.value&&e.editable?e.editIcon:e.icon),p=b(()=>({canEdit:d.value,hasError:v.value,hasCompleted:n.value,title:e.title,subtitle:e.subtitle,step:o.value,value:e.value}));return O(()=>{var k,r,u;const w=(!a||a.isSelected.value||n.value||d.value)&&!v.value&&!e.disabled,R=!!(e.title!=null||t.title),$=!!(e.subtitle!=null||t.subtitle);function y(){a==null||a.toggle()}return fe(f("button",{class:ye(["v-stepper-item",{"v-stepper-item--complete":n.value,"v-stepper-item--disabled":e.disabled,"v-stepper-item--error":v.value},a==null?void 0:a.selectedClass.value]),disabled:!e.editable,type:"button",onClick:y},[i.value&&Ae(!0,"v-stepper-item"),l(Te,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:w?e.color:void 0,size:24},{default:()=>{var m;return[((m=t.icon)==null?void 0:m.call(t,p.value))??(_.value?l(Be,{icon:_.value},null):o.value)]}}),f("div",{class:"v-stepper-item__content"},[R&&f("div",{key:"title",class:"v-stepper-item__title"},[((k=t.title)==null?void 0:k.call(t,p.value))??e.title]),$&&f("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[((r=t.subtitle)==null?void 0:r.call(t,p.value))??e.subtitle]),(u=t.default)==null?void 0:u.call(t,p.value)])]),[[te,e.ripple&&e.editable,null]])}),{}}}),Xe=P({...be(Fe(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),de=F()({name:"VStepperWindow",props:Xe(),emits:{"update:modelValue":e=>!0},setup(e,S){let{slots:t}=S;const a=Ve(J,null),o=Se(e,"modelValue"),s=b({get(){var i;return o.value!=null||!a?o.value:(i=a.items.value.find(d=>a.selected.value.includes(d.id)))==null?void 0:i.value},set(i){o.value=i}});return O(()=>{const i=ae.filterProps(e);return l(ae,q({_as:"VStepperWindow"},i,{modelValue:s.value,"onUpdate:modelValue":d=>s.value=d,class:["v-stepper-window",e.class],style:e.style,mandatory:!1,touch:!1}),t)}),{}}}),Ze=P({...Oe()},"VStepperWindowItem"),Y=F()({name:"VStepperWindowItem",props:Ze(),setup(e,S){let{slots:t}=S;return O(()=>{const a=le.filterProps(e);return l(le,q({_as:"VStepperWindowItem"},a,{class:["v-stepper-window-item",e.class],style:e.style}),t)}),{}}}),Qe=P({altLabels:Boolean,bgColor:String,completeIcon:C,editIcon:C,editable:Boolean,errorIcon:C,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:String,default:"title"},itemValue:{type:String,default:"value"},nonLinear:Boolean,flat:Boolean,...he()},"Stepper"),et=P({...Qe(),...Le({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...Ne(),..._e(ue(),["prevText","nextText"])},"VStepper"),tt=F()({name:"VStepper",props:et(),emits:{"update:modelValue":e=>!0},setup(e,S){let{slots:t}=S;const{items:a,next:o,prev:s,selected:i}=Re(e,J),{displayClasses:d,mobile:v}=oe(e),{completeIcon:n,editIcon:_,errorIcon:p,color:w,editable:R,prevText:$,nextText:y}=ge(e),k=b(()=>e.items.map((m,D)=>{const E=Q(m,e.itemTitle,m),G=Q(m,e.itemValue,D+1);return{title:E,value:G,raw:m}})),r=b(()=>a.value.findIndex(m=>i.value.includes(m.id))),u=b(()=>e.disabled?e.disabled:r.value===0?"prev":r.value===a.value.length-1?"next":!1);return ke({VStepperItem:{editable:R,errorIcon:p,completeIcon:n,editIcon:_,prevText:$,nextText:y},VStepperActions:{color:w,disabled:u,prevText:$,nextText:y}}),O(()=>{const m=ne.filterProps(e),D=!!(t.header||e.items.length),E=e.items.length>0,G=!e.hideActions&&!!(E||t.actions);return l(ne,q(m,{color:e.bgColor,class:["v-stepper",{"v-stepper--alt-labels":e.altLabels,"v-stepper--flat":e.flat,"v-stepper--non-linear":e.nonLinear,"v-stepper--mobile":v.value},d.value,e.class],style:e.style}),{default:()=>{var K,X;return[D&&l(ce,{key:"stepper-header"},{default:()=>[k.value.map((A,N)=>{let{raw:z,...Z}=A;return f(W,null,[!!N&&l(De,null,null),l(H,Z,{default:t[`header-item.${Z.value}`]??t.header,icon:t.icon,title:t.title,subtitle:t.subtitle})])})]}),E&&l(de,{key:"stepper-window"},{default:()=>[k.value.map(A=>l(Y,{value:A.value},{default:()=>{var N,z;return((N=t[`item.${A.value}`])==null?void 0:N.call(t,A))??((z=t.item)==null?void 0:z.call(t,A))}}))]}),(K=t.default)==null?void 0:K.call(t,{prev:s,next:o}),G&&(((X=t.actions)==null?void 0:X.call(t,{next:o,prev:s}))??l(qe,{key:"stepper-actions","onClick:prev":s,"onClick:next":o},t))]}})}),{prev:s,next:o}}}),at={class:"d-flex justify-center inner fill-height"},lt={class:"mb-5 text-h5"},nt={class:"text-grey-darken-1"},st={class:"d-flex justify-end mt-4"},rt={class:"text-center text-h3"},ot={class:"d-flex justify-center mt-8"},Vt={__name:"CreationForm",props:{title:{type:String,default:""},steps:{type:Array,default:()=>[]},summarySections:{type:Array,default:()=>[]},getVFormRef:{type:Function,default:null},formGetter:{type:Function,default:null},validateObject:{type:Function,default:null}},emits:["close","create","validationError"],setup(e,{expose:S,emit:t}){const{smAndDown:a}=oe(),o=xe(),s=e,i=U(1),d=U(!1),v=U(),n=b(()=>o.CREATION_FORM_LOGO_PATH?o.CREATION_FORM_LOGO_PATH:new URL("/assets/Modoboa_RVB-BLEU-SANS-pKrnjsR_.png",import.meta.url).href),_=t,{$gettext:p}=se();async function w(){await v.value.open(p("Warning"),p("If you close this form now, your modifications won't be saved. Do you confirm?"),{color:"warning",agreeLabel:p("Yes"),cancelLabel:p("No")})&&_("close")}async function R(y,k){const r=s.getVFormRef(s.steps[y-1]);if(r!==void 0){const{valid:u}=await r.validate();if(!u)return;if(s.validateObject)try{await s.validateObject(y)}catch(m){_("validationError",y,m.response.data);return}}i.value=k}function $(){d.value=!0,_("create")}return S({working:d}),(y,k)=>(g(),T("div",at,[l(tt,{modelValue:i.value,"onUpdate:modelValue":k[1]||(k[1]=r=>i.value=r),mobile:!h(a),class:"vertical-overflow"},{default:c(()=>[l(h(me),{ref_key:"confirm",ref:v},null,512),l(ce,{class:"align-center px-10"},{default:c(()=>[l(je,{src:n.value,"max-width":"190",class:"hidden-sm-and-down"},null,8,["src"]),(g(!0),T(W,null,j(e.steps,(r,u)=>(g(),I(H,{key:r.name,color:"primary",value:u+1,complete:i.value>u+1},{default:c(()=>[x(V(r.title),1)]),_:2},1032,["value","complete"]))),128)),l(H,{value:e.steps.length+1},{default:c(()=>[x(V(h(p)("Summary")),1)]),_:1},8,["value"]),l(B,{icon:"mdi-close",color:"primary",size:h(a)?"small":"x-large",variant:"text",onClick:w},null,8,["size"])]),_:1}),l(de,{class:"mt-4 d-flex justify-center"},{default:c(()=>[(g(!0),T(W,null,j(e.steps,(r,u)=>(g(),I(Y,{key:r.name,value:u+1,class:"flex-grow-1 ma-10"},{default:c(()=>[l(Ee,{fluid:""},{default:c(()=>[l(ie,{align:"center",justify:"center"},{default:c(()=>[l(L,{cols:"8",align:"start"},{default:c(()=>[f("div",lt,[f("span",nt,V(e.title),1),x(" / "+V(r.title),1)]),M(y.$slots,`form.${r.name}`,{step:r,currentStep:u+1})]),_:2},1024)]),_:2},1024)]),_:2},1024),f("div",st,[u+1>1?(g(),I(B,{key:0,class:"mr-10",variant:"text",onClick:m=>i.value=u},{default:c(()=>[x(V(h(p)("Back")),1)]),_:2},1032,["onClick"])):re("",!0),l(B,{color:"primary",size:"large",onClick:m=>R(u+1,u+2)},{default:c(()=>[x(V(h(p)("Next")),1)]),_:2},1032,["onClick"])])]),_:2},1032,["value"]))),128)),l(Y,{value:e.steps.length+1,class:"flex-grow-0"},{default:c(()=>[f("div",rt,V(h(p)("Summary")),1),l(Ye,{sections:e.summarySections,onModifyStep:k[0]||(k[0]=r=>i.value=r)},we({_:2},[j(y.$slots,(r,u)=>({name:u,fn:c(m=>[M(y.$slots,u,Ie(Ce(m)))])}))]),1032,["sections"]),f("div",ot,[l(B,{color:"primary",size:"large",loading:d.value,onClick:$},{default:c(()=>[x(V(h(p)("Confirm and create")),1)]),_:1},8,["loading"])])]),_:3},8,["value"])]),_:3})]),_:3},8,["modelValue","mobile"])]))}};export{Vt as _};
