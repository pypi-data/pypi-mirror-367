import{_ as _e}from"./DomainAdminList-CsWUNKVk.js";import{c as q}from"./colors-DoZdCu1D.js";import{b as L,m as h,o as n,e as r,a as t,l as u,t as l,J as re,w as e,F as K,G as X,f as o,g as k,K as Q,h as B,d as pe,L as te,r as ue,c as f,q as C,k as ie,n as ye,j as ge,M as ke}from"./index-DV9Li2cg.js";import{f as G,V as N,d as be}from"./VAvatar-BAgTUIvX.js";import{V as he}from"./VTable-KsiZ3cBz.js";import{d as O}from"./domains-nBMR-fRf.js";import{V as se,a as de}from"./VToolbar-CGwhgdmI.js";import{V as le}from"./VSpacer-C6PZ3X24.js";import{V as F,b as R,c as E,a as ce}from"./VCard-DFWiFORP.js";import{V as b,a as c}from"./VRow-C_Ydf6yr.js";import{V as xe}from"./VSheet-5VVWtHvs.js";import{V as we,a as Ve,b as $e}from"./VExpansionPanels-B5D6GOa3.js";import{V as A}from"./VAlert-B7mzOJIO.js";import{_ as De}from"./ConfirmDialog-BvqxQsD1.js";import{V as D}from"./VChip-nZ0uhY7t.js";import{V as Ce}from"./VDataTableVirtual-BwVmkt4u.js";import{V as oe}from"./VDialog-CZqM2Ofu.js";import{t as Me}from"./transports-TO08iTXJ.js";import{L as Ne}from"./LoadingData-CVD2Aen8.js";import{_ as Ie}from"./ResourcesForm-D87PHeH0.js";import{T as ne}from"./TimeSerieChart-C6j0uYR_.js";import{V as Se,a as Te,b as Z,c as ee}from"./VTabs-tNrJIYO0.js";import"./VAutocomplete-Cc4_tcl1.js";import"./VSelect-CS51PDEt.js";import"./VTextField-CLwRV0Cb.js";import"./tag-CFK9dzMJ.js";import"./VProgressCircular-CrEXxs7k.js";import"./forwardRefs-Cpc3YYl6.js";import"./ssrBoot-BsxW6uW4.js";import"./VMenu-B_dVqOmo.js";import"./VCheckboxBtn-j7di4leN.js";import"./VSelectionControl-DiOqtY38.js";import"./filter-D7NrAf6a.js";/* empty css              */import"./VDataTable-D_0_xJTl.js";import"./VContainer-Btam4lk2.js";import"./VForm-CpoZf60D.js";import"./VPicker-CXkIGEze.js";import"./VWindowItem-wWSFAGI-.js";const Ae={class:"text-h6"},Ke={width:"40%"},Pe={class:"text-white"},Be={class:"text-white"},Fe={class:"text-white"},Re={class:"text-white"},W={__name:"DmarcSourceTable",props:{title:{type:String,default:""},color:{type:String,default:""},total:{type:Number,default:null},sources:{type:Object,default:null}},setup(s){const{$gettext:a}=L();return(p,i)=>(n(),h("div",null,[r("div",Ae,[u(l(s.title)+" ",1),r("span",{class:re(`text-${s.color}-lighten-2`)},l(s.total),3)]),t(he,null,{default:e(()=>[r("tbody",null,[(n(!0),h(K,null,X(s.sources,(d,v)=>(n(),h(K,{key:v},[r("tr",null,[r("th",Ke,l(v),1),r("th",null,l(o(a)("Total")),1),i[0]||(i[0]=r("th",null,"SPF",-1)),i[1]||(i[1]=r("th",null,"DKIM",-1))]),(n(!0),h(K,null,X(d,(_,w)=>(n(),h("tr",{key:w},[r("td",null,l(w),1),r("td",null,l(_.total),1),r("td",null,[t(G,{color:"green lighten-2",size:"24"},{default:e(()=>[r("span",Pe,l(_.spf.success),1)]),_:2},1024),t(G,{color:"red lighten-2 ml-1",size:"24"},{default:e(()=>[r("span",Be,l(_.spf.failure),1)]),_:2},1024)]),r("td",null,[t(G,{color:"green lighten-2",size:"24"},{default:e(()=>[r("span",Fe,l(_.dkim.success),1)]),_:2},1024),t(G,{color:"red lighten-2 ml-1",size:"24"},{default:e(()=>[r("span",Re,l(_.dkim.failure),1)]),_:2},1024)])]))),128))],64))),128))])]),_:1})]))}},je={key:0},ze={class:"mx-2"},Le={class:"text-subtitle-1"},Oe={key:1},Ee={__name:"DmarcAligmentChart",props:{domain:{type:Object,default:()=>null}},setup(s){const{$gettext:a}=L(),p=["aligned","trusted","forwarded","failed"],i=s,d=k({colors:[q.green.lighten2,q.orange.lighten2,q.blue.lighten2,q.red.lighten2],labels:[a("Fully aligned"),a("Partially aligned"),a("Forwarded"),a("Failed")],legend:{position:"bottom"}}),v=k(null),_=k([{key:"total",label:a("Total"),color:"primary lighten-2"},{key:"aligned",label:a("Fully aligned"),color:"green lighten-2"},{key:"trusted",label:a("Partially aligned"),color:"orange lighten-2"},{key:"forwarded",label:a("Forwarded"),color:"blue lighten-2"},{key:"failed",label:a("Failed"),color:"red lighten-2"}]),w=Q.now(),m=k(w.year),y=k(w.weekNumber),V=k(!1),P=k(!1),U=k(null),j=k([]),I=k({}),Y=B(()=>Q.fromObject({weekYear:m.value,weekNumber:y.value}).startOf("week")),S=B(()=>Q.fromObject({weekYear:m.value,weekNumber:y.value}).endOf("week"));function g(z){let x="";for(const T of z.split(" "))x!==""&&(x+=" "),x+="text-"+T;return x}function H(){y.value===52?(m.value+=1,y.value=1):y.value+=1}function M(){y.value===1?(m.value-=1,y.value=52):y.value-=1}function J(){if(P.value)return;const z=`${m.value}-${y.value}`;P.value=!0,O.getDomainDmarcAlignment(i.domain.pk,z).then(x=>{if(P.value=!1,x.status===204){V.value=!0;return}I.value={total:0},v.value=x.data,j.value=[];for(const T of p){let $=0;for(const ae in x.data[T])for(const ve in x.data[T][ae])$+=x.data[T][ae][ve].total;I.value.total+=$,I.value[T]=$,j.value.push($)}})}return pe(()=>J()),te(y,()=>{J()}),te(m,()=>{J()}),(z,x)=>{const T=ue("apexchart");return v.value?(n(),h("div",je,[t(R,null,{default:e(()=>[t(se,{dense:"",elevation:"0",class:"mr-2"},{default:e(()=>[t(de,null,{default:e(()=>[u(l(o(a)("Alignment")),1)]),_:1}),t(le),t(N,{icon:"mdi-arrow-left",size:"x-small",onClick:M}),r("span",ze,l(Y.value.toLocaleString())+" - "+l(S.value.toLocaleString()),1),t(N,{icon:"mdi-arrow-right",size:"x-small",onClick:H})]),_:1}),t(F,null,{default:e(()=>[t(b,null,{default:e(()=>[t(c,{cols:"5"},{default:e(()=>[j.value?(n(),f(T,{key:0,type:"pie",height:"350",options:d.value,series:j.value},null,8,["options","series"])):C("",!0)]),_:1}),t(c,{cols:"7"},{default:e(()=>[t(b,null,{default:e(()=>[(n(!0),h(K,null,X(_.value,$=>(n(),f(c,{key:$.key,cols:"6"},{default:e(()=>[t(xe,{outlined:"",color:$.color,rounded:""},{default:e(()=>[t(R,{outlined:"",class:"pa-10 text-center"},{default:e(()=>[r("span",{class:re("text-h4 "+g($.color))},l(I.value[$.key]),3),x[1]||(x[1]=r("br",null,null,-1)),r("span",Le,l($.label),1)]),_:2,__:[1]},1024)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t($e,{modelValue:U.value,"onUpdate:modelValue":x[0]||(x[0]=$=>U.value=$),class:"mt-2"},{default:e(()=>[t(we,{title:o(a)("Detail")},{default:e(()=>[t(Ve,null,{default:e(()=>[t(W,{title:o(a)("Trusted sources"),color:"green",total:I.value.aligned,sources:v.value.aligned},null,8,["title","total","sources"]),t(W,{title:o(a)("Partially trusted sources / Forwarders"),color:"orange",total:I.value.trusted,sources:v.value.trusted,class:"mt-4"},null,8,["title","total","sources"]),t(W,{title:o(a)("Forwarders with ARC"),color:"blue",total:I.value.forwarded,sources:v.value.forwarded,class:"mt-4"},null,8,["title","total","sources"]),t(W,{title:o(a)("Unknown sources / Threats"),color:"red",total:I.value.failed,sources:v.value.failed,class:"mt-4"},null,8,["title","total","sources"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])])):(n(),h("div",Oe,[V.value?(n(),f(A,{key:0,type:"info",variant:"outlined",prominent:"",border:"start",class:"mt-6"},{default:e(()=>[r("div",null,l(o(a)("DMARC support does not seem to be enabled for this domain.")),1),r("div",null,l(o(a)("If you configured it recently, please wait for the first report to be received and processed.")),1)]),_:1})):C("",!0)]))}}},Ue={id:"dkimdns",class:"dkim"},me={__name:"DKIMKeyViewer",props:{domain:{type:Object,default:null}},setup(s){const a=s,p=B(()=>{let d=`v=DKIM1;k=rsa;p=${a.domain.dkim_public_key}`;const v=[];for(;d.length>0;)if(d.length>74)v.push(`  "${d.substring(0,74)}"`),d=d.substring(74);else{v.push(`  "${d}"`);break}return v.join(`
`)});function i(){navigator.clipboard.writeText(document.getElementById("dkimdns").textContent)}return(d,v)=>(n(),h("button",{class:"dkimbutton",onClick:v[0]||(v[0]=_=>i())},[r("pre",Ue,l(s.domain.dkim_key_selector)+"._domainkey."+l(s.domain.name)+". IN TXT ("+l(p.value)+`)
      }})`,1)]))}},qe={class:"headline"},Ge={id:"dkimpub",class:"dkim"},We={__name:"DomainDKIMKey",props:{domain:{type:Object,default:null}},emits:["close"],setup(s,{emit:a}){const{$gettext:p}=L(),i=a;function d(){navigator.clipboard.writeText(document.getElementById("dkimpub").textContent)}return(v,_)=>(n(),f(R,null,{default:e(()=>[t(E,null,{default:e(()=>[r("span",qe,l(o(p)("DKIM public key for"))+" "+l(s.domain.name),1)]),_:1}),t(F,null,{default:e(()=>[r("p",null,l(o(p)("Raw format. Click to copy")),1),t(A,{border:"start","colored-border":"","border-color":"primary lighten-3",elevation:"2",dense:""},{default:e(()=>[r("button",{class:"dkimbutton",onClick:_[0]||(_[0]=w=>d())},[r("pre",Ge,l(s.domain.dkim_public_key),1)])]),_:1})]),_:1}),t(F,null,{default:e(()=>[r("p",null,l(o(p)("Bind/named format. Click to copy")),1),t(A,{border:"start","colored-border":"","border-color":"primary lighten-3",elevation:"2",dense:""},{default:e(()=>[t(me,{domain:s.domain},null,8,["domain"])]),_:1})]),_:1}),t(ce,null,{default:e(()=>[t(le),t(N,{onClick:_[1]||(_[1]=w=>i("close"))},{default:e(()=>[u(l(o(p)("Close")),1)]),_:1})]),_:1})]),_:1}))}},Xe={class:"text-subtitle-1 text-grey-darken-2 mb-4"},Ye={class:"text-h6"},He={__name:"DomainDNSConfig",props:{domain:{type:Object,default:null}},emits:["close"],setup(s,{emit:a}){const p=a;return(i,d)=>(n(),f(R,null,{default:e(()=>[t(E,{class:"text-h5"},{default:e(()=>[r("span",null,l(i.$gettext("DNS configuration for "))+" "+l(s.domain.name),1)]),_:1}),t(F,null,{default:e(()=>[r("p",Xe,l(i.$gettext("Here is an example of DNS configuration (bind format). Replace values between [ ] by the appropriate ones.")),1),t(A,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",color:"white"},{default:e(()=>[d[1]||(d[1]=r("div",{class:"text-h6"},"MX",-1)),r("pre",null,[u("mail."+l(s.domain.name)+". IN A ",1),r("strong",null,"["+l(i.$gettext("IP address of your Modoboa server"))+"]",1),u(`
@ IN MX 10 mail.`+l(s.domain.name)+".",1)])]),_:1,__:[1]}),t(A,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>d[2]||(d[2]=[r("div",{class:"text-h6"},"SPF",-1),r("pre",null,'@ IN TXT "v=spf1 mx ~all"',-1)])),_:1,__:[2]}),s.domain.enable_dkim&&s.domain.dkim_public_key?(n(),f(A,{key:0,class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>[d[3]||(d[3]=r("div",{class:"text-h6"},"DKIM",-1)),t(me,{domain:s.domain},null,8,["domain"])]),_:1,__:[3]})):C("",!0),t(A,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>[d[4]||(d[4]=r("div",{class:"text-h6"},"DMARC",-1)),r("pre",null,"_dmarc."+l(s.domain.name)+'. IN TXT "v=DMARC1; p=quarantine; pct=100;"',1)]),_:1,__:[4]}),t(A,{class:"mb-4",border:"start","border-color":"primary lighten-3",elevation:"2",dense:"",color:"white"},{default:e(()=>[r("div",Ye,l(i.$gettext("Auto configuration")),1),r("pre",null,[u("autoconfig."+l(s.domain.name)+". IN CNAME ",1),r("strong",null,"["+l(i.$gettext("hostname of your automx server"))+"]",1),u(`
autodiscover.`+l(s.domain.name)+". IN CNAME ",1),r("strong",null,"["+l(i.$gettext("hostname of your automx server"))+"]",1)])]),_:1})]),_:1}),t(ce,null,{default:e(()=>[t(le),t(N,{onClick:d[0]||(d[0]=v=>p("close"))},{default:e(()=>[u(l(i.$gettext("Close")),1)]),_:1})]),_:1})]),_:1}))}},Je=ie(He,[["__scopeId","data-v-506783e1"]]),Qe={class:"overline"},Ze={class:"overline"},et={key:4,class:"d-flex align-center flex-nowrap mt-4"},tt={class:"text-subtitle-2"},lt={class:"ml-6"},at={key:0},ot={key:1},nt={__name:"DNSDetail",props:{modelValue:{type:Object,default:null}},setup(s){const{$gettext:a}=L(),p=ye(),i=s,d=B(()=>i.modelValue),v=k(),_=k({}),w=k([{title:a("Name"),value:"name"},{title:a("Address"),value:"address"},{title:a("Updated"),value:"updated"}]),m=k(!1),y=k(!1),V=k(!1);function P(){navigator.clipboard.writeText(d.value.dkim_public_key),p.displayNotification({msg:a("DKIM key copied to clipboard"),type:"success"})}function U(){const S={dkim_private_key_path:""};O.patchDomain(d.value.pk,S).then(()=>{p.displayNotification({msg:a("A new key will be generated soon. Refresh the page in a moment to see it."),type:"success"}),d.value.dkim_private_key_path="",m.value=!1}).catch(()=>{m.value=!1})}function j(){m.value=!1}async function I(){m.value=!0,O.getDomainDNSDetail(d.value.pk).then(async S=>{_.value=S.data,await v.value.open(a("warning"),a("DKIM key does not seem to be generated yet or has failed. Do you want to requeue the job?"),{color:"warning",cancelLabel:a("No"),agreeLabel:a("Yes")})?U():j()})}function Y(){v.value.open(a("Warning"),a("DKIM keys already exist for this domain. Do you want to overwrite them?"),{color:"error",cancelLabel:a("No"),agreeLabel:a("Yes")})}return te(d,S=>{S&&O.getDomainDNSDetail(S.pk).then(g=>{_.value=g.data})},{immediate:!0}),(S,g)=>{const H=ue("translate");return d.value?(n(),f(R,{key:0},{default:e(()=>[t(E,null,{default:e(()=>[g[6]||(g[6]=r("span",null," DNS ",-1)),t(N,{class:"ml-2",icon:"mdi-information-outline",title:o(a)("DNS configuration help"),variant:"text",density:"compact",onClick:g[0]||(g[0]=M=>y.value=!0)},null,8,["title"])]),_:1,__:[6]}),t(F,null,{default:e(()=>[t(H,{class:"overline"},{default:e(()=>g[7]||(g[7]=[u("MX records")])),_:1,__:[7]}),d.value.dns_global_status=="pending"?(n(),f(b,{key:0},{default:e(()=>[t(c,null,{default:e(()=>[t(D,{color:"info",size:"small"},{default:e(()=>[u(l(o(a)("Pending")),1)]),_:1})]),_:1})]),_:1})):(n(),f(Ce,{key:1,headers:w.value,items:_.value.mx_records},{"item.updated":e(({item:M})=>[u(l(S.$date(M.updated)),1)]),_:2},1032,["headers","items"])),r("div",Qe,l(o(a)("Auto configuration")),1),d.value.dns_global_status=="pending"?(n(),f(b,{key:2},{default:e(()=>[t(c,null,{default:e(()=>[t(D,{color:"info",size:"small"},{default:e(()=>[u(l(o(a)("Pending")),1)]),_:1})]),_:1})]),_:1})):(n(),h(K,{key:3},[t(b,null,{default:e(()=>[t(c,null,{default:e(()=>[_.value.autoconfig_record?(n(),f(D,{key:0,color:"success"},{default:e(()=>[u(l(o(a)("autoconfig record (Mozilla): %{ value }",{value:_.value.autoconfig_record.value})),1)]),_:1})):(n(),f(D,{key:1,color:"warning"},{default:e(()=>[u(l(o(a)("autoconfig record (Mozilla) not found")),1)]),_:1}))]),_:1}),t(c,null,{default:e(()=>[_.value.autodiscover_record?(n(),f(D,{key:0,color:"success"},{default:e(()=>[u(l(o(a)("autodiscover record (Microsoft): %{ value }",{value:_.value.autodiscover_record.value})),1)]),_:1})):(n(),f(D,{key:1,color:"warning"},{default:e(()=>[u(l(o(a)("autodiscover record (Microsoft) not found")),1)]),_:1}))]),_:1})]),_:1}),r("div",Ze,l(o(a)("Authentication")),1),t(b,null,{default:e(()=>[t(c,null,{default:e(()=>[_.value.spf_record?(n(),f(D,{key:0,color:"success"},{default:e(()=>[u(l(o(a)("SPF record found")),1)]),_:1})):(n(),f(D,{key:1,color:"error"},{default:e(()=>[u(l(o(a)("SPF record not found")),1)]),_:1}))]),_:1}),t(c,null,{default:e(()=>[_.value.dkim_record?(n(),f(D,{key:0,color:"success"},{default:e(()=>[u(l(o(a)("DKIM record found")),1)]),_:1})):(n(),f(D,{key:1,color:"error"},{default:e(()=>[u(l(o(a)("DKIM record not found")),1)]),_:1}))]),_:1}),t(c,null,{default:e(()=>[_.value.dmarc_record?(n(),f(D,{key:0,color:"success"},{default:e(()=>[u(l(o(a)("DMARC record found")),1)]),_:1})):(n(),f(D,{key:1,color:"error"},{default:e(()=>[u(l(o(a)("DMARC record not found")),1)]),_:1}))]),_:1})]),_:1})],64)),d.value.enable_dkim?(n(),h("div",et,[r("div",tt,l(o(a)("DKIM key")),1),r("div",lt,[d.value.dkim_private_key_path&&d.value.dkim_public_key?(n(),h("div",at,[t(N,{color:"primary",size:"small",onClick:g[1]||(g[1]=M=>V.value=!0)},{default:e(()=>[u(l(o(a)("Show key")),1)]),_:1}),t(N,{icon:"mdi-content-copy",variant:"text",class:"ml-2",title:o(a)("Copy key to clipboard"),onClick:P},null,8,["title"]),t(N,{icon:"mdi-refresh",title:o(a)("Generate a new DKIM key"),variant:"text",loading:m.value,onClick:Y},null,8,["title","loading"])])):(n(),h("div",ot,[u(l(o(a)("Not generated"))+" ",1),t(N,{icon:"mdi-reload",color:"primary",variant:"text",loading:m.value,onClick:I},null,8,["loading"])]))])])):C("",!0)]),_:1}),t(oe,{modelValue:y.value,"onUpdate:modelValue":g[3]||(g[3]=M=>y.value=M),"max-width":"800px",persistent:""},{default:e(()=>[t(Je,{domain:d.value,onClose:g[2]||(g[2]=M=>y.value=!1)},null,8,["domain"])]),_:1},8,["modelValue"]),t(oe,{modelValue:V.value,"onUpdate:modelValue":g[5]||(g[5]=M=>V.value=M),"max-width":"800px",persistent:""},{default:e(()=>[t(We,{domain:d.value,onClose:g[4]||(g[4]=M=>V.value=!1)},null,8,["domain"])]),_:1},8,["modelValue"]),t(De,{ref_key:"dialog",ref:v},null,512)]),_:1})):C("",!0)}}},fe={__name:"BooleanIcon",props:{value:{type:Boolean}},setup(s){const a=s,p=B(()=>a.value?"mdi-check-circle":"mdi-close-circle"),i=B(()=>a.value?"success":"error");return(d,v)=>(n(),f(be,{icon:p.value,color:i.value},null,8,["icon","color"]))}},rt={class:"headline"},ut={__name:"DomainSummary",props:{domain:{type:Object,default:null}},setup(s){const{$gettext:a}=L();return(p,i)=>s.domain?(n(),f(R,{key:0},{default:e(()=>[t(E,null,{default:e(()=>[r("div",rt,l(o(a)("General information")),1)]),_:1}),t(F,null,{default:e(()=>[t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Creation date")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[u(l(p.$date(s.domain.creation)),1)]),_:1})]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Last modification date")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[u(l(p.$date(s.domain.last_modification)),1)]),_:1})]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Quota")),1)]),_:1}),s.domain.quota==="0"?(n(),f(c,{key:0,cols:"6"},{default:e(()=>[u(l(o(a)("Unlimited")),1)]),_:1})):(n(),f(c,{key:1,cols:"6"},{default:e(()=>[u(l(s.domain.quota)+" "+l(o(a)("MB")),1)]),_:1}))]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Default mailbox quota")),1)]),_:1}),s.domain.default_mailbox_quota==="0"?(n(),f(c,{key:0,cols:"6"},{default:e(()=>[u(l(o(a)("Unlimited")),1)]),_:1})):(n(),f(c,{key:1,cols:"6"},{default:e(()=>[u(l(s.domain.default_mailbox_quota)+" MB",1)]),_:1}))]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Daily sending limit")),1)]),_:1}),s.domain.message_limit!==void 0&&s.domain.message_limit!==null?(n(),f(c,{key:0,cols:"6"},{default:e(()=>[u(l(s.domain.message_limit)+" "+l(o(a)("messages")),1)]),_:1})):(n(),f(c,{key:1,cols:"6"},{default:e(()=>[u(l(o(a)("Unlimited")),1)]),_:1}))]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Mailboxes")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[u(l(s.domain.mailbox_count),1)]),_:1})]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Aliases")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[u(l(s.domain.mbalias_count),1)]),_:1})]),_:1}),t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(o(a)("Enabled")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[t(o(fe),{value:s.domain.enabled,variant:"flat"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0)}},it={class:"headline"},st={__name:"RelayDomainSummary",props:{domain:{type:Object,default:null}},async setup(s){let a,p;const i=s,d=k([]),v=B(()=>d.value.find(m=>m.name===i.domain.transport.service)),_=m=>i.domain.transport.settings[`${v.value.name}_${m}`],w=([a,p]=ge(()=>Me.getAll()),a=await a,p(),a);return d.value=w.data,(m,y)=>i.domain?(n(),f(R,{key:0},{default:e(()=>[t(E,null,{default:e(()=>[r("div",it,l(m.$gettext("Transport")),1)]),_:1}),t(F,null,{default:e(()=>[t(b,null,{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(m.$gettext("Service")),1)]),_:1}),t(c,{cols:"6"},{default:e(()=>[u(l(i.domain.transport.service),1)]),_:1})]),_:1}),v.value?(n(!0),h(K,{key:0},X(v.value.settings,(V,P)=>(n(),f(b,{key:P},{default:e(()=>[t(c,{cols:"6"},{default:e(()=>[u(l(V.label),1)]),_:2},1024),t(c,{cols:"6"},{default:e(()=>[V.type!=="boolean"?(n(),h(K,{key:0},[u(l(_(V.name)),1)],64)):(n(),f(o(fe),{key:1,value:_(V.name),variant:"flat"},null,8,["value"]))]),_:2},1024)]),_:2},1024))),128)):C("",!0)]),_:1})]),_:1})):C("",!0)}},dt={key:1},ct={__name:"DomainView",setup(s){const{$gettext:a}=L(),p=ke(),i=k(null),d=k({}),v=k(null);function _(){O.getDomain(p.params.id).then(w=>{i.value=w.data})}return _(),(w,m)=>i.value?(n(),h("div",dt,[t(se,{flat:""},{default:e(()=>[t(de,null,{default:e(()=>[u(l(o(a)("Domain"))+" "+l(i.value.name)+" ",1),t(N,{color:"primary",icon:"mdi-circle-edit-outline",to:{name:"DomainEdit",params:{id:i.value.pk}}},null,8,["to"]),t(N,{color:"primary",icon:"mdi-reload",onClick:m[0]||(m[0]=y=>_())})]),_:1})]),_:1}),t(Se,{modelValue:v.value,"onUpdate:modelValue":m[1]||(m[1]=y=>v.value=y),class:"mb-4",color:"primary"},{default:e(()=>[t(Z,null,{default:e(()=>[u(l(o(a)("General")),1)]),_:1}),t(Z,null,{default:e(()=>[u(l(o(a)("Statistics")),1)]),_:1}),t(Z,null,{default:e(()=>[u(l(o(a)("DMARC")),1)]),_:1})]),_:1},8,["modelValue"]),t(Te,{modelValue:v.value,"onUpdate:modelValue":m[3]||(m[3]=y=>v.value=y)},{default:e(()=>[t(ee,null,{default:e(()=>[t(b,null,{default:e(()=>[t(c,{cols:"12",md:"6"},{default:e(()=>[t(ut,{domain:i.value},null,8,["domain"]),m[5]||(m[5]=r("div",{class:"mt-4"},null,-1)),i.value.type==="relaydomain"?(n(),h(K,{key:0},[t(st,{domain:i.value},null,8,["domain"]),m[4]||(m[4]=r("div",{class:"mt-4"},null,-1))],64)):C("",!0),t(_e,{domain:i.value},null,8,["domain"])]),_:1,__:[5]}),t(c,{cols:"12",md:"6"},{default:e(()=>[t(nt,{modelValue:i.value,"onUpdate:modelValue":m[2]||(m[2]=y=>i.value=y)},null,8,["modelValue"]),m[6]||(m[6]=r("div",{class:"mt-4"},null,-1)),d.value.params&&d.value.params.enable_domain_limits&&i.value.resources&&i.value.resources.length?(n(),f(Ie,{key:0,resources:i.value.resources},null,8,["resources"])):C("",!0)]),_:1,__:[6]})]),_:1})]),_:1}),t(ee,null,{default:e(()=>[t(b,null,{default:e(()=>[t(c,{cols:"12"},{default:e(()=>[i.value.name?(n(),f(ne,{key:0,domain:i.value,"graphic-set":"mailtraffic","graphic-name":"averagetraffic"},null,8,["domain"])):C("",!0)]),_:1}),t(c,{cols:"12"},{default:e(()=>[i.value.name?(n(),f(ne,{key:0,domain:i.value,"graphic-set":"mailtraffic","graphic-name":"averagetrafficsize"},null,8,["domain"])):C("",!0)]),_:1})]),_:1})]),_:1}),t(ee,null,{default:e(()=>[t(Ee,{domain:i.value},null,8,["domain"])]),_:1})]),_:1},8,["modelValue"])])):(n(),f(Ne,{key:0}))}},Jt=ie(ct,[["__scopeId","data-v-628417a7"]]);export{Jt as default};
