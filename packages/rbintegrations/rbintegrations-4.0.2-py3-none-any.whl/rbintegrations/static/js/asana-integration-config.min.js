!function(){"use strict";$(function(){const e=$("#id_asana_access_token");var a=$("#id_asana_workspace");const n=$('<div class="errorlist">').insertAfter(e).hide(),r=(a.selectize({create:!1,dropdownParent:"body",searchField:"name",valueField:"gid",labelField:"name",render:{option(e,a){return`<div>${a(e.name)}</div>`}},onChange(e){$("#id_asana_workspace_name").val(this.options[e].name)}}),a[0].selectize);function s(e){n.html(`<span class="rb-icon rb-icon-warning"></span>
`+_.escape(e)).show()}r.$control.width($("#id_name").width()),r.disable();let o=null;a=_.throttle(()=>{const t=e.val().trim();o!==t&&(o=t,n.hide(),r.disable(),0!==t.length)&&r.load(a=>{var e=new URLSearchParams,n=(e.append("api_key",t),SITE_ROOT+"rbintegrations/asana/workspaces/");fetch(n+"?"+e.toString()).then(e=>e.json()).then(e=>{"success"===e.result?(r.enable(),a(e.data)):"error"===e.result?(s(e.error),a()):(console.error("Unexpected error when fetching Asana workspace list: ",e),s(gettext("Unable to communicate with Asana")))}).catch(e=>{console.error("Unexpected error when fetching Asana workspace list: ",e),s(gettext("Unable to communicate with Asana"))})})},100);e.on("change keyup",a),a()})}.call(this);
