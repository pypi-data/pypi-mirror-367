{"version":3,"file":"newsWidgetModelTests.js","names":["suite","model","beforeEach","RB","Admin","NewsWidget","rssURL","describe","it","_loadNews","url","options","expect","toBe","payload","parser","DOMParser","success","parseFromString","loadingNewsEventHandler","jasmine","createSpy","spyOn","$","and","callFake","on","loadNews","toHaveBeenCalled","ajax","newsItems","get","length","newsItem","date","isSame","Date","UTC","toBeTrue","title","error"],"sources":["../../../../../../../static/rb/js/admin/models/tests/newsWidgetModelTests.es6.js"],"sourcesContent":["suite('rb/admin/models/NewsWidget', function() {\n    let model;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            rssURL: 'http://example.com/news/rss',\n        });\n    });\n\n    describe('Methods', function() {\n        describe('loadNews', function() {\n            it('Success', function() {\n                function _loadNews(url, options) {\n                    expect(url).toBe('http://example.com/news/rss');\n\n                    const payload = dedent`\n                        <?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n                        <rss xmlns:atom=\"http://www.w3.org/2005/Atom\"\n                             version=\"2.0\">\n                         <channel>\n                          <title>Channel Name</title>\n                          <link>http://example.com/news/</link>\n                          <description>Channel description...</description>\n                          <atom:link href=\"http://example.com/news/rss\"\n                                     rel=\"self\"></atom:link>\n                          <language>en-us</language>\n                          <lastBuildDate>Sun, 20 Oct 2019 17:26:32 -0700</lastBuildDate>\n                          <item>\n                           <title>Headline 6</title>\n                           <pubDate>Sun, 20 Oct 2019 17:26:32 -0700</pubDate>\n                           <link>http://example.com/news/post6</link>\n                           <description>Brief summary of 6</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post6</guid>\n                          </item>\n                          <item>\n                           <title>Headline 5</title>\n                           <pubDate>Tue, 01 Oct 2019 13:29:00 -0700</pubDate>\n                           <link>http://example.com/news/post5</link>\n                           <description>Brief summary of 5</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post5</guid>\n                          </item>\n                          <item>\n                           <title>Headline 4</title>\n                           <pubDate>Thu, 26 Sep 2019 19:29:33 -0700</pubDate>\n                           <link>http://example.com/news/post4</link>\n                           <description>Brief summary of 4</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post4</guid>\n                          </item>\n                          <item>\n                           <title>Headline 3</title>\n                           <pubDate>Sun, 08 Sep 2019 11:27:05 -0700</pubDate>\n                           <link>http://example.com/news/post3</link>\n                           <description>Brief summary of 3</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post3</guid>\n                          </item>\n                          <item>\n                           <title>Headline 2</title>\n                           <pubDate>Fri, 30 Aug 2019 23:15:01 -0700</pubDate>\n                           <link>http://example.com/news/post2</link>\n                           <description>Brief summary of 2</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post2</guid>\n                          </item>\n                          <item>\n                           <title>Headline 1</title>\n                           <pubDate>Thu, 29 Aug 2019 14:30:00 -0700</pubDate>\n                           <link>http://example.com/news/post1</link>\n                           <description>Brief summary of 1</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post1</guid>\n                          </item>\n                         </channel>\n                        </rss>\n                    `;\n\n                    const parser = new DOMParser();\n                    options.success(parser.parseFromString(payload,\n                                                           'application/xml'));\n                }\n\n                const loadingNewsEventHandler = jasmine.createSpy();\n\n                spyOn($, 'ajax').and.callFake(_loadNews);\n                model.on('loadingNews', loadingNewsEventHandler);\n\n                model.loadNews();\n\n                expect(loadingNewsEventHandler).toHaveBeenCalled();\n                expect($.ajax).toHaveBeenCalled();\n\n                const newsItems = model.get('newsItems');\n                expect(newsItems.length).toBe(5);\n\n                let newsItem = newsItems[0];\n                expect(newsItem.date.isSame(Date.UTC(2019, 9, 21, 0, 26, 32)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 6');\n                expect(newsItem.url).toBe('http://example.com/news/post6');\n\n                newsItem = newsItems[1];\n                expect(newsItem.date.isSame(Date.UTC(2019, 9, 1, 20, 29, 0)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 5');\n                expect(newsItem.url).toBe('http://example.com/news/post5');\n\n                newsItem = newsItems[2];\n                expect(newsItem.date.isSame(Date.UTC(2019, 8, 27, 2, 29, 33)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 4');\n                expect(newsItem.url).toBe('http://example.com/news/post4');\n\n                newsItem = newsItems[3];\n                expect(newsItem.date.isSame(Date.UTC(2019, 8, 8, 18, 27, 5)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 3');\n                expect(newsItem.url).toBe('http://example.com/news/post3');\n\n                newsItem = newsItems[4];\n                expect(newsItem.date.isSame(Date.UTC(2019, 7, 31, 6, 15, 1)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 2');\n                expect(newsItem.url).toBe('http://example.com/news/post2');\n            });\n\n            it('Error loading feed', function() {\n                function _loadNews(url, options) {\n                    expect(url).toBe('http://example.com/news/rss');\n                    options.error();\n                }\n\n                const loadingNewsEventHandler = jasmine.createSpy();\n\n                spyOn($, 'ajax').and.callFake(_loadNews);\n                model.on('loadingNews', loadingNewsEventHandler);\n\n                model.loadNews();\n\n                expect(loadingNewsEventHandler).toHaveBeenCalled();\n                expect($.ajax).toHaveBeenCalled();\n\n                const newsItems = model.get('newsItems');\n                expect(newsItems.length).toBe(0);\n            });\n        });\n    });\n});\n\n"],"mappings":"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","ignoreList":[]}