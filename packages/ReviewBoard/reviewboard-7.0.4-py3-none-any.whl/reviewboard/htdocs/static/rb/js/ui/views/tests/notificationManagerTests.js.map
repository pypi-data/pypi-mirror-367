{"version":3,"file":"notificationManagerTests.js","names":["suite","instance","RB","NotificationManager","origNotification","Notification","title","options","close","requestPermission","permission","beforeEach","UserSession","set","setup","expect","toBe","afterEach","describe","it","notify","body","notification","_notification","not","_canNotify","spyOn","and","returnValue","shouldNotify"],"sources":["../../../../../../../static/rb/js/ui/views/tests/notificationManagerTests.es6.js"],"sourcesContent":["suite('rb/ui/managers/NotificationManagerModel', function() {\n    const instance = RB.NotificationManager.instance;\n    let origNotification;\n\n    const Notification = function(title, options) {\n        this.title = title;\n        this.options = options;\n        this.close = function() {};\n    };\n    Notification.requestPermission = function() {\n        Notification.permission = 'granted';\n    };\n\n    beforeEach(function() {\n        origNotification = RB.NotificationManager.Notification;\n        RB.NotificationManager.Notification = Notification;\n\n        RB.UserSession.instance.set('enableDesktopNotifications', true);\n\n        instance.setup();\n\n        expect(Notification.permission).toBe('granted');\n    });\n\n    afterEach(function() {\n        RB.NotificationManager.Notification = origNotification;\n    });\n\n    describe('Notification Manager', function() {\n        it('Calls external API', function() {\n            instance.notify({\n                title: 'Test',\n                body: 'This is a test',\n            });\n\n            const notification = instance._notification;\n            expect(notification).not.toBe(null);\n            expect(notification.title).toBe('Test');\n            expect(notification.options.body).toBe('This is a test');\n        });\n\n        it('Should notify', function() {\n            instance._canNotify = true;\n            spyOn(instance, '_haveNotificationPermissions')\n                .and.returnValue(true);\n\n            expect(instance.shouldNotify()).toBe(true);\n        });\n\n\n        it('Should not notify due to user permissions', function() {\n            instance._canNotify = false;\n            spyOn(instance, '_haveNotificationPermissions')\n                .and.returnValue(true);\n\n            expect(instance.shouldNotify()).toBe(false);\n        });\n\n         it('Should not notify due to browser permissions', function() {\n            instance._canNotify = true;\n            spyOn(instance, '_haveNotificationPermissions')\n                .and.returnValue(false);\n\n            expect(instance.shouldNotify()).toBe(false);\n        });\n    });\n});\n"],"mappings":";;AAAAA,KAAK,CAAC,yCAAyC,EAAE,YAAW;EACxD,MAAMC,QAAQ,GAAGC,EAAE,CAACC,mBAAmB,CAACF,QAAQ;EAChD,IAAIG,gBAAgB;EAEpB,MAAMC,YAAY,GAAG,SAAAA,CAASC,KAAK,EAAEC,OAAO,EAAE;IAC1C,IAAI,CAACD,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,KAAK,GAAG,YAAW,CAAC,CAAC;EAC9B,CAAC;EACDH,YAAY,CAACI,iBAAiB,GAAG,YAAW;IACxCJ,YAAY,CAACK,UAAU,GAAG,SAAS;EACvC,CAAC;EAEDC,UAAU,CAAC,YAAW;IAClBP,gBAAgB,GAAGF,EAAE,CAACC,mBAAmB,CAACE,YAAY;IACtDH,EAAE,CAACC,mBAAmB,CAACE,YAAY,GAAGA,YAAY;IAElDH,EAAE,CAACU,WAAW,CAACX,QAAQ,CAACY,GAAG,CAAC,4BAA4B,EAAE,IAAI,CAAC;IAE/DZ,QAAQ,CAACa,KAAK,CAAC,CAAC;IAEhBC,MAAM,CAACV,YAAY,CAACK,UAAU,CAAC,CAACM,IAAI,CAAC,SAAS,CAAC;EACnD,CAAC,CAAC;EAEFC,SAAS,CAAC,YAAW;IACjBf,EAAE,CAACC,mBAAmB,CAACE,YAAY,GAAGD,gBAAgB;EAC1D,CAAC,CAAC;EAEFc,QAAQ,CAAC,sBAAsB,EAAE,YAAW;IACxCC,EAAE,CAAC,oBAAoB,EAAE,YAAW;MAChClB,QAAQ,CAACmB,MAAM,CAAC;QACZd,KAAK,EAAE,MAAM;QACbe,IAAI,EAAE;MACV,CAAC,CAAC;MAEF,MAAMC,YAAY,GAAGrB,QAAQ,CAACsB,aAAa;MAC3CR,MAAM,CAACO,YAAY,CAAC,CAACE,GAAG,CAACR,IAAI,CAAC,IAAI,CAAC;MACnCD,MAAM,CAACO,YAAY,CAAChB,KAAK,CAAC,CAACU,IAAI,CAAC,MAAM,CAAC;MACvCD,MAAM,CAACO,YAAY,CAACf,OAAO,CAACc,IAAI,CAAC,CAACL,IAAI,CAAC,gBAAgB,CAAC;IAC5D,CAAC,CAAC;IAEFG,EAAE,CAAC,eAAe,EAAE,YAAW;MAC3BlB,QAAQ,CAACwB,UAAU,GAAG,IAAI;MAC1BC,KAAK,CAACzB,QAAQ,EAAE,8BAA8B,CAAC,CAC1C0B,GAAG,CAACC,WAAW,CAAC,IAAI,CAAC;MAE1Bb,MAAM,CAACd,QAAQ,CAAC4B,YAAY,CAAC,CAAC,CAAC,CAACb,IAAI,CAAC,IAAI,CAAC;IAC9C,CAAC,CAAC;IAGFG,EAAE,CAAC,2CAA2C,EAAE,YAAW;MACvDlB,QAAQ,CAACwB,UAAU,GAAG,KAAK;MAC3BC,KAAK,CAACzB,QAAQ,EAAE,8BAA8B,CAAC,CAC1C0B,GAAG,CAACC,WAAW,CAAC,IAAI,CAAC;MAE1Bb,MAAM,CAACd,QAAQ,CAAC4B,YAAY,CAAC,CAAC,CAAC,CAACb,IAAI,CAAC,KAAK,CAAC;IAC/C,CAAC,CAAC;IAEDG,EAAE,CAAC,8CAA8C,EAAE,YAAW;MAC3DlB,QAAQ,CAACwB,UAAU,GAAG,IAAI;MAC1BC,KAAK,CAACzB,QAAQ,EAAE,8BAA8B,CAAC,CAC1C0B,GAAG,CAACC,WAAW,CAAC,KAAK,CAAC;MAE3Bb,MAAM,CAACd,QAAQ,CAAC4B,YAAY,CAAC,CAAC,CAAC,CAACb,IAAI,CAAC,KAAK,CAAC;IAC/C,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}