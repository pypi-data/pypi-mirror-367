{"version":3,"file":"diffRevisionLabelView.js","names":["RB","DiffRevisionLabelView","Backbone","View","extend","events","template","_","_interdiffTemplate","gettext","_latestTemplate","_oldHeaderTemplate","_oldDetailTemplate","initialize","listenTo","model","render","revision","get","latestRevision","header","detail","interdiffRevision","$el","html","_onSelectLatest","ev","preventDefault","stopPropagation","trigger","_onSelectChanged"],"sources":["../../../../../../static/rb/js/diffviewer/views/diffRevisionLabelView.es6.js"],"sourcesContent":["/**\n * A view which explains the currently-shown revision of the diff.\n */\nRB.DiffRevisionLabelView = Backbone.View.extend({\n    events: {\n        'click .select-latest': '_onSelectLatest',\n        'click .select-changed': '_onSelectChanged',\n    },\n\n    /**\n     * Templates for various strings.\n     *\n     * We use _.template instead of interpolate to make sure that revision\n     * strings are HTML-escaped.\n     */\n    template: _.template(dedent`\n        <h1><%- header %></h1>\n        <% if (detail) { %><p><%= detail %><% } %>\n    `),\n    _interdiffTemplate: _.template(gettext(\n        'Changes between revision <%- revision %> and <%- interdiffRevision %>')),\n    _latestTemplate: _.template(gettext(\n        'Diff Revision <%- revision %> (Latest)')),\n    _oldHeaderTemplate: _.template(gettext('Diff Revision <%- revision %>')),\n    _oldDetailTemplate: _.template(\n        /* Translators: This string should be valid HTML (including any necessary escaping for entities). */\n        gettext('This is not the most recent revision of the diff. The <a href=\"#\" class=\"select-latest\">latest diff</a> is revision <%- latestRevision %>. <a href=\"#\" class=\"select-changed\">See what\\'s changed.</a>')),\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this.listenTo(this.model, 'change', this.render);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.DiffRevisionLabelView:\n     *     This object, for chaining.\n     */\n    render() {\n        const revision = this.model.get('revision');\n        const latestRevision = this.model.get('latestRevision');\n        let header = '';\n        let detail = null;\n\n        if (this.model.get('isInterdiff')) {\n            const interdiffRevision = this.model.get('interdiffRevision');\n\n            header = this._interdiffTemplate({\n                revision: revision,\n                interdiffRevision: interdiffRevision,\n            });\n        } else if (revision === latestRevision) {\n            header = this._latestTemplate({\n                revision: revision,\n            });\n        } else if (this.model.get('isDraftDiff')) {\n            header = gettext('Draft diff');\n            /* Translators: This string should be valid HTML (including any necessary escaping for entities). */\n            detail = gettext('This diff is part of your current draft. Other users will not see this diff until you publish your draft.');\n        } else {\n            header = this._oldHeaderTemplate({\n                revision: revision,\n            });\n            detail = this._oldDetailTemplate({\n                revision: revision,\n                latestRevision: latestRevision,\n            });\n        }\n\n        this.$el.html(this.template({\n            header: header,\n            detail: detail,\n        }));\n\n        return this;\n    },\n\n    /**\n     * Callback when the \"latest diff\" link is clicked.\n     *\n     * This is shown in the \"This is not the most recent revision\"\n     * explanation.\n     *\n     * Args:\n     *     ev (Event):\n     *         The click event.\n     */\n    _onSelectLatest(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        this.trigger('revisionSelected',\n                     [0, this.model.get('latestRevision')]);\n    },\n\n    /*\n     * Callback for when \"See what's changed\" is clicked.\n     *\n     * This is shown in the \"This is not the most recent revision\"\n     * explanation.\n     *\n     * Args:\n     *     ev (Event):\n     *         The click event.\n     */\n    _onSelectChanged(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        this.trigger('revisionSelected',\n                     [this.model.get('revision'),\n                      this.model.get('latestRevision')]);\n    },\n});\n"],"mappings":"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","ignoreList":[]}