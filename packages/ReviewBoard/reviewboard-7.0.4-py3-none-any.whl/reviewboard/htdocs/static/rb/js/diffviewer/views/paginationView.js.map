{"version":3,"file":"paginationView.js","names":["RB","PaginationView","Backbone","View","extend","template","_","events","initialize","listenTo","model","render","$el","empty","html","defaults","splitText","interpolate","gettext","get","previousPageText","nextPageText","currentPageText","extraURLOptions","_buildExtraQueryString","pageText","attributes","queryString","window","location","search","parts","startsWith","substr","split","newParts","i","length","part","push","join","_onPageClicked","ev","page","$","currentTarget","data","undefined","trigger","stopPropagation","preventDefault"],"sources":["../../../../../../static/rb/js/diffviewer/views/paginationView.es6.js"],"sourcesContent":["/**\n * A view for selecting pages.\n */\nRB.PaginationView = Backbone.View.extend({\n    template: _.template(dedent`\n        <% if (isPaginated) { %>\n         <%- splitText %>\n         <% if (hasPrevious) { %>\n          <span class=\"paginate-link\" data-page=\"<%- previousPage %>\"><a href=\"?page=<%- previousPage %><%= extraURLOptions %>\" title=\"<%- previousPageText %>\">&lt;</a></span>\n         <% } %>\n         <% _.each(pageNumbers, function(page) { %>\n          <% if (page === currentPage) { %>\n           <span class=\"paginate-current\" title=\"<%- currentPageText %>\"><%- page %></span>\n          <% } else { %>\n           <span class=\"paginate-link\" data-page=\"<%- page %>\"><a href=\"?page=<%- page %><%= extraURLOptions %>\"\n               title=\"<% print(interpolate(pageText, [page])); %>\"\n               ><%- page %></a></span>\n          <% } %>\n         <% }); %>\n         <% if (hasNext) { %>\n          <span class=\"paginate-link\" data-page=\"<%- nextPage %>\"><a href=\"?page=<%- nextPage %><%= extraURLOptions %>\" title=\"<%- nextPageText %>\">&gt;</a></span>\n         <% } %>\n        <% } %>\n    `),\n\n    events: {\n        'click .paginate-link': '_onPageClicked',\n    },\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this.listenTo(this.model, 'change', this.render);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.PaginationView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el\n            .empty()\n            .html(this.template(_.defaults({\n                splitText: interpolate(\n                    gettext('This diff has been split across %s pages:'),\n                    [this.model.get('pages')]),\n                previousPageText: gettext('Previous Page'),\n                nextPageText: gettext('Next Page'),\n                currentPageText: gettext('Current Page'),\n                extraURLOptions: this._buildExtraQueryString(),\n                pageText: gettext('Page %s'),\n            }, this.model.attributes)));\n\n        return this;\n    },\n\n    /**\n     * Build the extra query string to tack onto any pagination links.\n     *\n     * This will take the current query string on the page, strip out the\n     * ``page=`` part, and return the resulting query string for use in\n     * any links.\n     *\n     * Returns:\n     *     string:\n     *     The new query string to tack onto an existing URL. This will come\n     *     with a leading ``&`` if there's content in the string.\n     */\n    _buildExtraQueryString() {\n        /*\n         * Ideally we'd use Djblets.parseQueryString() for most of this, but\n         * that doesn't maintain order (and it's perhaps not worth doing so).\n         * We need to keep the order so that we generate query strings that\n         * can be effectively cached by the browser in a reliable way.\n         */\n        let queryString = window.location.search || '';\n        let parts = [];\n\n        if (queryString.startsWith('?')) {\n            queryString = queryString.substr(1);\n        }\n\n        if (queryString) {\n            parts = queryString.split('&');\n            const newParts = [];\n\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n\n                if (!part.startsWith('page=')) {\n                    newParts.push(part);\n                }\n            }\n\n            if (newParts.length > 0) {\n                return '&' + newParts.join('&');\n            }\n        }\n\n        return '';\n    },\n\n    /**\n     * Callback for when a page number is clicked.\n     *\n     * Args:\n     *     ev (Event):\n     *         The click event.\n     */\n    _onPageClicked(ev) {\n        const page = $(ev.currentTarget).data('page');\n\n        if (page !== undefined) {\n            this.trigger('pageSelected', page);\n\n            ev.stopPropagation();\n            ev.preventDefault();\n        }\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACAA,EAAE,CAACC,cAAc,GAAGC,QAAQ,CAACC,IAAI,CAACC,MAAM,CAAC;EACrCC,QAAQ,EAAEC,CAAC,CAACD,QAAQ,CAAO;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAEK,CAAC;EAEFE,MAAM,EAAE;IACJ,sBAAsB,EAAE;EAC5B,CAAC;EAED;AACJ;AACA;EACIC,UAAUA,CAAA,EAAG;IACT,IAAI,CAACC,QAAQ,CAAC,IAAI,CAACC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAACC,MAAM,CAAC;EACpD,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIA,MAAMA,CAAA,EAAG;IACL,IAAI,CAACC,GAAG,CACHC,KAAK,CAAC,CAAC,CACPC,IAAI,CAAC,IAAI,CAACT,QAAQ,CAACC,CAAC,CAACS,QAAQ,CAAC;MAC3BC,SAAS,EAAEC,WAAW,CAAAC,OAAA,+CAElB,CAAC,IAAI,CAACR,KAAK,CAACS,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;MAC9BC,gBAAgB,EAAAF,OAAA,iBAA0B;MAC1CG,YAAY,EAAAH,OAAA,aAAsB;MAClCI,eAAe,EAAAJ,OAAA,gBAAyB;MACxCK,eAAe,EAAE,IAAI,CAACC,sBAAsB,CAAC,CAAC;MAC9CC,QAAQ,EAAAP,OAAA;IACZ,CAAC,EAAE,IAAI,CAACR,KAAK,CAACgB,UAAU,CAAC,CAAC,CAAC;IAE/B,OAAO,IAAI;EACf,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIF,sBAAsBA,CAAA,EAAG;IACrB;AACR;AACA;AACA;AACA;AACA;IACQ,IAAIG,WAAW,GAAGC,MAAM,CAACC,QAAQ,CAACC,MAAM,IAAI,EAAE;IAC9C,IAAIC,KAAK,GAAG,EAAE;IAEd,IAAIJ,WAAW,CAACK,UAAU,CAAC,GAAG,CAAC,EAAE;MAC7BL,WAAW,GAAGA,WAAW,CAACM,MAAM,CAAC,CAAC,CAAC;IACvC;IAEA,IAAIN,WAAW,EAAE;MACbI,KAAK,GAAGJ,WAAW,CAACO,KAAK,CAAC,GAAG,CAAC;MAC9B,MAAMC,QAAQ,GAAG,EAAE;MAEnB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,KAAK,CAACM,MAAM,EAAED,CAAC,EAAE,EAAE;QACnC,MAAME,IAAI,GAAGP,KAAK,CAACK,CAAC,CAAC;QAErB,IAAI,CAACE,IAAI,CAACN,UAAU,CAAC,OAAO,CAAC,EAAE;UAC3BG,QAAQ,CAACI,IAAI,CAACD,IAAI,CAAC;QACvB;MACJ;MAEA,IAAIH,QAAQ,CAACE,MAAM,GAAG,CAAC,EAAE;QACrB,OAAO,GAAG,GAAGF,QAAQ,CAACK,IAAI,CAAC,GAAG,CAAC;MACnC;IACJ;IAEA,OAAO,EAAE;EACb,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,cAAcA,CAACC,EAAE,EAAE;IACf,MAAMC,IAAI,GAAGC,CAAC,CAACF,EAAE,CAACG,aAAa,CAAC,CAACC,IAAI,CAAC,MAAM,CAAC;IAE7C,IAAIH,IAAI,KAAKI,SAAS,EAAE;MACpB,IAAI,CAACC,OAAO,CAAC,cAAc,EAAEL,IAAI,CAAC;MAElCD,EAAE,CAACO,eAAe,CAAC,CAAC;MACpBP,EAAE,CAACQ,cAAc,CAAC,CAAC;IACvB;EACJ;AACJ,CAAC,CAAC","ignoreList":[]}