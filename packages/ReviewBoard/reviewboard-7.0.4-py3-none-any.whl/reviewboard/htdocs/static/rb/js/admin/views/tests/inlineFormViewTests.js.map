{"version":3,"file":"inlineFormViewTests.js","names":["suite","template","_","$el","model","view","beforeEach","$","index","RB","Admin","InlineForm","prefix","InlineFormView","el","render","describe","$delete","spyOn","window","and","returnValue","find","it","set","click","expect","confirm","not","toHaveBeenCalled","destroy","$labels","$inputs","$titleIndex","length","toBe","id","text","htmlFor","inputEl","name"],"sources":["../../../../../../../static/rb/js/admin/views/tests/inlineFormViewTests.es6.js"],"sourcesContent":["suite('rb/admin/views/InlineFormView', function() {\n    const template = _.template(dedent`\n        <div class=\"rb-c-admin-form-inline\">\n         <h3 class=\"rb-c-admin-form-inline__title\">\n          <span class=\"rb-c-admin-form-inline__title-prefix\"></span>\n          <span class=\"rb-c-admin-form-inline__title-object\"></span>\n          <span class=\"rb-c-admin-form-inline__title-index\"></span>\n          <span class=\"rb-c-admin-form-inline__actions\">\n           <span class=\"rb-c-admin-form-inline__delete-action\"></span>\n          </span>\n         </h3>\n         <fieldset>\n          <div>\n           <label for=\"id_myprefix-<%- index %>-foo\"></label>\n           <input id=\"id_myprefix-<%- index %>-foo\"\n                  name=\"myprefix-<%- index %>-foo\">\n          </div>\n          <div>\n           <label for=\"id_myprefix-<%- index %>-bar\"></label>\n           <input id=\"id_myprefix-<%- index %>-bar\"\n                  name=\"myprefix-<%- index %>-bar\">\n          </div>\n         </fieldset>\n        </div>\n    `);\n\n    let $el;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        $el = $(template({\n            index: '__prefix__',\n        }));\n\n        model = new RB.Admin.InlineForm({\n            prefix: 'myprefix',\n        });\n\n        view = new RB.Admin.InlineFormView({\n            el: $el,\n            model: model,\n        });\n        view.render();\n    });\n\n    describe('Events', function() {\n        describe('Delete clicked', function() {\n            let $delete;\n\n            beforeEach(function() {\n                spyOn(window, 'confirm').and.returnValue(true);\n                spyOn(model, 'destroy');\n\n                $delete = $el.find('.rb-c-admin-form-inline__delete-action');\n            });\n\n            it('With isInitial=true', function() {\n                model.set('isInitial', true);\n\n                $delete.click();\n\n                expect(window.confirm).not.toHaveBeenCalled();\n                expect(model.destroy).not.toHaveBeenCalled();\n            });\n\n            it('With isInitial=false', function() {\n                model.set('isInitial', false);\n\n                $delete.click();\n\n                expect(window.confirm).toHaveBeenCalled();\n                expect(model.destroy).toHaveBeenCalled();\n            });\n        });\n\n        describe('Index changed', function() {\n            let $labels;\n            let $inputs;\n            let $titleIndex;\n\n            beforeEach(function() {\n                $labels = $el.find('label');\n                $inputs = $el.find('input');\n                $titleIndex = $el.find('.rb-c-admin-form-inline__title-index');\n\n                expect($labels.length).toBe(2);\n                expect($inputs.length).toBe(2);\n                expect($titleIndex.length).toBe(1);\n            });\n\n            it('From __prefix__ to index', function() {\n                model.set('index', 0);\n\n                expect($el[0].id).toBe('myprefix-0');\n                expect($titleIndex.text()).toBe('#1');\n\n                expect($labels[0].htmlFor).toBe('id_myprefix-0-foo');\n                expect($labels[1].htmlFor).toBe('id_myprefix-0-bar');\n\n                let inputEl = $inputs[0];\n                expect(inputEl.id).toBe('id_myprefix-0-foo');\n                expect(inputEl.name).toBe('myprefix-0-foo');\n\n                inputEl = $inputs[1];\n                expect(inputEl.id).toBe('id_myprefix-0-bar');\n                expect(inputEl.name).toBe('myprefix-0-bar');\n            });\n\n            it('From index to index', function() {\n                model.set('index', 0);\n                model.set('index', 1);\n\n                expect($el[0].id).toBe('myprefix-1');\n                expect($titleIndex.text()).toBe('#2');\n\n                expect($labels[0].htmlFor).toBe('id_myprefix-1-foo');\n                expect($labels[1].htmlFor).toBe('id_myprefix-1-bar');\n\n                let inputEl = $inputs[0];\n                expect(inputEl.id).toBe('id_myprefix-1-foo');\n                expect(inputEl.name).toBe('myprefix-1-foo');\n\n                inputEl = $inputs[1];\n                expect(inputEl.id).toBe('id_myprefix-1-bar');\n                expect(inputEl.name).toBe('myprefix-1-bar');\n            });\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}