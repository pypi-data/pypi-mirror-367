{"version":3,"file":"newsWidgetView.js","names":["RB","Admin","NewsWidgetView","WidgetView","extend","canReload","reloadTitle","gettext","itemsTemplate","_","template","renderWidget","model","addFooterAction","id","el","$","text","attr","get","subscribeURL","cssClasses","listenTo","setReloading","_onNewsItemsChanged","loadNews","reloadContent","items","length","$content","html","$error","interpolate","empty","append","trigger"],"sources":["../../../../../../static/rb/js/admin/views/newsWidgetView.es6.js"],"sourcesContent":["/**\n * A widget for displaying news items from an RSS feed.\n */\nRB.Admin.NewsWidgetView = RB.Admin.WidgetView.extend({\n    canReload: true,\n    reloadTitle: gettext('Reload news posts'),\n\n    itemsTemplate: _.template(dedent`\n        <% _.each(items, function(item) { %>\n         <a href=\"<%- item.url %>\" class=\"rb-c-admin-news-widget__item\"\n            target=\"_blank\">\n          <span class=\"rb-c-admin-news-widget__item-date\">\n           <%- item.date.format('MMM DD') %>\n          </span>\n          <span class=\"rb-c-admin-news-widget__item-title\">\n           <%- item.title %>\n          </span>\n         </a>\n        <% }) %>\n    `),\n\n    /**\n     * Render the widget.\n     *\n     * This will set up the actions and begin loading the news.\n     */\n    renderWidget() {\n        const model = this.model;\n\n        this.addFooterAction({\n            id: 'more-news',\n            el: $('<a href=\"#\" target=\"_blank\">')\n                .text(gettext('More News'))\n                .attr('href', model.get('newsURL')),\n        });\n\n        const subscribeURL = this.model.get('subscribeURL');\n\n        if (subscribeURL) {\n            this.addFooterAction({\n                id: 'subscribe',\n                cssClasses: '-is-right',\n                el: $('<a href=\"#\" target=\"_blank\">')\n                    .text(gettext('Subscribe'))\n                    .attr('href', subscribeURL),\n            });\n        }\n\n        this.listenTo(model, 'loadingNews',\n                      () => this.setReloading(true));\n        this.listenTo(model, 'change:newsItems', this._onNewsItemsChanged);\n\n        model.loadNews();\n    },\n\n    /**\n     * Reload the news posts.\n     *\n     * This is called in response to a user clicking the Reload action.\n     */\n    reloadContent() {\n        this.model.loadNews();\n    },\n\n    /**\n     * Handle changes to the list of loaded news items.\n     *\n     * If the list is empty, this will present an error pointing to the news\n     * feed. Otherwise, it will render each of the news items.\n     */\n    _onNewsItemsChanged() {\n        const items = this.model.get('newsItems');\n\n        this.setReloading(false);\n\n        if (items.length > 0) {\n            this.$content.html(this.itemsTemplate({\n                items: items,\n            }));\n        } else {\n            const $error = $('<p class=\"rb-c-admin-news-widget__error\">')\n                .html(interpolate(\n                    gettext('There was an error loading the news. Please <a href=\"%s\">visit the news page</a> directly, or try again later.'),\n                    [this.model.get('newsURL')]));\n\n            this.$content\n                .empty()\n                .append($error);\n        }\n\n        this.trigger('sizeChanged');\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACAA,EAAE,CAACC,KAAK,CAACC,cAAc,GAAGF,EAAE,CAACC,KAAK,CAACE,UAAU,CAACC,MAAM,CAAC;EACjDC,SAAS,EAAE,IAAI;EACfC,WAAW,EAAAC,OAAA,qBAA8B;EAEzCC,aAAa,EAAEC,CAAC,CAACC,QAAQ,CAAO;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAEK,CAAC;EAEF;AACJ;AACA;AACA;AACA;EACIC,YAAYA,CAAA,EAAG;IACX,MAAMC,KAAK,GAAG,IAAI,CAACA,KAAK;IAExB,IAAI,CAACC,eAAe,CAAC;MACjBC,EAAE,EAAE,WAAW;MACfC,EAAE,EAAEC,CAAC,CAAC,8BAA8B,CAAC,CAChCC,IAAI,CAAAV,OAAA,aAAqB,CAAC,CAC1BW,IAAI,CAAC,MAAM,EAAEN,KAAK,CAACO,GAAG,CAAC,SAAS,CAAC;IAC1C,CAAC,CAAC;IAEF,MAAMC,YAAY,GAAG,IAAI,CAACR,KAAK,CAACO,GAAG,CAAC,cAAc,CAAC;IAEnD,IAAIC,YAAY,EAAE;MACd,IAAI,CAACP,eAAe,CAAC;QACjBC,EAAE,EAAE,WAAW;QACfO,UAAU,EAAE,WAAW;QACvBN,EAAE,EAAEC,CAAC,CAAC,8BAA8B,CAAC,CAChCC,IAAI,CAAAV,OAAA,aAAqB,CAAC,CAC1BW,IAAI,CAAC,MAAM,EAAEE,YAAY;MAClC,CAAC,CAAC;IACN;IAEA,IAAI,CAACE,QAAQ,CAACV,KAAK,EAAE,aAAa,EACpB,MAAM,IAAI,CAACW,YAAY,CAAC,IAAI,CAAC,CAAC;IAC5C,IAAI,CAACD,QAAQ,CAACV,KAAK,EAAE,kBAAkB,EAAE,IAAI,CAACY,mBAAmB,CAAC;IAElEZ,KAAK,CAACa,QAAQ,CAAC,CAAC;EACpB,CAAC;EAED;AACJ;AACA;AACA;AACA;EACIC,aAAaA,CAAA,EAAG;IACZ,IAAI,CAACd,KAAK,CAACa,QAAQ,CAAC,CAAC;EACzB,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;EACID,mBAAmBA,CAAA,EAAG;IAClB,MAAMG,KAAK,GAAG,IAAI,CAACf,KAAK,CAACO,GAAG,CAAC,WAAW,CAAC;IAEzC,IAAI,CAACI,YAAY,CAAC,KAAK,CAAC;IAExB,IAAII,KAAK,CAACC,MAAM,GAAG,CAAC,EAAE;MAClB,IAAI,CAACC,QAAQ,CAACC,IAAI,CAAC,IAAI,CAACtB,aAAa,CAAC;QAClCmB,KAAK,EAAEA;MACX,CAAC,CAAC,CAAC;IACP,CAAC,MAAM;MACH,MAAMI,MAAM,GAAGf,CAAC,CAAC,2CAA2C,CAAC,CACxDc,IAAI,CAACE,WAAW,CAAAzB,OAAA,sHAEb,CAAC,IAAI,CAACK,KAAK,CAACO,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;MAErC,IAAI,CAACU,QAAQ,CACRI,KAAK,CAAC,CAAC,CACPC,MAAM,CAACH,MAAM,CAAC;IACvB;IAEA,IAAI,CAACI,OAAO,CAAC,aAAa,CAAC;EAC/B;AACJ,CAAC,CAAC","ignoreList":[]}