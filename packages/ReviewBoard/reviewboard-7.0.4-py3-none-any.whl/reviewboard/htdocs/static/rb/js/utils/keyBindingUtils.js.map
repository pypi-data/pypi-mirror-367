{"version":3,"file":"keyBindingUtils.js","names":["RB","KeyBindingsMixin","delegateKeyBindings","$el","on","cid","_","bind","evt","altKey","ctrlKey","metaKey","target","tagName","isContentEditable","keyChar","String","fromCharCode","which","keys","Object","keyBindings","indexOf","stopPropagation","preventDefault","func","isFunction","call","undelegateKeyBindings","off","delegateEvents","events","result","Backbone","View","prototype","undelegateEvents"],"sources":["../../../../../static/rb/js/utils/keyBindingUtils.es6.js"],"sourcesContent":["/**\n * A mixin for views that provides key binding functionality.\n *\n * Views using this mixin can provide a keyBindings map that maps a set of\n * key characters to a function.\n */\nRB.KeyBindingsMixin = {\n    /**\n     * Enable key bindings for the view.\n     *\n     * Begins listening for any key bindings registered in the view's\n     * keyBindings map, and calls the appropriate function.\n     *\n     * By default, this is called automatically when setting up the view,\n     * by way of delegateEvents.\n     */\n    delegateKeyBindings() {\n        this.$el.on(`keypress.keybindings.${this.cid}`, _.bind(function(evt) {\n            if (evt.altKey || evt.ctrlKey || evt.metaKey ||\n                evt.target.tagName === 'INPUT' ||\n                evt.target.tagName === 'TEXTAREA' ||\n                evt.target.isContentEditable) {\n                /* These are all unsupported, and things we want to ignore. */\n                return;\n            }\n\n            const keyChar = String.fromCharCode(evt.which);\n\n            for (let keys of Object.keys(this.keyBindings)) {\n                if (keys.indexOf(keyChar) !== -1) {\n                    evt.stopPropagation();\n                    evt.preventDefault();\n\n                    let func = this.keyBindings[keys];\n\n                    if (!_.isFunction(func)) {\n                        func = this[func];\n                    }\n\n                    func.call(this, evt);\n                }\n            }\n        }, this));\n    },\n\n    /**\n     * Disable key bindings for the view.\n     *\n     * By default, this is called automatically when calling undelegateEvents.\n     */\n    undelegateKeyBindings() {\n        if (this.$el) {\n            this.$el.off(`keypress.keybindings.${this.cid}`);\n        }\n    },\n\n    /**\n     * Delegate both DOM events and key binding events.\n     *\n     * This overrides the default Backbone.View.delegateEvents to automatically\n     * call delegateKeyBindings.\n     */\n    delegateEvents(events) {\n        const result = Backbone.View.prototype.delegateEvents.call(this, events);\n\n        this.delegateKeyBindings();\n\n        return result;\n    },\n\n    /**\n     * Undelegate both DOM events and key binding events.\n     *\n     * This overrides the default Backbone.View.undelegateEvents to\n     * automatically call undelegateKeyBindings.\n     */\n    undelegateEvents() {\n        const result = Backbone.View.prototype.undelegateEvents.call(this);\n\n        this.undelegateKeyBindings();\n\n        return result;\n    }\n};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,gBAAgB,GAAG;EAClB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIC,mBAAmBA,CAAA,EAAG;IAClB,IAAI,CAACC,GAAG,CAACC,EAAE,CAAC,wBAAwB,IAAI,CAACC,GAAG,EAAE,EAAEC,CAAC,CAACC,IAAI,CAAC,UAASC,GAAG,EAAE;MACjE,IAAIA,GAAG,CAACC,MAAM,IAAID,GAAG,CAACE,OAAO,IAAIF,GAAG,CAACG,OAAO,IACxCH,GAAG,CAACI,MAAM,CAACC,OAAO,KAAK,OAAO,IAC9BL,GAAG,CAACI,MAAM,CAACC,OAAO,KAAK,UAAU,IACjCL,GAAG,CAACI,MAAM,CAACE,iBAAiB,EAAE;QAC9B;QACA;MACJ;MAEA,MAAMC,OAAO,GAAGC,MAAM,CAACC,YAAY,CAACT,GAAG,CAACU,KAAK,CAAC;MAE9C,KAAK,IAAIC,IAAI,IAAIC,MAAM,CAACD,IAAI,CAAC,IAAI,CAACE,WAAW,CAAC,EAAE;QAC5C,IAAIF,IAAI,CAACG,OAAO,CAACP,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE;UAC9BP,GAAG,CAACe,eAAe,CAAC,CAAC;UACrBf,GAAG,CAACgB,cAAc,CAAC,CAAC;UAEpB,IAAIC,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACF,IAAI,CAAC;UAEjC,IAAI,CAACb,CAAC,CAACoB,UAAU,CAACD,IAAI,CAAC,EAAE;YACrBA,IAAI,GAAG,IAAI,CAACA,IAAI,CAAC;UACrB;UAEAA,IAAI,CAACE,IAAI,CAAC,IAAI,EAAEnB,GAAG,CAAC;QACxB;MACJ;IACJ,CAAC,EAAE,IAAI,CAAC,CAAC;EACb,CAAC;EAED;AACJ;AACA;AACA;AACA;EACIoB,qBAAqBA,CAAA,EAAG;IACpB,IAAI,IAAI,CAACzB,GAAG,EAAE;MACV,IAAI,CAACA,GAAG,CAAC0B,GAAG,CAAC,wBAAwB,IAAI,CAACxB,GAAG,EAAE,CAAC;IACpD;EACJ,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;EACIyB,cAAcA,CAACC,MAAM,EAAE;IACnB,MAAMC,MAAM,GAAGC,QAAQ,CAACC,IAAI,CAACC,SAAS,CAACL,cAAc,CAACH,IAAI,CAAC,IAAI,EAAEI,MAAM,CAAC;IAExE,IAAI,CAAC7B,mBAAmB,CAAC,CAAC;IAE1B,OAAO8B,MAAM;EACjB,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;EACII,gBAAgBA,CAAA,EAAG;IACf,MAAMJ,MAAM,GAAGC,QAAQ,CAACC,IAAI,CAACC,SAAS,CAACC,gBAAgB,CAACT,IAAI,CAAC,IAAI,CAAC;IAElE,IAAI,CAACC,qBAAqB,CAAC,CAAC;IAE5B,OAAOI,MAAM;EACjB;AACJ,CAAC","ignoreList":[]}