{"version":3,"file":"newsWidgetViewTests.js","names":["suite","template","model","view","beforeEach","RB","Admin","NewsWidget","newsURL","NewsWidgetView","el","$","spyOn","describe","it","render","$actions","$footerActions","children","expect","length","toBe","$action","eq","hasClass","toBeTrue","attr","set","$headerActions","toBeFalse","trigger","setReloading","date","moment","Date","UTC","title","url","$items","$content","$item","find","text","trim","$els","$error","html"],"sources":["../../../../../../../static/rb/js/admin/views/tests/newsWidgetViewTests.es6.js"],"sourcesContent":["suite('rb/admin/views/NewsWidgetView', function() {\n    const template = dedent`\n        <div class=\"rb-c-admin-widget rb-c-news-admin-widget\">\n         <header class=\"rb-c-admin-widget__header\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </header>\n         <div class=\"rb-c-admin-widget__content\"></div>\n         <footer class=\"rb-c-admin-widget__footer\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </footer>\n        </div>\n    `;\n\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            newsURL: 'http://example.com/news/',\n        });\n\n        view = new RB.Admin.NewsWidgetView({\n            el: $(template),\n            model: model,\n        });\n\n        spyOn(model, 'loadNews');\n    });\n\n    describe('Rendering', function() {\n        describe('Actions', function() {\n            it('More News', function() {\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(1);\n\n                const $action = $actions.eq(0);\n                expect($action.hasClass('js-action-more-news')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/');\n            });\n\n            it('Subscribe', function() {\n                model.set('subscribeURL', 'http://example.com/news/subscribe/');\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(2);\n\n                const $action = $actions.eq(1);\n                expect($action.hasClass('js-action-subscribe')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/subscribe/');\n            });\n\n            describe('Reload', function() {\n                it('On loadingNews event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n\n                    model.trigger('loadingNews');\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n                });\n\n                it('On change:newsItems event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n\n                    view.setReloading(true);\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n\n                    model.set('newsItems', []);\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n                });\n            });\n        });\n\n        it('News items', function() {\n            view.render();\n\n            model.set('newsItems', [\n                {\n                    date: moment(Date.UTC(2019, 9, 21, 0, 26, 32)),\n                    title: 'Headline 6',\n                    url: 'http://example.com/news/post6',\n                },\n                {\n                    date: moment(Date.UTC(2019, 9, 1, 20, 29, 0)),\n                    title: 'Headline 5',\n                    url: 'http://example.com/news/post5',\n                },\n                {\n                    date: moment(Date.UTC(2019, 8, 27, 2, 29, 33)),\n                    title: 'Headline 4',\n                    url: 'http://example.com/news/post4',\n                },\n            ]);\n\n            const $items = view.$content.children();\n            expect($items.length).toBe(3);\n\n            let $item = $items.eq(0);\n            expect($item.attr('href')).toBe('http://example.com/news/post6');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date').text().trim()\n            ).toBe('Oct 20');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title').text().trim()\n            ).toBe('Headline 6');\n\n            $item = $items.eq(1);\n            expect($item.attr('href')).toBe('http://example.com/news/post5');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().trim()\n            ).toBe('Oct 01');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().trim()\n            ).toBe('Headline 5');\n\n            $item = $items.eq(2);\n            expect($item.attr('href')).toBe('http://example.com/news/post4');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().trim()\n            ).toBe('Sep 26');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().trim()\n            ).toBe('Headline 4');\n        });\n\n        it('Load errors', function() {\n            view.render();\n\n            model.set('newsItems', []);\n\n            const $els = view.$content.children();\n            expect($els.length).toBe(1);\n\n            const $error = $els.eq(0);\n            expect($error.hasClass('rb-c-admin-news-widget__error'))\n                .toBeTrue();\n            expect($error.html().trim()).toBe(\n                'There was an error loading the news. Please ' +\n                '<a href=\"http://example.com/news/\">visit the news page</a> ' +\n                'directly, or try again later.');\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}