{"version":3,"file":"draftReviewRequestModelTests.js","names":["suite","draft","beforeEach","reviewRequest","RB","ReviewRequest","id","links","href","spyOn","and","resolveTo","it","expect","url","toBe","describe","callThrough","$","callFake","request","data","public","success","stat","set","targetGroups","name","summary","description","publish","apiCall","toHaveBeenCalled","ajax","done","console","warn","error","fail","parse","branch","bugs_closed","changedescription","changedescription_text_type","description_text_type","target_groups","target_people","testing_done","testing_done_text_type","submitter","not","undefined","bugsClosed","changeDescription","changeDescriptionRichText","descriptionRichText","targetPeople","testingDone","testingDoneRichText"],"sources":["../../../../../../../static/rb/js/resources/models/tests/draftReviewRequestModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/DraftReviewRequest', function() {\n    let draft;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest({\n            id: 1,\n            links: {\n                draft: {\n                    href: '/api/review-requests/123/draft/',\n                },\n            },\n        });\n\n        draft = reviewRequest.draft;\n\n        spyOn(reviewRequest, 'ready').and.resolveTo();\n        spyOn(reviewRequest, 'ensureCreated').and.resolveTo();\n        spyOn(draft, 'ready').and.resolveTo();\n    });\n\n    it('url', function() {\n        expect(draft.url()).toBe('/api/review-requests/123/draft/');\n    });\n\n    describe('publish', function() {\n        it('With promises', async function() {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.data.public).toBe(1);\n\n                request.success({\n                    stat: 'ok',\n                    draft: {\n                        id: 1,\n                        links: {},\n                    },\n                });\n            });\n\n            /* Set some fields in order to pass validation. */\n            draft.set({\n                targetGroups: [{\n                    name: 'mygroup',\n                    url: '/groups/mygroup',\n                }],\n                summary: 'My summary',\n                description: 'My description',\n            });\n\n            await draft.publish();\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n        });\n\n        it('With callbacks', function(done) {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.data.public).toBe(1);\n\n                request.success({\n                    stat: 'ok',\n                    draft: {\n                        id: 1,\n                        links: {},\n                    },\n                });\n            });\n            spyOn(console, 'warn');\n\n            /* Set some fields in order to pass validation. */\n            draft.set({\n                targetGroups: [{\n                    name: 'mygroup',\n                    url: '/groups/mygroup',\n                }],\n                summary: 'My summary',\n                description: 'My description',\n            });\n\n            draft.publish({\n                success: () => {\n                    expect(RB.apiCall).toHaveBeenCalled();\n                    expect($.ajax).toHaveBeenCalled();\n                    expect(console.warn).toHaveBeenCalled();\n\n                    done();\n                },\n                error: () => done.fail(),\n            });\n        });\n    });\n\n    it('parse', function() {\n        const data = draft.parse({\n            stat: 'ok',\n            draft: {\n                id: 1,\n                branch: 'branch',\n                bugs_closed: 'bugsClosed',\n                changedescription: 'changeDescription',\n                changedescription_text_type: 'markdown',\n                description: 'description',\n                'public': 'public',\n                description_text_type: 'markdown',\n                summary: 'summary',\n                target_groups: 'targetGroups',\n                target_people: 'targetPeople',\n                testing_done: 'testingDone',\n                testing_done_text_type: 'plain',\n                links: {\n                    submitter: 'submitter',\n                },\n            },\n        });\n\n        expect(data).not.toBe(undefined);\n        expect(data.id).toBe(1);\n        expect(data.branch).toBe('branch');\n        expect(data.bugsClosed).toBe('bugsClosed');\n        expect(data.changeDescription).toBe('changeDescription');\n        expect(data.changeDescriptionRichText).toBe(true);\n        expect(data.description).toBe('description');\n        expect(data.descriptionRichText).toBe(true);\n        expect(data.public).toBe('public');\n        expect(data.summary).toBe('summary');\n        expect(data.submitter).toBe('submitter');\n        expect(data.targetGroups).toBe('targetGroups');\n        expect(data.targetPeople).toBe('targetPeople');\n        expect(data.testingDone).toBe('testingDone');\n        expect(data.testingDoneRichText).toBe(false);\n    });\n});\n"],"mappings":"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","ignoreList":[]}