{"version":3,"file":"apiTokensView.js","names":["POLICY_READ_WRITE","POLICY_READ_ONLY","POLICY_CUSTOM","POLICY_LABELS","gettext","APITokenItem","RB","Config","ResourceListItem","extend","defaults","_","policyType","lastUsed","localSiteName","showRemove","prototype","syncAttrs","initialize","_super","apply","arguments","on","_onPolicyTypeChanged","policy","get","_guessPolicyType","_policyMenuAction","id","label","children","_makePolicyAction","dispatchOnClick","actions","unshift","set","createResource","attrs","APIToken","userName","UserSession","instance","localSitePrefix","collection","saveExpires","expires","_saveAttribute","saveNote","note","savePolicy","attr","value","resource","ready","save","isEqual","defaultPolicies","readOnly","readWrite","options","type","name","propName","radioValue","trigger","newPolicy","console","assert","APITokenItemCollection","Backbone","Collection","model","models","PolicyEditorView","View","template","join","prevPolicyType","_codeMirror","_$policy","_$saveButtons","render","isEmpty","custom","$el","html","instructions","interpolate","MANUAL_URL","$","val","JSON","stringify","modalBox","title","buttons","Ink","paintComponent","onClick","cancel","class","find","CodeMirror","fromTextArea","mode","highlightFormatting","lineNumbers","lineWrapping","matchBrackets","lint","onUpdateLinting","bind","_onUpdateLinting","gutters","styleSelectedText","theme","focus","remove","closeOnSave","policyStr","getValue","trim","parse","e","SyntaxError","alert","err","xhr","errorPayload","code","fields","msg","annotationsNotSorted","prop","length","APITokenItemView","Djblets","ListItemView","EMPTY_NOTE_PLACEHOLDER","events","actionHandlers","_$expires","_$note","_$tokenState","listenTo","_updateExpires","_updateNote","call","not","noteEditor","InlineEditorView","editIconClass","el","hasShortButtons","setValue","moment","local","format","expiresView","DateTimeInlineEditorView","descriptorText","formatResult","today","expired","isAfter","prefix","addClass","removeClass","rawValue","beginEdit","getActionsParent","getRenderContext","expiresTimeHTML","timesince","toggleClass","text","_onCopyClicked","preventDefault","stopPropagation","select","document","execCommand","_onCustomPolicyClicked","view","_onRemoveClicked","click","destroy","SiteAPITokensView","className","generateTokenTemplate","apiTokens","apiTokensList","List","_listView","ListView","ItemView","animateItems","prependTo","_$generateTokenItem","generateText","appendTo","getBody","_onGenerateClicked","apiToken","add","detach","APITokensView","_$listsContainer","_apiTokenViews","info","Object","entries","tokens","push"],"sources":["../../../../../../static/rb/js/accountPrefsPage/views/apiTokensView.es6.js"],"sourcesContent":["(function() {\n\n\nconst POLICY_READ_WRITE = 'rw';\nconst POLICY_READ_ONLY = 'ro';\nconst POLICY_CUSTOM = 'custom';\nconst POLICY_LABELS = {\n    [POLICY_READ_WRITE]: gettext('Full access'),\n    [POLICY_READ_ONLY]: gettext('Read-only'),\n    [POLICY_CUSTOM]: gettext('Custom')\n};\n\n\n/**\n * Represents an API token in the list.\n *\n * This provides actions for editing the policy type for the token and\n * removing the token.\n */\nconst APITokenItem = RB.Config.ResourceListItem.extend({\n    defaults: _.defaults({\n        policyType: POLICY_READ_WRITE,\n        lastUsed: null,\n        localSiteName: null,\n        showRemove: true,\n    }, RB.Config.ResourceListItem.prototype.defaults),\n\n    syncAttrs: [\n        'deprecated',\n        'expired',\n        'expires',\n        'id',\n        'invalidReason',\n        'invalidDate',\n        'lastUsed',\n        'note',\n        'policy',\n        'tokenValue',\n        'valid',\n    ],\n\n    /**\n     * Initialize the item.\n     *\n     * This computes the type of policy used, for display, and builds the\n     * policy actions menu.\n     */\n    initialize() {\n        _super(this).initialize.apply(this, arguments);\n\n        this.on('change:policyType', this._onPolicyTypeChanged, this);\n\n        const policy = this.get('policy') || {};\n        const policyType = this._guessPolicyType(policy);\n\n        this._policyMenuAction = {\n            id: 'policy',\n            label: POLICY_LABELS[policyType],\n            children: [\n                this._makePolicyAction(POLICY_READ_WRITE),\n                this._makePolicyAction(POLICY_READ_ONLY),\n                this._makePolicyAction(POLICY_CUSTOM, {\n                    id: 'policy-custom',\n                    dispatchOnClick: true\n                })\n            ]\n        };\n        this.actions.unshift(this._policyMenuAction);\n\n        this.set('policyType', policyType);\n    },\n\n    /**\n     * Create an APIToken resource for the given attributes.\n     *\n     * Args:\n     *     attrs (object):\n     *         Additional attributes for the APIToken.\n     */\n    createResource(attrs) {\n        return new RB.APIToken(_.defaults({\n            userName: RB.UserSession.instance.get('username'),\n            localSitePrefix: this.collection.localSitePrefix\n        }, attrs));\n    },\n\n    /**\n     * Set the provided expiration date on the token and save it.\n     *\n     * Args:\n     *     expires (string):\n     *         The new expiration date for the token. If this is an\n     *         empty string, the token will be set to have no expiration.\n     */\n    saveExpires(expires) {\n        this._saveAttribute('expires', expires);\n    },\n\n    /**\n     * Set the provided note on the token and save it.\n     *\n     * Args:\n     *     note (string):\n     *         The new note for the token.\n     */\n    saveNote(note) {\n        this._saveAttribute('note', note);\n    },\n\n    /**\n     * Set the provided policy on the token and save it.\n     *\n     * Args:\n     *     policy (object):\n     *         The new policy for the token.\n     *\n     * Returns:\n     *     Promise:\n     *     A promise which resolves when the operation is complete.\n     */\n    savePolicy(policy) {\n        return this._saveAttribute('policy', policy);\n    },\n\n    /**\n     * Set an attribute on the token and save it.\n     *\n     * This is a helper function that will set an attribute on the token\n     * and save it, but only after the token is ready.\n     *\n     * Args:\n     *     attr (string):\n     *         The name of the attribute to set.\n     *\n     *     value (object or string):\n     *         The new value for the attribute.\n     *\n     * Returns:\n     *     Promise:\n     *     A promise which resolves when the operation is complete.\n     */\n    async _saveAttribute(attr, value) {\n        await this.resource.ready();\n        this.resource.set(attr, value);\n        await this.resource.save();\n    },\n\n    /**\n     * Guess the policy type for a given policy definition.\n     *\n     * This compares the policy against the built-in versions that\n     * RB.APIToken provides. If one of them matches, the appropriate\n     * policy type will be returned. Otherwise, this assumes it's a\n     * custom policy.\n     *\n     * Args:\n     *     policy (object):\n     *         A policy object.\n     *\n     * Returns:\n     *     string:\n     *     The policy type enumeration corresponding to the policy.\n     */\n    _guessPolicyType(policy) {\n        if (_.isEqual(policy, RB.APIToken.defaultPolicies.readOnly)) {\n            return POLICY_READ_ONLY;\n        } else if (_.isEqual(policy, RB.APIToken.defaultPolicies.readWrite)) {\n            return POLICY_READ_WRITE;\n        } else {\n            return POLICY_CUSTOM;\n        }\n    },\n\n    /**\n     * Create and return an action for the policy menu.\n     *\n     * This takes a policy type and any options to include with the\n     * action definition. It will then return a suitable action,\n     * for display in the policy menu.\n     *\n     * Args:\n     *     policyType (string):\n     *         The policy type to create.\n     *\n     *     options (object):\n     *         Additional options to include in the new action definition.\n     */\n    _makePolicyAction(policyType, options) {\n        return _.defaults({\n            label: POLICY_LABELS[policyType],\n            type: 'radio',\n            name: 'policy-type',\n            propName: 'policyType',\n            radioValue: policyType\n        }, options);\n    },\n\n    /**\n     * Handler for when the policy type changes.\n     *\n     * This will set the policy menu's label to that of the selected\n     * policy and rebuild the menu.\n     *\n     * Then, if not using a custom policy, the built-in policy definition\n     * matching the selected policy will be saved to the server.\n     */\n    _onPolicyTypeChanged() {\n        const policyType = this.get('policyType');\n\n        this._policyMenuAction.label = POLICY_LABELS[policyType];\n        this.trigger('actionsChanged');\n\n        let newPolicy = null;\n\n        if (policyType === POLICY_READ_ONLY) {\n            newPolicy = RB.APIToken.defaultPolicies.readOnly;\n        } else if (policyType === POLICY_READ_WRITE) {\n            newPolicy = RB.APIToken.defaultPolicies.readWrite;\n        } else {\n            return;\n        }\n\n        console.assert(newPolicy !== null);\n\n        if (!_.isEqual(newPolicy, this.get('policy'))) {\n            this.savePolicy(newPolicy);\n        }\n    }\n});\n\n\n/**\n * A collection of APITokenItems.\n *\n * This works like a standard Backbone.Collection, but can also have\n * a LocalSite URL prefix attached to it, for use in API calls in\n * APITokenItem.\n */\nconst APITokenItemCollection = Backbone.Collection.extend({\n    model: APITokenItem,\n\n    /**\n     * Initialize the collection.\n     *\n     * Args:\n     *     models (Array of object):\n     *         Initial models for the collection.\n     *\n     *     options (object):\n     *         Additional options for the collection.\n     *\n     * Option Args:\n     *     localSitePrefix (string):\n     *         The URL prefix for the current local site, if any.\n     */\n    initialize(models, options) {\n        this.localSitePrefix = options.localSitePrefix;\n    }\n});\n\n\n/**\n * Provides an editor for constructing or modifying a custom policy definition.\n *\n * This renders as a modalBox with a CodeMirror editor inside of it. The\n * editor is set to allow easy editing of a JSON payload, complete with\n * lintian checking. Only valid policy payloads can be saved to the server.\n */\nconst PolicyEditorView = Backbone.View.extend({\n    id: 'custom_policy_editor',\n\n    template: _.template([\n        '<p><%= instructions %></p>',\n        '<textarea></textarea>'\n    ].join('')),\n\n    /**\n     * Initialize the editor.\n     *\n     * Args:\n     *     options (object):\n     *         Additional options for view construction.\n     *\n     * Option Args:\n     *     prevPolicyType (string):\n     *         The previous policy type, to use when restoring the value after\n     *         the edit has been cancelled.\n     */\n    initialize(options) {\n        this.prevPolicyType = options.prevPolicyType;\n\n        this._codeMirror = null;\n        this._$policy = null;\n        this._$saveButtons = null;\n    },\n\n    /**\n     * Render the editor.\n     *\n     * The CodeMirror editor will be set up and configured, and then the\n     * view will be placed inside a modalBox.\n     *\n     * Returns:\n     *     PolicyEditorView:\n     *     This object, for chaining.\n     */\n    render() {\n        let policy = this.model.get('policy');\n\n        if (_.isEmpty(policy)) {\n            policy = RB.APIToken.defaultPolicies.custom;\n        }\n\n        this.$el.html(this.template({\n            instructions: interpolate(\n                gettext('You can limit access to the API through a custom policy. See the <a href=\"%s\" target=\"_blank\">documentation</a> on how to write policies.'),\n                [MANUAL_URL + 'webapi/2.0/api-token-policy/'])\n        }));\n\n\n        this._$policy = this.$('textarea')\n            .val(JSON.stringify(policy, null, '  '));\n\n        this.$el.modalBox({\n            title: gettext('Custom Token Access Policy'),\n            buttons: [\n                Ink.paintComponent(\n                    'Ink.Button',\n                    {\n                        onClick: () => this.cancel(),\n                    },\n                    _`Cancel`,\n                ),\n                Ink.paintComponent(\n                    'Ink.Button',\n                    {\n                        class: 'save-button',\n                        onClick: () => this.save(false),\n                    },\n                    _`Save and continue editing`,\n                ),\n                Ink.paintComponent(\n                    'Ink.Button',\n                    {\n                        class: 'save-button',\n                        onClick: () => this.save(true),\n                        type: 'primary',\n                    },\n                    _`Save`,\n                ),\n            ]\n        });\n\n        this._$saveButtons = this.$el.modalBox('buttons').find('.save-button');\n\n        this._codeMirror = CodeMirror.fromTextArea(this._$policy[0], {\n            mode: {\n                highlightFormatting: true,\n                name: 'application/json',\n            },\n            lineNumbers: true,\n            lineWrapping: true,\n            matchBrackets: true,\n            lint: {\n                onUpdateLinting: _.bind(this._onUpdateLinting, this)\n            },\n            gutters: ['CodeMirror-lint-markers'],\n            styleSelectedText: true,\n            theme: 'rb default',\n        });\n        this._codeMirror.focus();\n    },\n\n    /**\n     * Remove the policy editor from the page.\n     */\n    remove() {\n        this.$el.modalBox('destroy');\n    },\n\n    /**\n     * Cancel the editor.\n     *\n     * The previously-selected policy type will be set on the model.\n     */\n    cancel() {\n        this.model.set('policyType', this.prevPolicyType);\n        this.remove();\n    },\n\n    /**\n     * Save the editor.\n     *\n     * The policy will be saved to the server for immediate use.\n     *\n     * Args:\n     *     closeOnSave (boolean):\n     *         Whether the editor should close after saving.\n     */\n    async save(closeOnSave) {\n        const policyStr = this._codeMirror.getValue().trim();\n        let policy;\n\n        try {\n            policy = JSON.parse(policyStr);\n        } catch (e) {\n            if (e instanceof SyntaxError) {\n                alert(interpolate(\n                    gettext('There is a syntax error in your policy: %s'),\n                    [e]));\n\n                return;\n            } else {\n                throw e;\n            }\n        }\n\n        try {\n            await this.model.savePolicy(policy);\n\n            this.model.set('policyType', POLICY_CUSTOM);\n\n            if (closeOnSave) {\n                this.remove();\n            }\n        } catch (err) {\n            if (err.xhr.errorPayload.err.code === 105 &&\n                err.xhr.errorPayload.fields.policy) {\n                alert(err.xhr.errorPayload.fields.policy);\n            } else {\n                alert(err.xhr.errorPayload.err.msg);\n            }\n        }\n    },\n\n    /**\n     * Handler for when lintian checking has run.\n     *\n     * This will disable the save buttons if there are any lintian errors.\n     *\n     * Args:\n     *     annotationsNotSorted (Array):\n     *         An array of the linter annotations.\n     */\n    _onUpdateLinting(annotationsNotSorted) {\n        this._$saveButtons.prop('disabled', annotationsNotSorted.length > 0);\n    }\n});\n\n\n/**\n * Renders an APITokenItem to the page, and handles actions.\n *\n * This will display the information on the given token. Specifically,\n * the token value, the note, the expiration date and the actions.\n *\n * This also handles deleting the token when the Remove action is clicked,\n * and displaying the policy editor when choosing a custom policy.\n */\nconst APITokenItemView = Djblets.Config.ListItemView.extend({\n    EMPTY_NOTE_PLACEHOLDER: gettext('Click to describe this token'),\n\n    template: _.template(gettext`\n        <div class=\"rb-c-config-api-tokens__main\">\n         <div class=\"rb-c-config-api-tokens__value\">\n          <input readonly=\"readonly\" value=\"<%- tokenValue %>\">\n         </div>\n         <span class=\"fa fa-clipboard js-copy-token\" title=\"Copy to clipboard\"></span>\n        </div>\n        <div class=\"rb-c-config-api-tokens__info\">\n         <% if (deprecated) { %>\n          <p class=\"rb-c-config-api-tokens__deprecation-notice\">\n           This token uses a deprecated format. You should remove it and\n           generate a new one.\n          </p>\n         <% } %>\n         <% if (valid) { %>\n          <% if (lastUsed) { %>\n           <p class=\"rb-c-config-api-tokens__usage -has-last-used\">\n            Last used\n            <time class=\"timesince\" datetime=\"<%= lastUsed %>\"></time>.\n           </p>\n          <% } else { %>\n           <p class=\"rb-c-config-api-tokens__usage\">Never used.</p>\n          <% } %>\n          <% if (expired) { %>\n           <p class=\"rb-c-config-api-tokens__token-state -is-expired\">\n            <span>Expired <%= expiresTimeHTML %>.</span>\n           </p>\n          <% } else if (expires) { %>\n           <p class=\"rb-c-config-api-tokens__token-state -has-expires\">\n            <span>Expires <%= expiresTimeHTML %>.</span>\n           </p>\n          <% } else { %>\n           <p class=\"rb-c-config-api-tokens__token-state\">\n            <span>Never expires.</span>\n           </p>\n          <% } %>\n         <% } else { %>\n          <p class=\"rb-c-config-api-tokens__token-state -is-invalid\">\n           Invalidated\n           <time class=\"timesince\" datetime=\"<%= invalidDate %>\"></time>:\n           <%= invalidReason %>\n          </p>\n         <% } %>\n        </div>\n        <div class=\"rb-c-config-api-tokens__actions\"></div>\n        <span class=\"rb-c-config-api-tokens__note\"></span>\n    `),\n\n    events: {\n        'click .js-copy-token': '_onCopyClicked',\n    },\n\n    actionHandlers: {\n        'delete': '_onRemoveClicked',\n        'policy-custom': '_onCustomPolicyClicked'\n    },\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        _super(this).initialize.apply(this, arguments);\n\n        this._$expires = null;\n        this._$note = null;\n        this._$tokenState = null;\n\n        this.listenTo(this.model.resource, 'change:expires', this._updateExpires);\n        this.listenTo(this.model.resource, 'change:note', this._updateNote);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     APITokenItemView:\n     *     This object, for chaining.\n     */\n    render() {\n        _super(this).render.call(this);\n\n        this._$tokenState = this.$('.rb-c-config-api-tokens__token-state');\n        this._$expires = this._$tokenState\n            .not('.is-invalid')\n            .find('span');\n\n        this._$note = this.$('.rb-c-config-api-tokens__note');\n        const noteEditor = new RB.InlineEditorView({\n            editIconClass: 'rb-icon rb-icon-edit',\n            el: this._$note,\n            hasShortButtons: true,\n        });\n        noteEditor.render();\n\n        this.listenTo(noteEditor, 'beginEdit', () => {\n            noteEditor.setValue(this.model.get('note'));\n        });\n        this.listenTo(noteEditor, 'complete',\n                      value => this.model.saveNote(value));\n\n        const expires = moment(this.model.get('expires'))\n            .local()\n            .format('YYYY-MM-DDTHH:mm');\n\n        const expiresView = new RB.DateTimeInlineEditorView({\n            descriptorText: 'Expires ',\n            el: this._$expires[0],\n            formatResult: value => {\n                if (value) {\n                    value = moment(value).local().format();\n                    const today = moment().local();\n                    const expired = today.isAfter(value);\n                    const prefix = expired ? 'Expired' : 'Expires';\n\n                    if (expired) {\n                        this._$tokenState.addClass('-is-expired');\n                    }\n\n                    return (dedent`\n                        ${prefix}\n                        <time class=\"timesince\" datetime=\"${value}\"></time>.\n                    `);\n                } else {\n                    this._$tokenState.removeClass('-is-expired');\n\n                    return 'Never expires.';\n                }\n            },\n            hasShortButtons: true,\n            rawValue: expires,\n        })\n        .on({\n            beginEdit: () => this._$tokenState.removeClass('-is-expired'),\n            cancel: () => {\n                if (this.model.get('expired')) {\n                    this._$tokenState.addClass('-is-expired');\n                }\n            }\n        });\n        expiresView.render();\n\n        this.listenTo(expiresView, 'complete', (value) => {\n            value = value ? moment(value).local().format() : '';\n            this.model.saveExpires(value);\n        });\n\n        this._updateExpires();\n        this._updateNote();\n\n        return this;\n    },\n\n    /**\n     * Return the parent element for item actions.\n     *\n     * Returns:\n     *     jQuery:\n     *     The element to attach the actions to.\n     */\n    getActionsParent() {\n        return this.$('.rb-c-config-api-tokens__actions');\n    },\n\n    /**\n     * Return additional rendering context.\n     *\n     * Returns:\n     *     object:\n     *     Additional rendering context.\n     */\n    getRenderContext() {\n        const expires = this.model.get('expires');\n\n        return {\n            expiresTimeHTML:\n                `<time class=\"timesince\" datetime=\"${expires}\"></time>`,\n        };\n    },\n\n    /**\n     * Update the displayed expiration date.\n     */\n     _updateExpires() {\n        if (this._$expires) {\n            const expires = this.model.resource.get('expires');\n\n            this._$expires.find('time').attr('datetime', expires);\n            this.$('.timesince').timesince();\n        }\n    },\n\n    /**\n     * Update the displayed note.\n     *\n     * If no note is set, then a placeholder will be shown, informing the\n     * user that they can edit the note. Otherwise, their note contents\n     * will be shown.\n     */\n    _updateNote() {\n        if (this._$note) {\n            const note = this.model.resource.get('note');\n\n            this._$note\n                .toggleClass('empty', !note)\n                .text(note ? note : this.EMPTY_NOTE_PLACEHOLDER);\n        }\n    },\n\n    /**\n     * Handler for when the copy icon is clicked.\n     *\n     * Args:\n     *     e (Event):\n     *         The click event.\n     */\n    _onCopyClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this.$('.rb-c-config-api-tokens__value input')\n            .focus()\n            .select();\n        document.execCommand('copy');\n    },\n\n    /**\n     * Handler for when the \"Custom\" policy action is clicked.\n     *\n     * This displays the policy editor, allowing the user to edit a\n     * custom policy for the token.\n     *\n     * The previously selected policy type is passed along to the editor,\n     * so that the editor can revert to it if the user cancels.\n     *\n     * Returns:\n     *     boolean:\n     *     false, for use as a jQuery event handler.\n     */\n    _onCustomPolicyClicked() {\n        const view = new PolicyEditorView({\n            model: this.model,\n            prevPolicyType: this.model.get('policyType'),\n        });\n        view.render();\n\n        return false;\n    },\n\n    /**\n     * Handler for when the Remove action is clicked.\n     *\n     * This will prompt for confirmation before removing the token from\n     * the server.\n     */\n    _onRemoveClicked() {\n        $('<p>')\n            .html(gettext('This will prevent clients using this token when authenticating.'))\n            .modalBox({\n                title: gettext('Are you sure you want to remove this token?'),\n                buttons: [\n                    $('<input type=\"button\">')\n                        .val(gettext('Cancel')),\n                    $('<input type=\"button\" class=\"danger\">')\n                        .val(gettext('Remove'))\n                        .click(() => this.model.resource.destroy())\n                ]\n            });\n    }\n});\n\n\n/**\n * Renders and manages a list of global or per-LocalSite API tokens.\n *\n * This will display all provided API tokens in a list, optionally labeled\n * by Local Site name. These can be removed or edited, or new tokens generated\n * through a \"Generate a new API token\" link.\n */\nconst SiteAPITokensView = Backbone.View.extend({\n    className: 'rb-c-config-api-tokens',\n\n    template: _.template(dedent`\n        <% if (name) { %>\n         <div class=\"djblets-l-config-forms-container\">\n          <h3><%- name %></h3>\n         </div>\n        <% } %>\n        <div class=\"api-tokens\">\n        </div>\n    `),\n\n    generateTokenTemplate: _.template(dedent`\n        <li class=\"generate-api-token djblets-c-config-forms-list__item\">\n         <a href=\"#\"><%- generateText %></a>\n        </li>\n    `),\n\n    events: {\n        'click .generate-api-token': '_onGenerateClicked'\n    },\n\n    /**\n     * Initialize the view.\n     *\n     * This will construct the collection of tokens and construct\n     * a list for the ListView.\n     *\n     * Args:\n     *     options (object):\n     *         Options for view construction.\n     *\n     * Option Args:\n     *     localSiteName (string):\n     *         The name of the local site, if any.\n     *\n     *     localSitePrefix (string):\n     *         The URL prefix of the local site, if any.\n     */\n    initialize(options) {\n        this.localSiteName = options.localSiteName;\n        this.localSitePrefix = options.localSitePrefix;\n\n        this.collection = new APITokenItemCollection(options.apiTokens, {\n            localSitePrefix: this.localSitePrefix\n        });\n\n        this.apiTokensList = new Djblets.Config.List({}, {\n            collection: this.collection\n        });\n\n        this._listView = null;\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will render the list of API token items, along with a link\n     * for generating new tokens.\n     *\n     * Returns:\n     *     SiteAPITokensView:\n     *     This object, for chaining.\n     */\n    render() {\n        this._listView = new Djblets.Config.ListView({\n            ItemView: APITokenItemView,\n            animateItems: true,\n            model: this.apiTokensList\n        });\n\n        this.$el.html(this.template({\n            name: this.localSiteName,\n        }));\n\n        this._listView.render().$el.prependTo(this.$('.api-tokens'));\n\n        this._$generateTokenItem =\n            $(this.generateTokenTemplate({\n                generateText: _`Generate a new API token`,\n            }))\n            .appendTo(this._listView.getBody());\n\n        return this;\n    },\n\n    /**\n     * Handler for when the \"Generate a new API token\" link is clicked.\n     *\n     * This creates a new API token on the server and displays it in the list.\n     *\n     * Args:\n     *     e (Event):\n     *         The event which triggered the action.\n     */\n    async _onGenerateClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        const apiToken = new RB.APIToken({\n            localSitePrefix: this.localSitePrefix,\n            userName: RB.UserSession.instance.get('username')\n        });\n\n        await apiToken.save();\n\n        this.collection.add({\n            resource: apiToken,\n        });\n\n        this._$generateTokenItem\n            .detach()\n            .appendTo(this._listView.getBody());\n    },\n});\n\n\n/**\n * Renders and manages a page of API tokens.\n *\n * This will take the provided tokens and group them into SiteAPITokensView\n * instances, one per Local Site and one for the global tokens.\n */\nRB.APITokensView = Backbone.View.extend({\n    template: _.template(dedent`\n        <div class=\"api-tokens-list djblets-l-config-forms-container\n                    -is-recessed -is-top-flush\">\n        </div>\n    `),\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for view construction.\n     *\n     * Option Args:\n     *     apiTokens (Array of object):\n     *         Initial contents of the tokens list.\n     */\n    initialize(options) {\n        this.apiTokens = options.apiTokens;\n\n        this._$listsContainer = null;\n        this._apiTokenViews = [];\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will set up the elements and the list of SiteAPITokensViews.\n     *\n     * Returns:\n     *     RB.APITokensView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el.html(this.template());\n\n        this._$listsContainer = this.$('.api-tokens-list');\n\n        for (let [localSiteName, info] of Object.entries(this.apiTokens)) {\n            const view = new SiteAPITokensView({\n                localSiteName: localSiteName,\n                localSitePrefix: info.localSitePrefix,\n                apiTokens: info.tokens\n            });\n\n            view.$el.appendTo(this._$listsContainer);\n            view.render();\n\n            this._apiTokenViews.push(view);\n        }\n\n        return this;\n    }\n});\n\n\n})();\n"],"mappings":"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","ignoreList":[]}