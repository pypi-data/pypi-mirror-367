{"version":3,"file":"menuButtonViewTests.js","names":["suite","describe","it","view","RB","MenuButtonView","ariaMenuLabel","menuItems","text","onPrimaryButtonClick","render","expect","el","toHaveClass","$el","attr","toBe","$primaryButton","length","$","$toggleButton","id","menu","children","toBeNull","toBeUndefined","trim","sendDropDownButtonEvent","name","options","evt","Event","trigger","sendKeyDown","keyCode","key","beforeEach","spyOn","openMenuTests","openDirection","isOpen","toBeTrue","focusLastItem","toHaveBeenCalled","focusFirstItem","open","animate","toBeFalse","relatedTarget","$testsScratch","isPropagationStopped"],"sources":["../../../../../../../static/rb/js/ui/views/tests/menuButtonViewTests.es6.js"],"sourcesContent":["suite('rb/ui/views/MenuButtonView', function() {\n    describe('Rendering', function() {\n        it('With primary button', function() {\n            const view = new RB.MenuButtonView({\n                ariaMenuLabel: 'Test ARIA label',\n                menuItems: [\n                    {text: 'Item 1'},\n                    {text: 'Item 2'},\n                    {text: 'Item 3'},\n                ],\n                onPrimaryButtonClick: () => {},\n                text: 'Button label',\n            });\n            view.render();\n\n            expect(view.el).toHaveClass('rb-c-menu-button');\n            expect(view.$el.attr('role')).toBe('group');\n            expect(view.$primaryButton.length).toBe(1);\n\n            const $primaryButton = view.$('.rb-c-menu-button__primary');\n            expect($primaryButton.length).toBe(1);\n\n            const $toggleButton = view.$('.rb-c-menu-button__toggle');\n            expect($toggleButton.length).toBe(1);\n            expect($toggleButton[0].id)\n                .toBe(view.menu.$el.attr('aria-labelledby'));\n            expect($toggleButton.attr('aria-label')).toBe('Test ARIA label');\n            expect($toggleButton.children()[0])\n                .toHaveClass('rb-icon-dropdown-arrow');\n\n            expect(view.menu.el.children.length).toBe(3);\n        });\n\n        it('Without primary button', function() {\n            const view = new RB.MenuButtonView({\n                ariaMenuLabel: 'Test ARIA label',\n                menuItems: [\n                    {text: 'Item 1'},\n                    {text: 'Item 2'},\n                ],\n                text: 'Button label',\n            });\n            view.render();\n\n            expect(view.el).toHaveClass('rb-c-menu-button');\n            expect(view.$el.attr('role')).toBe('group');\n            expect(view.$primaryButton).toBeNull();\n\n            const $primaryButton = view.$('.rb-c-menu-button__primary');\n            expect($primaryButton.length).toBe(0);\n\n            const $toggleButton = view.$('.rb-c-menu-button__toggle');\n            expect($toggleButton.length).toBe(1);\n            expect($toggleButton[0].id)\n                .toBe(view.menu.$el.attr('aria-labelledby'));\n            expect($toggleButton.attr('aria-label')).toBeUndefined();\n            expect($toggleButton.text().trim()).toBe('Button label');\n            expect($toggleButton.children()[0])\n                .toHaveClass('rb-icon-dropdown-arrow');\n\n            expect(view.menu.el.children.length).toBe(2);\n        });\n    });\n\n    describe('Events', function() {\n        let view;\n\n        function sendDropDownButtonEvent(name, options) {\n            const evt = $.Event(name, options);\n            view.$('.rb-c-menu-button__toggle').trigger(evt);\n\n            return evt;\n        }\n\n        function sendKeyDown(keyCode) {\n            sendDropDownButtonEvent('keydown', {\n                key: keyCode,\n            });\n        }\n\n        beforeEach(function() {\n            view = new RB.MenuButtonView({\n                text: 'Text',\n            });\n            view.render();\n\n            /* Don't let this override any state we set. */\n            spyOn(view, 'updateMenuPosition');\n        });\n\n        describe('keydown', function() {\n            function openMenuTests(keyCode) {\n                it('With openDirection=up', function() {\n                    view.openDirection = 'up';\n                    spyOn(view.menu, 'focusLastItem');\n\n                    sendKeyDown(keyCode);\n\n                    expect(view.menu.isOpen).toBeTrue();\n                    expect(view.menu.focusLastItem).toHaveBeenCalled();\n                });\n\n                it('With openDirection=down', function() {\n                    view.openDirection = 'down';\n                    spyOn(view.menu, 'focusFirstItem');\n\n                    sendKeyDown(keyCode);\n\n                    expect(view.menu.isOpen).toBeTrue();\n                    expect(view.menu.focusFirstItem).toHaveBeenCalled();\n                });\n            }\n\n            describe('Return key opens menu', function() {\n                openMenuTests('Enter');\n            });\n\n            describe('Space key opens menu', function() {\n                openMenuTests(' ');\n            });\n\n            describe('Down key opens menu', function() {\n                openMenuTests('ArrowDown');\n            });\n\n            describe('Up key opens menu', function() {\n                openMenuTests('ArrowUp');\n            });\n\n            it('Escape key closes menu', function() {\n                view.menu.open({\n                    animate: false,\n                });\n                expect(view.menu.isOpen).toBeTrue();\n\n                sendKeyDown('Escape');\n\n                expect(view.menu.isOpen).toBeFalse();\n            });\n        });\n\n        it('focusout closes menu', function() {\n            view.menu.open({\n                animate: false,\n            });\n\n            expect(view.menu.isOpen).toBeTrue();\n\n            sendDropDownButtonEvent('focusout', {\n                relatedTarget: $testsScratch[0],\n            });\n\n            expect(view.menu.isOpen).toBeFalse();\n        });\n\n        it('clicking the toggle stops event propagation', function() {\n            const evt = sendDropDownButtonEvent('click');\n            expect(evt.isPropagationStopped()).toBeTrue();\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}