{"version":3,"file":"draftReviewBannerViewTests.js","names":["suite","template","model","view","beforeEach","$banner","$","appendTo","$testsScratch","RB","DraftReview","DraftReviewBannerView","el","render","afterEach","remove","describe","$buttons","it","expect","prop","toBe","trigger","spyOn","ReviewDialogView","click","create","toHaveBeenCalled","calls","argsFor","review","publish","and","callThrough","_onPublishClicked","toHaveBeenCalledWith","publishAndArchive","fn","callFake","options","buttons","forEach","$btn","add","modalBox","cmd","filter","destroy","$el","hasClass","show","addClass","hide"],"sources":["../../../../../../static/rb/js/views/tests/draftReviewBannerViewTests.es6.js"],"sourcesContent":["suite('rb/views/DraftReviewBannerView', function() {\n    const template = dedent`\n        <div id=\"review-banner\" hidden class=\"hidden\">\n         <div class=\"banner\">\n          <h1>You have a pending review.</h1>\n          <input id=\"review-banner-edit\" type=\"button\"\n                 value=\"Edit Review\">\n          <div id=\"review-banner-publish-container\"></div>\n          <input id=\"review-banner-discard\" type=\"button\"\n                 value=\"Discard\">\n         </div>\n        </div>'\n    `;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        const $banner = $(template).appendTo($testsScratch);\n\n        model = new RB.DraftReview();\n        view = new RB.DraftReviewBannerView({\n            el: $banner,\n            model: model,\n        });\n\n        view.render();\n    });\n\n    afterEach(function() {\n        view.remove();\n    });\n\n    describe('Button states', function() {\n        let $buttons;\n\n        beforeEach(function() {\n            $buttons = view.$('input');\n        });\n\n        describe('Enabled', function() {\n            it('Default', function() {\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When saved', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('saved');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When destroyed', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('destroyed');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n        });\n\n        describe('Disabled', function() {\n            it('When saving', function() {\n                model.trigger('saving');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n\n            it('When destroying', function() {\n                model.trigger('destroying');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n        });\n    });\n\n    describe('Button events', function() {\n        it('Edit Review', function() {\n            spyOn(RB.ReviewDialogView, 'create');\n\n            view.$('#review-banner-edit').click();\n\n            expect(RB.ReviewDialogView.create).toHaveBeenCalled();\n            expect(RB.ReviewDialogView.create.calls.argsFor(0)[0].review)\n                .toBe(model);\n        });\n\n        it('Publish', function() {\n            spyOn(model, 'publish');\n\n            view.$('.rb-c-menu-button__primary').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish to Submitter Only', function() {\n            spyOn(model, 'publish');\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-submitter-only').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish and Archive', function() {\n            spyOn(model, 'publish');\n            spyOn(view, '_onPublishClicked').and.callThrough();\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-and-archive').click();\n\n            expect(model.publish).toHaveBeenCalled();\n            expect(view._onPublishClicked).toHaveBeenCalledWith({\n                publishAndArchive: true\n            });\n        });\n\n        it('Discard', function() {\n            let $buttons = $();\n\n            spyOn(model, 'destroy');\n            spyOn($.fn, 'modalBox').and.callFake(options => {\n                options.buttons.forEach($btn => {\n                    $buttons = $buttons.add($btn);\n                });\n\n                /* Simulate the modalBox API for what we need. */\n                return {\n                    modalBox: cmd => {\n                        expect(cmd).toBe('buttons');\n                        return $buttons;\n                    }\n                };\n            });\n\n            view.$('#review-banner-discard').click();\n            expect($.fn.modalBox).toHaveBeenCalled();\n\n            $buttons.filter('input[value=\"Discard\"]').click();\n            expect(model.destroy).toHaveBeenCalled();\n        });\n    });\n\n    describe('Methods', function() {\n        it('show', function() {\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n\n            view.show();\n            expect(view.$el.hasClass('hidden')).toBe(false);\n            expect(view.$el.prop('hidden')).toBe(false);\n        });\n\n        it('hide', function() {\n            view.$el\n                .addClass('hidden')\n                .prop('hidden', true);\n\n            view.hide();\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}