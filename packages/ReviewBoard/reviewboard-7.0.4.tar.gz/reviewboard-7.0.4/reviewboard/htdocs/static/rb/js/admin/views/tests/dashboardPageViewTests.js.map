{"version":3,"file":"dashboardPageViewTests.js","names":["suite","pageTemplate","widgetTemplate","_","template","page","pageView","beforeEach","spyOn","RB","HeaderView","prototype","Admin","DashboardPage","DashboardPageView","el","$","appendTo","$testsScratch","model","describe","it","$main","append","domID","name","cssClasses","set","id","viewClass","modelClass","render","$widgets","_$widgets","expect","length","toBe","toHaveClass","items","_masonry","element","$el","css","widgetView","_widgetViews","not","toBeUndefined","$widget","width","trigger","layout","toHaveBeenCalled","_widgetWidths"],"sources":["../../../../../../../static/rb/js/admin/views/tests/dashboardPageViewTests.es6.js"],"sourcesContent":["suite('rb/admin/views/DashboardPageView', function() {\n    const pageTemplate = dedent`\n        <div>\n         <div id=\"admin-dashboard\" style=\"visibility: hidden\">\n          <div class=\"rb-c-admin-widgets\">\n           <div class=\"rb-c-admin-widgets__sizer-gutter\"></div>\n           <div class=\"rb-c-admin-widgets__sizer-column\"></div>\n           <div class=\"rb-c-admin-widgets__main\"></div>\n          </div>\n         </div>\n        </div>\n    `;\n\n    const widgetTemplate = _.template(dedent`\n        <div class=\"rb-c-admin-widget <%- cssClasses %>\" id=\"<%- domID %>\"\n         <header class=\"rb-c-admin-widget__header\">\n          <h1><%- name %></h1>\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </header>\n         <div class=\"rb-c-admin-widget__content\"></div>\n         <footer class=\"rb-c-admin-widget__footer\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </footer>\n        </div>\n    `);\n\n    let page;\n    let pageView;\n\n    beforeEach(function() {\n        spyOn(RB.HeaderView.prototype, '_ensureSingleton');\n        page = new RB.Admin.DashboardPage();\n        pageView = new RB.Admin.DashboardPageView({\n            el: $(pageTemplate).appendTo($testsScratch),\n            model: page,\n        });\n    });\n\n    describe('Widgets', function() {\n        it('Loading', function() {\n            const $main = pageView.$('.rb-c-admin-widgets__main');\n\n            $main.append(\n                widgetTemplate({\n                    domID: 'widget-1',\n                    name: 'Widget 1',\n                    cssClasses: '-is-small',\n                }),\n                widgetTemplate({\n                    domID: 'widget-2',\n                    name: 'Widget 2',\n                    cssClasses: '',\n                }),\n                widgetTemplate({\n                    domID: 'widget-3',\n                    name: 'Widget 3',\n                    cssClasses: '-is-large',\n                }),\n                widgetTemplate({\n                    domID: 'widget-4',\n                    name: 'Widget 4',\n                    cssClasses: '-is-small',\n                }),\n                widgetTemplate({\n                    domID: 'widget-5',\n                    name: 'Widget 5',\n                    cssClasses: '',\n                }),\n                widgetTemplate({\n                    domID: 'widget-6',\n                    name: 'Widget 6',\n                    cssClasses: '-is-full-size',\n                })\n            );\n\n            page.set('widgetsData', [\n                {\n                    id: 'widget-1',\n                    domID: 'widget-1',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-2',\n                    domID: 'widget-2',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-3',\n                    domID: 'widget-3',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-4',\n                    domID: 'widget-4',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-5',\n                    domID: 'widget-5',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n                {\n                    id: 'widget-6',\n                    domID: 'widget-6',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                },\n            ]);\n\n            pageView.render();\n\n            const $widgets = pageView._$widgets;\n            expect($widgets.length).toBe(6);\n\n            expect($widgets[0].id).toBe('widget-1');\n            expect($widgets[1].id).toBe('widget-2');\n            expect($widgets[2].id).toBe('widget-3');\n            expect($widgets[3].id).toBe('widget-4');\n            expect($widgets[4].id).toBe('widget-5');\n            expect($widgets[5].id).toBe('widget-6');\n\n            expect($widgets[0]).toHaveClass('js-masonry-item');\n            expect($widgets[1]).toHaveClass('js-masonry-item');\n            expect($widgets[2]).toHaveClass('js-masonry-item');\n            expect($widgets[3]).toHaveClass('js-masonry-item');\n            expect($widgets[4]).toHaveClass('js-masonry-item');\n            expect($widgets[5]).toHaveClass('js-masonry-item');\n\n            const items = pageView._masonry.items;\n            expect(items.length).toBe(6);\n            expect(items[0].element).toBe($widgets[5]);\n            expect(items[1].element).toBe($widgets[2]);\n            expect(items[2].element).toBe($widgets[1]);\n            expect(items[3].element).toBe($widgets[4]);\n            expect(items[4].element).toBe($widgets[0]);\n            expect(items[5].element).toBe($widgets[3]);\n\n            expect(pageView.$el.css('visibility')).toBe('visible');\n        });\n\n        describe('sizeChanged event', function() {\n            let widgetView;\n\n            beforeEach(function() {\n                const $main = pageView.$('.rb-c-admin-widgets__main');\n\n                $main.append(widgetTemplate({\n                    domID: 'widget-1',\n                    name: 'Widget 1',\n                    cssClasses: '',\n                }));\n\n                page.set('widgetsData', [{\n                    id: 'widget-1',\n                    domID: 'widget-1',\n                    viewClass: 'RB.Admin.WidgetView',\n                    modelClass: 'RB.Admin.Widget',\n                }]);\n\n                pageView.render();\n\n                widgetView = pageView._widgetViews['widget-1'];\n                expect(widgetView).not.toBeUndefined();\n\n                spyOn(pageView._masonry, 'layout');\n            });\n\n            it('Causes re-layout on element size change', function () {\n                const $widget = widgetView.$el;\n\n                $widget.width($widget.width() + 100);\n                widgetView.trigger('sizeChanged');\n\n                expect(pageView._masonry.layout).toHaveBeenCalled();\n            });\n\n            it('Ignored when element size does not change', function () {\n                pageView._widgetWidths['widget-1'] = widgetView.$el.width();\n                widgetView.trigger('sizeChanged');\n\n                expect(pageView._masonry.layout).not.toHaveBeenCalled();\n            });\n        });\n    });\n});\n"],"mappings":";;AAAAA,KAAK,CAAC,kCAAkC,EAAE,YAAW;EACjD,MAAMC,YAAY,GAAS;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAEK;EAED,MAAMC,cAAc,GAAGC,CAAC,CAACC,QAAQ,CAAO;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAEK,CAAC;EAEF,IAAIC,IAAI;EACR,IAAIC,QAAQ;EAEZC,UAAU,CAAC,YAAW;IAClBC,KAAK,CAACC,EAAE,CAACC,UAAU,CAACC,SAAS,EAAE,kBAAkB,CAAC;IAClDN,IAAI,GAAG,IAAII,EAAE,CAACG,KAAK,CAACC,aAAa,CAAC,CAAC;IACnCP,QAAQ,GAAG,IAAIG,EAAE,CAACG,KAAK,CAACE,iBAAiB,CAAC;MACtCC,EAAE,EAAEC,CAAC,CAACf,YAAY,CAAC,CAACgB,QAAQ,CAACC,aAAa,CAAC;MAC3CC,KAAK,EAAEd;IACX,CAAC,CAAC;EACN,CAAC,CAAC;EAEFe,QAAQ,CAAC,SAAS,EAAE,YAAW;IAC3BC,EAAE,CAAC,SAAS,EAAE,YAAW;MACrB,MAAMC,KAAK,GAAGhB,QAAQ,CAACU,CAAC,CAAC,2BAA2B,CAAC;MAErDM,KAAK,CAACC,MAAM,CACRrB,cAAc,CAAC;QACXsB,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,UAAU;QAChBC,UAAU,EAAE;MAChB,CAAC,CAAC,EACFxB,cAAc,CAAC;QACXsB,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,UAAU;QAChBC,UAAU,EAAE;MAChB,CAAC,CAAC,EACFxB,cAAc,CAAC;QACXsB,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,UAAU;QAChBC,UAAU,EAAE;MAChB,CAAC,CAAC,EACFxB,cAAc,CAAC;QACXsB,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,UAAU;QAChBC,UAAU,EAAE;MAChB,CAAC,CAAC,EACFxB,cAAc,CAAC;QACXsB,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,UAAU;QAChBC,UAAU,EAAE;MAChB,CAAC,CAAC,EACFxB,cAAc,CAAC;QACXsB,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,UAAU;QAChBC,UAAU,EAAE;MAChB,CAAC,CACL,CAAC;MAEDrB,IAAI,CAACsB,GAAG,CAAC,aAAa,EAAE,CACpB;QACIC,EAAE,EAAE,UAAU;QACdJ,KAAK,EAAE,UAAU;QACjBK,SAAS,EAAE,qBAAqB;QAChCC,UAAU,EAAE;MAChB,CAAC,EACD;QACIF,EAAE,EAAE,UAAU;QACdJ,KAAK,EAAE,UAAU;QACjBK,SAAS,EAAE,qBAAqB;QAChCC,UAAU,EAAE;MAChB,CAAC,EACD;QACIF,EAAE,EAAE,UAAU;QACdJ,KAAK,EAAE,UAAU;QACjBK,SAAS,EAAE,qBAAqB;QAChCC,UAAU,EAAE;MAChB,CAAC,EACD;QACIF,EAAE,EAAE,UAAU;QACdJ,KAAK,EAAE,UAAU;QACjBK,SAAS,EAAE,qBAAqB;QAChCC,UAAU,EAAE;MAChB,CAAC,EACD;QACIF,EAAE,EAAE,UAAU;QACdJ,KAAK,EAAE,UAAU;QACjBK,SAAS,EAAE,qBAAqB;QAChCC,UAAU,EAAE;MAChB,CAAC,EACD;QACIF,EAAE,EAAE,UAAU;QACdJ,KAAK,EAAE,UAAU;QACjBK,SAAS,EAAE,qBAAqB;QAChCC,UAAU,EAAE;MAChB,CAAC,CACJ,CAAC;MAEFxB,QAAQ,CAACyB,MAAM,CAAC,CAAC;MAEjB,MAAMC,QAAQ,GAAG1B,QAAQ,CAAC2B,SAAS;MACnCC,MAAM,CAACF,QAAQ,CAACG,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC;MAE/BF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACJ,EAAE,CAAC,CAACQ,IAAI,CAAC,UAAU,CAAC;MACvCF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACJ,EAAE,CAAC,CAACQ,IAAI,CAAC,UAAU,CAAC;MACvCF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACJ,EAAE,CAAC,CAACQ,IAAI,CAAC,UAAU,CAAC;MACvCF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACJ,EAAE,CAAC,CAACQ,IAAI,CAAC,UAAU,CAAC;MACvCF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACJ,EAAE,CAAC,CAACQ,IAAI,CAAC,UAAU,CAAC;MACvCF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACJ,EAAE,CAAC,CAACQ,IAAI,CAAC,UAAU,CAAC;MAEvCF,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,CAAC,iBAAiB,CAAC;MAClDH,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,CAAC,iBAAiB,CAAC;MAClDH,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,CAAC,iBAAiB,CAAC;MAClDH,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,CAAC,iBAAiB,CAAC;MAClDH,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,CAAC,iBAAiB,CAAC;MAClDH,MAAM,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC,CAACK,WAAW,CAAC,iBAAiB,CAAC;MAElD,MAAMC,KAAK,GAAGhC,QAAQ,CAACiC,QAAQ,CAACD,KAAK;MACrCJ,MAAM,CAACI,KAAK,CAACH,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC;MAC5BF,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAACJ,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1CE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAACJ,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1CE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAACJ,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1CE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAACJ,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1CE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAACJ,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC1CE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,CAACJ,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC,CAAC;MAE1CE,MAAM,CAAC5B,QAAQ,CAACmC,GAAG,CAACC,GAAG,CAAC,YAAY,CAAC,CAAC,CAACN,IAAI,CAAC,SAAS,CAAC;IAC1D,CAAC,CAAC;IAEFhB,QAAQ,CAAC,mBAAmB,EAAE,YAAW;MACrC,IAAIuB,UAAU;MAEdpC,UAAU,CAAC,YAAW;QAClB,MAAMe,KAAK,GAAGhB,QAAQ,CAACU,CAAC,CAAC,2BAA2B,CAAC;QAErDM,KAAK,CAACC,MAAM,CAACrB,cAAc,CAAC;UACxBsB,KAAK,EAAE,UAAU;UACjBC,IAAI,EAAE,UAAU;UAChBC,UAAU,EAAE;QAChB,CAAC,CAAC,CAAC;QAEHrB,IAAI,CAACsB,GAAG,CAAC,aAAa,EAAE,CAAC;UACrBC,EAAE,EAAE,UAAU;UACdJ,KAAK,EAAE,UAAU;UACjBK,SAAS,EAAE,qBAAqB;UAChCC,UAAU,EAAE;QAChB,CAAC,CAAC,CAAC;QAEHxB,QAAQ,CAACyB,MAAM,CAAC,CAAC;QAEjBY,UAAU,GAAGrC,QAAQ,CAACsC,YAAY,CAAC,UAAU,CAAC;QAC9CV,MAAM,CAACS,UAAU,CAAC,CAACE,GAAG,CAACC,aAAa,CAAC,CAAC;QAEtCtC,KAAK,CAACF,QAAQ,CAACiC,QAAQ,EAAE,QAAQ,CAAC;MACtC,CAAC,CAAC;MAEFlB,EAAE,CAAC,yCAAyC,EAAE,YAAY;QACtD,MAAM0B,OAAO,GAAGJ,UAAU,CAACF,GAAG;QAE9BM,OAAO,CAACC,KAAK,CAACD,OAAO,CAACC,KAAK,CAAC,CAAC,GAAG,GAAG,CAAC;QACpCL,UAAU,CAACM,OAAO,CAAC,aAAa,CAAC;QAEjCf,MAAM,CAAC5B,QAAQ,CAACiC,QAAQ,CAACW,MAAM,CAAC,CAACC,gBAAgB,CAAC,CAAC;MACvD,CAAC,CAAC;MAEF9B,EAAE,CAAC,2CAA2C,EAAE,YAAY;QACxDf,QAAQ,CAAC8C,aAAa,CAAC,UAAU,CAAC,GAAGT,UAAU,CAACF,GAAG,CAACO,KAAK,CAAC,CAAC;QAC3DL,UAAU,CAACM,OAAO,CAAC,aAAa,CAAC;QAEjCf,MAAM,CAAC5B,QAAQ,CAACiC,QAAQ,CAACW,MAAM,CAAC,CAACL,GAAG,CAACM,gBAAgB,CAAC,CAAC;MAC3D,CAAC,CAAC;IACN,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}