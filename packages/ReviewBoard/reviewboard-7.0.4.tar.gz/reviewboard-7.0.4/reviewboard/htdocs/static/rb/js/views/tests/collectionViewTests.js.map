{"version":3,"file":"collectionViewTests.js","names":["suite","collection","view","TestModel","Backbone","Model","extend","defaults","_","data","TestCollection","Collection","model","TestModelView","View","className","render","$el","text","get","TestCollectionView","RB","CollectionView","itemViewType","beforeEach","describe","it","expect","children","length","toBe","add","$children","innerHTML","hasClass","$container","$","appendTo","$viewChildren","$containerChildren","eq","model1","model2","model3","remove","reset","self","spyOn","and","callThrough","comparator","sort","_addCollectionViews","toHaveBeenCalled","not"],"sources":["../../../../../../static/rb/js/views/tests/collectionViewTests.es6.js"],"sourcesContent":["suite('rb/views/CollectionView', function() {\n    let collection;\n    let view;\n\n    const TestModel = Backbone.Model.extend({\n        defaults: _.defaults({\n            data: '',\n        }),\n    });\n\n    const TestCollection = Backbone.Collection.extend({\n        model: TestModel,\n    });\n\n    const TestModelView = Backbone.View.extend({\n        className: 'test-class',\n        render() {\n            this.$el.text(this.model.get('data'));\n            return this;\n        },\n    });\n\n    const TestCollectionView = RB.CollectionView.extend({\n        itemViewType: TestModelView,\n    });\n\n    beforeEach(function() {\n        collection = new TestCollection();\n        view = new TestCollectionView({\n            collection: collection,\n        });\n    });\n\n    describe('Rendering', function() {\n        it('When empty', function() {\n            view.render();\n            expect(view.$el.children().length).toBe(0);\n        });\n\n        it('With items', function() {\n            collection.add([\n                { data: 'Item 1' },\n                { data: 'Item 2' },\n            ]);\n\n            view.render();\n            const $children = view.$el.children();\n            expect($children.length).toBe(2);\n            expect($children[0].innerHTML).toBe('Item 1');\n            expect($children[1].innerHTML).toBe('Item 2');\n        });\n\n        it('Item model type', function() {\n            collection.add([\n                { data: 'Item 1' },\n            ]);\n\n            view.render();\n            expect(view.$el.children().hasClass('test-class')).toBe(true);\n        });\n\n        it('With custom element container', function() {\n            const $container = $('<div class=\"rb-test-main-container\">')\n                .appendTo(view.$el);\n\n            view.$container = $container;\n\n            collection.add([\n                { data: 'Item 1' },\n                { data: 'Item 2' },\n            ]);\n\n            view.render();\n\n            const $viewChildren = view.$el.children();\n            expect($viewChildren.length).toBe(1);\n            expect($viewChildren[0].className).toBe('rb-test-main-container');\n\n            const $containerChildren = $viewChildren.eq(0).children();\n            expect($containerChildren.length).toBe(2);\n            expect($containerChildren[0].innerHTML).toBe('Item 1');\n            expect($containerChildren[1].innerHTML).toBe('Item 2');\n        });\n    });\n\n    describe('Live updating', function() {\n        it('Adding items after rendering', function() {\n            collection.add([\n                { data: 'Item 1' },\n            ]);\n\n            view.render();\n\n            expect(view.$el.children().length).toBe(1);\n\n            collection.add([\n                { data: 'Item 2' },\n                { data: 'Item 3' },\n            ]);\n\n            const $children = view.$el.children();\n            expect($children.length).toBe(3);\n            expect($children[2].innerHTML).toBe('Item 3');\n        });\n\n        it('Removing items after rendering', function() {\n            const model1 = new TestModel({ data: 'Item 1' });\n            const model2 = new TestModel({ data: 'Item 2' });\n            const model3 = new TestModel({ data: 'Item 3' });\n            collection.add([model1, model2, model3]);\n\n            view.render();\n\n            expect(view.$el.children().length).toBe(3);\n\n            collection.remove([model1, model3]);\n\n            const $children = view.$el.children();\n            expect($children.length).toBe(1);\n            expect($children[0].innerHTML).toBe('Item 2');\n        });\n\n        it('When reset', function() {\n            collection.add([\n                { data: 'Item 1' },\n                { data: 'Item 2' },\n            ]);\n\n            view.render();\n\n            let $children = view.$el.children();\n            expect($children.length).toBe(2);\n            expect($children[0].innerHTML).toBe('Item 1');\n            expect($children[1].innerHTML).toBe('Item 2');\n\n            collection.reset([\n                { data: 'Item 3' },\n                { data: 'Item 4' },\n                { data: 'Item 5' },\n            ]);\n\n            $children = view.$el.children();\n            expect($children.length).toBe(3);\n            expect($children[0].innerHTML).toBe('Item 3');\n            expect($children[1].innerHTML).toBe('Item 4');\n            expect($children[2].innerHTML).toBe('Item 5');\n        });\n\n        describe('Sorting', function() {\n            it('With order changed', function() {\n                collection.add([\n                    { data: 'Item 2' },\n                    { data: 'Item 3' },\n                    { data: 'Item 1' },\n                ]);\n\n                view.render();\n\n                let $children = view.$el.children();\n                expect($children.length).toBe(3);\n                expect($children[0].innerHTML).toBe('Item 2');\n                expect($children[1].innerHTML).toBe('Item 3');\n                expect($children[2].innerHTML).toBe('Item 1');\n\n                self.spyOn(view, '_addCollectionViews').and.callThrough();\n\n                collection.comparator = 'data';\n                collection.sort();\n\n                $children = view.$el.children();\n                expect($children[0].innerHTML).toBe('Item 1');\n                expect($children[1].innerHTML).toBe('Item 2');\n                expect($children[2].innerHTML).toBe('Item 3');\n\n                expect(view._addCollectionViews).toHaveBeenCalled();\n            });\n\n            it('With order unchanged', function() {\n                collection.add([\n                    { data: 'Item 1' },\n                    { data: 'Item 2' },\n                    { data: 'Item 3' },\n                ]);\n\n                view.render();\n\n                let $children = view.$el.children();\n                expect($children.length).toBe(3);\n                expect($children[0].innerHTML).toBe('Item 1');\n                expect($children[1].innerHTML).toBe('Item 2');\n                expect($children[2].innerHTML).toBe('Item 3');\n\n                collection.comparator = 'data';\n                collection.sort();\n\n                self.spyOn(view, '_addCollectionViews').and.callThrough();\n\n                $children = view.$el.children();\n                expect($children[0].innerHTML).toBe('Item 1');\n                expect($children[1].innerHTML).toBe('Item 2');\n                expect($children[2].innerHTML).toBe('Item 3');\n\n                expect(view._addCollectionViews).not.toHaveBeenCalled();\n            });\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}