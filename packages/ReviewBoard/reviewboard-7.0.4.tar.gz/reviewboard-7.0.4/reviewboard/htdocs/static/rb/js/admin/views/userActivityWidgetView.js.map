{"version":3,"file":"userActivityWidgetView.js","names":["RB","Admin","UserActivityWidgetView","WidgetView","extend","template","_","renderWidget","$content","html","totalUsers","model","get","userTotalLabel","gettext","_$chart","$","_plotData","updateSize","now","sevenDays","thirtyDays","sixtyDays","ninetyDays","plot","data","label","interpolate","series","pie","show","radius","background","opacity","formatter","Math","round","percent","trigger"],"sources":["../../../../../../static/rb/js/admin/views/userActivityWidgetView.es6.js"],"sourcesContent":["/**\n * Displays stats on how often users have logged in or used Review Board.\n *\n * This is displayed as a pie graph, with a legend alongside it breaking\n * down the activity into 1-6 day, 7-29 day, 30-59 day, 60-89 day, and 90+\n * day ranges.\n */\nRB.Admin.UserActivityWidgetView = RB.Admin.WidgetView.extend({\n    template: _.template(dedent`\n        <div class=\"rb-c-admin-user-activity-widget__chart\"></div>\n        <div class=\"rb-c-admin-user-activity-widget__user-total\">\n         <%- userTotalLabel %>: <strong><%- totalUsers %></strong>\n        </div>\n    `),\n\n    /**\n     * Render the widget.\n     *\n     * This will build the basic structure of the widget's content and\n     * then plot the chart.\n     */\n    renderWidget() {\n        this.$content.html(this.template({\n            totalUsers: this.model.get('total'),\n            userTotalLabel: gettext('Total Users'),\n        }));\n\n        this._$chart = this.$('.rb-c-admin-user-activity-widget__chart');\n\n        this._plotData();\n    },\n\n    /**\n     * Handle updates to the size of the widget.\n     *\n     * This will re-render the chart for the new size.\n     */\n    updateSize() {\n        this._plotData();\n    },\n\n    /**\n     * Plot user activity into a chart.\n     */\n    _plotData() {\n        const model = this.model;\n        const now = model.get('now');\n        const sevenDays = model.get('sevenDays');\n        const thirtyDays = model.get('thirtyDays');\n        const sixtyDays = model.get('sixtyDays');\n        const ninetyDays = model.get('ninetyDays');\n\n        $.plot(\n            this._$chart,\n            [\n                {\n                    data: now,\n                    label: interpolate(gettext('Active (%s)'),\n                                       [now]),\n                },\n                {\n                    data: sevenDays,\n                    label: interpolate(gettext('7 days ago (%s)'),\n                                       [sevenDays]),\n                },\n                {\n                    data: thirtyDays,\n                    label: interpolate(gettext('30 days ago (%s)'),\n                                       [thirtyDays]),\n                },\n                {\n                    data: sixtyDays,\n                    label: interpolate(gettext('60 days ago (%s)'),\n                                       [sixtyDays]),\n                },\n                {\n                    data: ninetyDays,\n                    label: interpolate(gettext('90 days ago (%s)'),\n                                       [ninetyDays]),\n                },\n            ],\n            {\n                series: {\n                    pie: {\n                        show: true,\n                        label: {\n                            show: true,\n                            radius: 1,\n                            background: {\n                                opacity: 0.8,\n                            },\n                            formatter: (label, series) =>\n                                `<div>${Math.round(series.percent)}%</div>`,\n                        },\n                    },\n                },\n            }\n        );\n\n        this.trigger('sizeChanged');\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,KAAK,CAACC,sBAAsB,GAAGF,EAAE,CAACC,KAAK,CAACE,UAAU,CAACC,MAAM,CAAC;EACzDC,QAAQ,EAAEC,CAAC,CAACD,QAAQ,CAAO;AAC/B;AACA;AACA,OAEK,CAAC;EAEF;AACJ;AACA;AACA;AACA;AACA;EACIE,YAAYA,CAAA,EAAG;IACX,IAAI,CAACC,QAAQ,CAACC,IAAI,CAAC,IAAI,CAACJ,QAAQ,CAAC;MAC7BK,UAAU,EAAE,IAAI,CAACC,KAAK,CAACC,GAAG,CAAC,OAAO,CAAC;MACnCC,cAAc,EAAAC,OAAA;IAClB,CAAC,CAAC,CAAC;IAEH,IAAI,CAACC,OAAO,GAAG,IAAI,CAACC,CAAC,CAAC,yCAAyC,CAAC;IAEhE,IAAI,CAACC,SAAS,CAAC,CAAC;EACpB,CAAC;EAED;AACJ;AACA;AACA;AACA;EACIC,UAAUA,CAAA,EAAG;IACT,IAAI,CAACD,SAAS,CAAC,CAAC;EACpB,CAAC;EAED;AACJ;AACA;EACIA,SAASA,CAAA,EAAG;IACR,MAAMN,KAAK,GAAG,IAAI,CAACA,KAAK;IACxB,MAAMQ,GAAG,GAAGR,KAAK,CAACC,GAAG,CAAC,KAAK,CAAC;IAC5B,MAAMQ,SAAS,GAAGT,KAAK,CAACC,GAAG,CAAC,WAAW,CAAC;IACxC,MAAMS,UAAU,GAAGV,KAAK,CAACC,GAAG,CAAC,YAAY,CAAC;IAC1C,MAAMU,SAAS,GAAGX,KAAK,CAACC,GAAG,CAAC,WAAW,CAAC;IACxC,MAAMW,UAAU,GAAGZ,KAAK,CAACC,GAAG,CAAC,YAAY,CAAC;IAE1CI,CAAC,CAACQ,IAAI,CACF,IAAI,CAACT,OAAO,EACZ,CACI;MACIU,IAAI,EAAEN,GAAG;MACTO,KAAK,EAAEC,WAAW,CAAAb,OAAA,iBACC,CAACK,GAAG,CAAC;IAC5B,CAAC,EACD;MACIM,IAAI,EAAEL,SAAS;MACfM,KAAK,EAAEC,WAAW,CAAAb,OAAA,qBACC,CAACM,SAAS,CAAC;IAClC,CAAC,EACD;MACIK,IAAI,EAAEJ,UAAU;MAChBK,KAAK,EAAEC,WAAW,CAAAb,OAAA,sBACC,CAACO,UAAU,CAAC;IACnC,CAAC,EACD;MACII,IAAI,EAAEH,SAAS;MACfI,KAAK,EAAEC,WAAW,CAAAb,OAAA,sBACC,CAACQ,SAAS,CAAC;IAClC,CAAC,EACD;MACIG,IAAI,EAAEF,UAAU;MAChBG,KAAK,EAAEC,WAAW,CAAAb,OAAA,sBACC,CAACS,UAAU,CAAC;IACnC,CAAC,CACJ,EACD;MACIK,MAAM,EAAE;QACJC,GAAG,EAAE;UACDC,IAAI,EAAE,IAAI;UACVJ,KAAK,EAAE;YACHI,IAAI,EAAE,IAAI;YACVC,MAAM,EAAE,CAAC;YACTC,UAAU,EAAE;cACRC,OAAO,EAAE;YACb,CAAC;YACDC,SAAS,EAAEA,CAACR,KAAK,EAAEE,MAAM,KACrB,QAAQO,IAAI,CAACC,KAAK,CAACR,MAAM,CAACS,OAAO,CAAC;UAC1C;QACJ;MACJ;IACJ,CACJ,CAAC;IAED,IAAI,CAACC,OAAO,CAAC,aAAa,CAAC;EAC/B;AACJ,CAAC,CAAC","ignoreList":[]}