{"version":3,"file":"underscoreUtils.js","names":["_","bindCallbacks","callbacks","context","methodNames","wrappedCallbacks","key","value","Object","entries","includes","isFunction","bind","defaults","deferred","func","defer","throttleLayout","layoutFunc","options","handlingLayout","args","arguments","cb","apply","requestAnimationFrame","window","_super","obj","hasOwnProperty","__super__","prototype","getPrototypeOf"],"sources":["../../../../../static/rb/js/utils/underscoreUtils.es6.js"],"sourcesContent":["/**\n * Bind callbacks to a context.\n *\n * Backbone.js's various ajax-related functions don't take a context\n * with their callbacks. This allows us to wrap these callbacks to ensure\n * we always have a desired context.\n *\n * Args:\n *     callbacks (object):\n *         An object which potentially includes callback functions.\n *\n *     context (any type):\n *         The context to bind to the callbacks.\n *\n *     methodNames (Array of string):\n *         An array of method names within ``callbacks`` to bind.\n *\n * Returns:\n *     object:\n *     A copy of the ``callbacks`` object, with the given ``methodNames`` bound\n *     to ``context``.\n */\n_.bindCallbacks = function(callbacks, context,\n                           methodNames=['success', 'error', 'complete']) {\n    if (!context) {\n        return callbacks;\n    }\n\n    const wrappedCallbacks = {};\n\n    for (let [key, value] of Object.entries(callbacks)) {\n        if (methodNames.includes(key) && _.isFunction(value)) {\n            wrappedCallbacks[key] = _.bind(value, context);\n        }\n    }\n\n    return _.defaults(wrappedCallbacks, callbacks);\n};\n\n\n/**\n * Return a function that will be called when the call stack has unwound.\n *\n * This will return a function that calls the provided function using\n * :js:func:`_.defer`.\n *\n * Args:\n *     func (function):\n *         The function to call.\n *\n * Returns:\n *     function:\n *     The wrapper function.\n */\n_.deferred = function(func) {\n    return () => {\n        _.defer(func);\n    };\n};\n\n\n/**\n * Return a function suitable for efficiently handling page layout.\n *\n * The returned function will use :js:func:`window.requestAnimationFrame` to\n * schedule the layout call. Once this function called, any subsequent calls\n * will be ignored until the first call has finished the layout work.\n *\n * Optionally, this can also defer layout work until the call stack has unwound.\n *\n * This is intended to be used as a resize event handler.\n *\n * Args:\n *     layoutFunc (function):\n *         The function to call to perform layout.\n *\n *     options (object):\n *         Options for the layout callback.\n *\n * Option Args:\n *     defer (boolean):\n *         If ``true``, the layout function will be called when the call stack\n *         has unwound after the next scheduled layout call.\n */\n_.throttleLayout = function(layoutFunc, options={}) {\n    let handlingLayout = false;\n\n    /*\n     * We don't want to use a fat arrow function here, since we need the\n     * caller's context to be preserved.\n     */\n    return function() {\n        if (handlingLayout) {\n            return;\n        }\n\n        const context = this;\n        const args = arguments;\n\n        handlingLayout = true;\n\n        let cb = () => {\n            layoutFunc.apply(context, args);\n            handlingLayout = false;\n        };\n\n        if (options.defer) {\n            cb = _.deferred(cb);\n        }\n\n        requestAnimationFrame(cb);\n    };\n};\n\n\n/*\n * Return the parent prototype for an object.\n *\n * This is only considered safe when working with Spina or Backbone objects,\n * due to special state made available when those objects are initialized.\n * Other types of objects may produce incorrect results.\n *\n * Version Changed:\n *     6.0:\n *     Added explicit support for safely working with Spina or Backbone\n *     objects.\n *\n * Args:\n *     obj (object):\n *         An object.\n *\n * Returns:\n *     object:\n *     The object which is the parent prototype for the given ``obj``. This is\n *     roughly equivalent to what you'd get from ES6's ``super``.\n */\nwindow._super = function(obj) {\n    if (obj.hasOwnProperty('__super__')) {\n        return obj.__super__.prototype;\n    }\n\n    return Object.getPrototypeOf(Object.getPrototypeOf(obj));\n};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,CAAC,CAACC,aAAa,GAAG,UAASC,SAAS,EAAEC,OAAO,EAClBC,WAAW,GAAC,CAAC,SAAS,EAAE,OAAO,EAAE,UAAU,CAAC,EAAE;EACrE,IAAI,CAACD,OAAO,EAAE;IACV,OAAOD,SAAS;EACpB;EAEA,MAAMG,gBAAgB,GAAG,CAAC,CAAC;EAE3B,KAAK,IAAI,CAACC,GAAG,EAAEC,KAAK,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACP,SAAS,CAAC,EAAE;IAChD,IAAIE,WAAW,CAACM,QAAQ,CAACJ,GAAG,CAAC,IAAIN,CAAC,CAACW,UAAU,CAACJ,KAAK,CAAC,EAAE;MAClDF,gBAAgB,CAACC,GAAG,CAAC,GAAGN,CAAC,CAACY,IAAI,CAACL,KAAK,EAAEJ,OAAO,CAAC;IAClD;EACJ;EAEA,OAAOH,CAAC,CAACa,QAAQ,CAACR,gBAAgB,EAAEH,SAAS,CAAC;AAClD,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAF,CAAC,CAACc,QAAQ,GAAG,UAASC,IAAI,EAAE;EACxB,OAAO,MAAM;IACTf,CAAC,CAACgB,KAAK,CAACD,IAAI,CAAC;EACjB,CAAC;AACL,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAf,CAAC,CAACiB,cAAc,GAAG,UAASC,UAAU,EAAEC,OAAO,GAAC,CAAC,CAAC,EAAE;EAChD,IAAIC,cAAc,GAAG,KAAK;;EAE1B;AACJ;AACA;AACA;EACI,OAAO,YAAW;IACd,IAAIA,cAAc,EAAE;MAChB;IACJ;IAEA,MAAMjB,OAAO,GAAG,IAAI;IACpB,MAAMkB,IAAI,GAAGC,SAAS;IAEtBF,cAAc,GAAG,IAAI;IAErB,IAAIG,EAAE,GAAGA,CAAA,KAAM;MACXL,UAAU,CAACM,KAAK,CAACrB,OAAO,EAAEkB,IAAI,CAAC;MAC/BD,cAAc,GAAG,KAAK;IAC1B,CAAC;IAED,IAAID,OAAO,CAACH,KAAK,EAAE;MACfO,EAAE,GAAGvB,CAAC,CAACc,QAAQ,CAACS,EAAE,CAAC;IACvB;IAEAE,qBAAqB,CAACF,EAAE,CAAC;EAC7B,CAAC;AACL,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAG,MAAM,CAACC,MAAM,GAAG,UAASC,GAAG,EAAE;EAC1B,IAAIA,GAAG,CAACC,cAAc,CAAC,WAAW,CAAC,EAAE;IACjC,OAAOD,GAAG,CAACE,SAAS,CAACC,SAAS;EAClC;EAEA,OAAOvB,MAAM,CAACwB,cAAc,CAACxB,MAAM,CAACwB,cAAc,CAACJ,GAAG,CAAC,CAAC;AAC5D,CAAC","ignoreList":[]}