{"version":3,"file":"repositorySelectionView.js","names":["RB","RepositorySelectionView","CollectionView","extend","tagName","className","itemViewType","RepositoryView","template","_","events","initialize","prototype","apply","arguments","_selected","_searchActive","_onSearchChanged","throttle","bind","listenTo","collection","_onRepositorySelected","render","$el","html","repositoriesLabel","gettext","filterLabel","$container","$","_$searchBox","unselect","views","forEach","view","model","removeClass","trigger","item","addClass","searchTerm","val","toLowerCase","console","log","search"],"sources":["../../../../../../static/rb/js/newReviewRequest/views/repositorySelectionView.es6.js"],"sourcesContent":["/**\n * A view for selecting a repository from a collection.\n */\nRB.RepositorySelectionView = RB.CollectionView.extend({\n    tagName: 'ul',\n    className: 'rb-c-sidebar__items repository-selector',\n    itemViewType: RB.RepositoryView,\n\n    template: _.template(dedent`\n        <li class=\"rb-c-sidebar__section -no-icons\">\n         <header class=\"rb-c-sidebar__section-header\">\n          <%- repositoriesLabel %>\n         </header>\n         <ul class=\"rb-c-sidebar__items\">\n          <li class=\"rb-c-sidebar__item\">\n           <div class=\"rb-c-sidebar__item-label\">\n            <div class=\"rb-c-search-field\">\n             <span class=\"fa fa-search\"></span>\n             <input class=\"rb-c-search-field__input\" type=\"search\"\n                    placeholder=\"<%- filterLabel %>\">\n            </div>\n           </div>\n          </li>\n         </ul>\n         <ul class=\"rb-c-sidebar__items\n                    rb-c-new-review-request__repository-items\">\n        </li>\n    `),\n\n    events: {\n        'input .rb-c-search-field__input': '_onSearchChanged',\n    },\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        RB.CollectionView.prototype.initialize.apply(this, arguments);\n\n        this._selected = null;\n        this._searchActive = false;\n        this._onSearchChanged = _.throttle(this._onSearchChanged.bind(this), 100);\n\n        this.listenTo(this.collection, 'selected', this._onRepositorySelected);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.RepositorySelectionView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el.html(this.template({\n            repositoriesLabel: gettext('Repositories'),\n            filterLabel: gettext('Filter'),\n        }));\n\n        this.$container = this.$('.rb-c-new-review-request__repository-items');\n\n        this._$searchBox = this.$('.rb-c-search-field__input');\n\n        RB.CollectionView.prototype.render.apply(this, arguments);\n\n        return this;\n    },\n\n    /**\n     * Unselect a repository.\n     */\n    unselect() {\n        this.views.forEach(view => {\n            if (view.model === this._selected) {\n                view.$el.removeClass('active');\n            }\n        });\n\n        this._selected = null;\n\n        this.trigger('selected', null);\n    },\n\n    /**\n     * Callback for when an individual repository is selected.\n     *\n     * Ensures that the selected repository has the 'selected' class applied\n     * (and no others do), and triggers the 'selected' event on the view.\n     *\n     * Args:\n     *     item (RB.Repository):\n     *         The selected repository;\n     */\n    _onRepositorySelected(item) {\n        this._selected = item;\n\n        this.views.forEach(view => {\n            if (view.model === item) {\n                view.$el.addClass('-is-active');\n            } else {\n                view.$el.removeClass('-is-active');\n            }\n        });\n\n        this.trigger('selected', item);\n    },\n\n    /**\n     * Callback for when the text in the search input changes.\n     *\n     * Filters the visible items.\n     */\n    _onSearchChanged() {\n        const searchTerm = this._$searchBox.val().toLowerCase();\n        console.log('search', searchTerm);\n        this.collection.search(searchTerm);\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACAA,EAAE,CAACC,uBAAuB,GAAGD,EAAE,CAACE,cAAc,CAACC,MAAM,CAAC;EAClDC,OAAO,EAAE,IAAI;EACbC,SAAS,EAAE,yCAAyC;EACpDC,YAAY,EAAEN,EAAE,CAACO,cAAc;EAE/BC,QAAQ,EAAEC,CAAC,CAACD,QAAQ,CAAO;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAEK,CAAC;EAEFE,MAAM,EAAE;IACJ,iCAAiC,EAAE;EACvC,CAAC;EAED;AACJ;AACA;EACIC,UAAUA,CAAA,EAAG;IACTX,EAAE,CAACE,cAAc,CAACU,SAAS,CAACD,UAAU,CAACE,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;IAE7D,IAAI,CAACC,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,aAAa,GAAG,KAAK;IAC1B,IAAI,CAACC,gBAAgB,GAAGR,CAAC,CAACS,QAAQ,CAAC,IAAI,CAACD,gBAAgB,CAACE,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC;IAEzE,IAAI,CAACC,QAAQ,CAAC,IAAI,CAACC,UAAU,EAAE,UAAU,EAAE,IAAI,CAACC,qBAAqB,CAAC;EAC1E,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,MAAMA,CAAA,EAAG;IACL,IAAI,CAACC,GAAG,CAACC,IAAI,CAAC,IAAI,CAACjB,QAAQ,CAAC;MACxBkB,iBAAiB,EAAAC,OAAA,gBAAyB;MAC1CC,WAAW,EAAAD,OAAA;IACf,CAAC,CAAC,CAAC;IAEH,IAAI,CAACE,UAAU,GAAG,IAAI,CAACC,CAAC,CAAC,4CAA4C,CAAC;IAEtE,IAAI,CAACC,WAAW,GAAG,IAAI,CAACD,CAAC,CAAC,2BAA2B,CAAC;IAEtD9B,EAAE,CAACE,cAAc,CAACU,SAAS,CAACW,MAAM,CAACV,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;IAEzD,OAAO,IAAI;EACf,CAAC;EAED;AACJ;AACA;EACIkB,QAAQA,CAAA,EAAG;IACP,IAAI,CAACC,KAAK,CAACC,OAAO,CAACC,IAAI,IAAI;MACvB,IAAIA,IAAI,CAACC,KAAK,KAAK,IAAI,CAACrB,SAAS,EAAE;QAC/BoB,IAAI,CAACX,GAAG,CAACa,WAAW,CAAC,QAAQ,CAAC;MAClC;IACJ,CAAC,CAAC;IAEF,IAAI,CAACtB,SAAS,GAAG,IAAI;IAErB,IAAI,CAACuB,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC;EAClC,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIhB,qBAAqBA,CAACiB,IAAI,EAAE;IACxB,IAAI,CAACxB,SAAS,GAAGwB,IAAI;IAErB,IAAI,CAACN,KAAK,CAACC,OAAO,CAACC,IAAI,IAAI;MACvB,IAAIA,IAAI,CAACC,KAAK,KAAKG,IAAI,EAAE;QACrBJ,IAAI,CAACX,GAAG,CAACgB,QAAQ,CAAC,YAAY,CAAC;MACnC,CAAC,MAAM;QACHL,IAAI,CAACX,GAAG,CAACa,WAAW,CAAC,YAAY,CAAC;MACtC;IACJ,CAAC,CAAC;IAEF,IAAI,CAACC,OAAO,CAAC,UAAU,EAAEC,IAAI,CAAC;EAClC,CAAC;EAED;AACJ;AACA;AACA;AACA;EACItB,gBAAgBA,CAAA,EAAG;IACf,MAAMwB,UAAU,GAAG,IAAI,CAACV,WAAW,CAACW,GAAG,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;IACvDC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEJ,UAAU,CAAC;IACjC,IAAI,CAACpB,UAAU,CAACyB,MAAM,CAACL,UAAU,CAAC;EACtC;AACJ,CAAC,CAAC","ignoreList":[]}