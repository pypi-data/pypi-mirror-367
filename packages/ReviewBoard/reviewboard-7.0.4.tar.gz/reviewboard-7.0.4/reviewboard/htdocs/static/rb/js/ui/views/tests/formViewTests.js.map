{"version":3,"file":"formViewTests.js","names":["suite","template","view","$subforms","beforeEach","RB","FormView","el","$","render","$el","appendTo","$testsScratch","_$subforms","checkSubformVisibility","index","visible","$subform","eq","expect","prop","toBe","describe","it","$fieldset","hasClass","find","click","text","length","_","keys","_subformsByGroup","toEqual","group1","group2","subform1","subform2","subform3","subform4","children","val","triggerHandler","setSubformVisibility","group","subformID","hideOthers"],"sources":["../../../../../../../static/rb/js/ui/views/tests/formViewTests.es6.js"],"sourcesContent":["suite('rb/ui/views/FormView', function() {\n    const template = dedent`\n        <form class=\"rb-c-form\">\n         <select id=\"subform1-selector\"\n                 data-subform-group=\"group1\">\n          <option value=\"subform1\">subform1</option>\n          <option value=\"subform2\">subform2</option>\n         </select>\n\n         <fieldset class=\"rb-c-form-fieldset\">\n          <legend class=\"rb-c-form-fieldset__name\">\n           Title\n           <a href=\"#\" class=\"rb-c-form-fieldset__toggle\">(Hide)</a>\n          </legend>\n          <div class=\"rb-c-form-fieldset__content\"></div>\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-collapsed\">\n          <legend class=\"rb-c-form-fieldset__name\">\n           Title\n           <a href=\"#\" class=\"rb-c-form-fieldset__toggle\">(Show)</a>\n          </legend>\n          <div class=\"rb-c-form-fieldset__content\"></div>\n         </fieldset>\n\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-controller=\"subform1-selector\"\n                   data-subform-id=\"subform1\">\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-controller=\"subform1-selector\"\n                   data-subform-id=\"subform2\">\n         </fieldset>\n\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-group=\"group2\"\n                   data-subform-id=\"subform3\">\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-group=\"group2\"\n                   data-subform-id=\"subform4\"\n                   disabled hidden>\n         </fieldset>\n        </form>\n    `;\n\n    let view;\n    let $subforms;\n\n    beforeEach(function() {\n        view = new RB.FormView({\n            el: $(template),\n        });\n        view.render().$el.appendTo($testsScratch);\n\n        $subforms = view._$subforms;\n    });\n\n    function checkSubformVisibility(index, visible) {\n        const $subform = $subforms.eq(index);\n\n        expect($subform.prop('disabled')).toBe(!visible);\n        expect($subform.prop('hidden')).toBe(!visible);\n    }\n\n    describe('Fieldsets', function() {\n        it('Collapsing', function() {\n            const $fieldset = view.$('.rb-c-form-fieldset').eq(0);\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(false);\n\n            $fieldset.find('.rb-c-form-fieldset__toggle').click();\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(true);\n            expect($fieldset.find('.rb-c-form-fieldset__toggle').text())\n                .toBe('(Show)');\n        });\n\n        it('Expanding', function() {\n            const $fieldset = view.$('.rb-c-form-fieldset').eq(1);\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(true);\n\n            $fieldset.find('.rb-c-form-fieldset__toggle').click();\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(false);\n            expect($fieldset.find('.rb-c-form-fieldset__toggle').text())\n                .toBe('(Hide)');\n        });\n    });\n\n    describe('Subforms', function() {\n        it('Loaded state', function() {\n            expect($subforms.length).toBe(4);\n            expect(_.keys(view._subformsByGroup))\n                .toEqual(['group1', 'group2']);\n            expect(_.keys(view._subformsByGroup.group1))\n                .toEqual(['subform1', 'subform2']);\n            expect(_.keys(view._subformsByGroup.group2))\n                .toEqual(['subform3', 'subform4']);\n            expect(view._subformsByGroup.group1.subform1[0])\n                .toBe($subforms[0]);\n            expect(view._subformsByGroup.group1.subform2[0])\n                .toBe($subforms[1]);\n            expect(view._subformsByGroup.group2.subform3[0])\n                .toBe($subforms[2]);\n            expect(view._subformsByGroup.group2.subform4[0])\n                .toBe($subforms[3]);\n\n            checkSubformVisibility(0, true);\n            checkSubformVisibility(1, false);\n            checkSubformVisibility(2, true);\n            checkSubformVisibility(3, false);\n        });\n\n        it('Controller value changed', function() {\n            view.$el.children('select')\n                .val('subform2')\n                .triggerHandler('change');\n\n            checkSubformVisibility(0, false);\n            checkSubformVisibility(1, true);\n            checkSubformVisibility(2, true);\n            checkSubformVisibility(3, false);\n        });\n    });\n\n    describe('Methods', function() {\n        describe('setSubformVisibility', function() {\n            it('With group', function() {\n                view.setSubformVisibility({\n                    group: 'group2',\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n            });\n\n            it('With group, visible', function() {\n                view.setSubformVisibility({\n                    group: 'group2',\n                    visible: true,\n                });\n\n                checkSubformVisibility(2, true);\n                checkSubformVisibility(3, true);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    visible: false,\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n            });\n\n            it('With group, subformID, visible', function() {\n                checkSubformVisibility(2, true);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    subformID: 'subform3',\n                    visible: false,\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    subformID: 'subform4',\n                    visible: true,\n                });\n\n                checkSubformVisibility(3, true);\n            });\n\n            it('With group, subformID, visible, hideOthers', function() {\n                view.setSubformVisibility({\n                    group: 'group1',\n                    subformID: 'subform2',\n                    visible: true,\n                    hideOthers: true,\n                });\n\n                checkSubformVisibility(0, false);\n                checkSubformVisibility(1, true);\n\n                view.setSubformVisibility({\n                    group: 'group1',\n                    subformID: 'subform1',\n                    visible: true,\n                    hideOthers: true,\n                });\n\n                checkSubformVisibility(0, true);\n                checkSubformVisibility(1, false);\n            });\n        });\n    });\n});\n"],"mappings":"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","ignoreList":[]}