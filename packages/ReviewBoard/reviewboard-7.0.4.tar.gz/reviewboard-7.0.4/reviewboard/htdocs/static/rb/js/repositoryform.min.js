!function(){"use strict";{const L={},z=[],A=`<h3>${gettext("Power Pack Required")}</h3>
<p>
${gettext('<span class="power-pack-advert-hosting-type"></span> support is available with <a href="https://www.reviewboard.org/powerpack/">Power Pack</a>, an extension which also offers powerful reports, document review, and more.')}
</p>`,U=`<h3>
${gettext("Plugin Required")}
</h3>
<p>
${interpolate(gettext('The <code>gerrit-reviewboard</code> plugin is required for Gerrit integration. See the <a href="%s" target="_blank">instructions</a> for installing the plugin on your server.'),[MANUAL_URL+"admin/configuration/repositories/gerrit/"])}
</p>`;function q(e,t,o,r){var a=HOSTING_SERVICES[o].plans,i=t.val();if(t.empty(),1===a.length||r)e.hide();else{for(let e=0;e<a.length;e++){var n=a[e],s=$("<option>").val(n.type).text(n.label).appendTo(t);n.type===i&&s.prop("selected",!0)}e.show()}t.triggerHandler("change")}function P(e,t,o,r){t=`#${t}-${e.val()}-`+(o.val()||"default");r.hide(),$(t).show()}$(document).ready(function(){const l=$("#id_hosting_type"),o=$(".hosting-auth-form"),e=$(".hosting-repo-form"),r=$("#id_hosting_account"),h=$("#row-hosting_account"),a=$("<p>").text(gettext("The authentication requirements for this account have changed. You will need to re-authenticate.")).addClass("errornote").hide().appendTo(h),c=$(".scmtool-auth-form"),g=$(".scmtool-repo-form"),p=$("#row-associate_ssh_key").parents("fieldset"),u=$("#id_associate_ssh_key"),_=u.prop("disabled"),f=$("#id_bug_tracker_use_hosting"),v=$("#row-bug_tracker_use_hosting"),i=$("#id_bug_tracker_type"),t=$("#row-bug_tracker_hosting_url"),n=$("#row-bug_tracker_type"),s=$("#id_bug_tracker_plan"),d=$("#row-bug_tracker_plan"),w=$("#row-bug_tracker"),k=$("#row-bug_tracker_hosting_account_username"),m=$("#row-repository_plan"),S=$("#id_repository_plan");var b=$("#id_public");const x=$("#id_tool"),y=$("#row-tool"),H=$("#show-ssh-key-link"),E=$("#ssh-public-key-popup"),I=$(".bug-tracker-form"),T=$('input[type="submit"]'),O=$("#repo-edit-hosting-credentials"),R=$("#repo-edit-hosting-credentials-label"),C=$("#id_force_authorize"),N=$('<div class="powerpack-advert">').html(A).hide().appendTo(l.closest("fieldset")),G=$('<div class="powerpack-advert">').html(A).hide().appendTo(x.closest("fieldset")),V=$('<div class="gerrit-plugin-advert">').html(U).hide().appendTo($("#row-hosting_type"));L.bug_tracker_type="none",L.hosting_type="custom",L.tool="none",x.find("option").each((e,t)=>{t=$(t);z.push({value:t.val(),text:t.text()})}),f.change(function(){this.checked?(n.hide(),d.hide(),k.hide(),w.hide(),I.hide()):(n.show(),i.triggerHandler("change"))}).triggerHandler("change"),S.change(()=>P(l,"repo-form-hosting",S,e)),s.change(()=>{var e=s.val()||"default",t=i.val(),t=HOSTING_SERVICES[t].planInfo[e];P(i,"bug-tracker-form-hosting",s,I),k.toggle(t.bug_tracker_requires_username)}),l.change(()=>{var e=l.val(),t="custom"===e,o=!t&&!0===HOSTING_SERVICES[e].fake;{var a=$("#id_hosting_type").val();const r="custom"===a?[]:HOSTING_SERVICES[a].scmtools,i=$("#id_tool"),n=i.val();i.empty(),z.forEach(e=>{0!==r.length&&-1===r.indexOf(e.text)&&-1===r.indexOf(e.value)||($("<option>").text(e.text).val(e.value).appendTo(i),e.value===n&&i.val(n))}),i.triggerHandler("change")}if(V.toggle("gerrit"===e),t?m.hide():(c.hide(),g.hide(),q(m,S,e,o)),S.triggerHandler("change"),t||o||!HOSTING_SERVICES[e].supports_bug_trackers?(v.hide(),f.prop({disabled:!0,checked:!1}).triggerHandler("change")):(f.prop("disabled",!1),v.show()),t||!HOSTING_SERVICES[e].supports_ssh_key_association?(p.hide(),u.prop({disabled:!0,checked:!1})):(u.prop("disabled",_),p.show()),o&&N.find(".power-pack-advert-hosting-type").text(l.find(":selected").text()),h.toggle(!o),y.toggle(!o),N.toggle(o),T.prop("disabled",o),!t){a=$("#id_hosting_type").val();const s=$("#id_hosting_account");e=$("#hosting-auth-form-"+a),o=(a=HOSTING_SERVICES[a]).accounts;const d=parseInt(s.val(),10);let r=!1;s.find('option[value!=""]').remove(),(a.needs_two_factor_auth_code||0<e.find(".errorlist").length)&&(r=!0),o.forEach(e=>{let t=e.username;e.hosting_url&&(t+=` (${e.hosting_url})`);var o=$("<option>").val(e.pk).text(t).data("account",e).appendTo(s);e.pk!==d&&r||(o.prop("selected",!0),r=!0,s.triggerHandler("change"))})}}).triggerHandler("change"),$([l[0],r[0]]).change(()=>{o.hide(),a.hide(),O.hide().val(gettext("Edit credentials")),C.val("false");var e,t=l.val();"custom"===t?h.hide():!0!==(e=HOSTING_SERVICES[t]).fake&&(h.show(),(t=$("#hosting-auth-form-"+t)).find("[data-required-for-2fa]").closest(".form-row").toggle(e.needs_two_factor_auth_code),(""===r.val()?t:e.needs_two_factor_auth_code?(C.val("true"),t):(e=r[0].selectedIndex,$(r[0].options[e]).data("account").is_authorized&&0===t.find(".errorlist").length?O:(t.show(),a))).show())}).triggerHandler("change"),x.change(()=>{var e,t,o,r;"custom"===l.val()&&(o=x.val(),e=$("#auth-form-scm-"+o),t=$("#repo-form-scm-"+o),(r=!0===(o=TOOLS_INFO[o]).fake)&&G.find(".power-pack-advert-hosting-type").text(o.name),c.hide(),g.hide(),e.toggle(!r),t.toggle(!r),G.toggle(r),T.prop("disabled",r))}).triggerHandler("change"),i.change(()=>{I.hide();var e=i.val();"custom"!==e&&"none"!==e||(t.hide(),d.hide(),k.hide()),"custom"===e?w.show():"none"===e?w.hide():(w.hide(),q(d,s,e,!1),t.toggle(HOSTING_SERVICES[e].self_hosted))}).triggerHandler("change"),b.change(function(){var e=!this.checked;$("#row-users").toggle(e),$("#row-review_groups").toggle(e)}).triggerHandler("change"),H.on("click",()=>(E.is(":visible")?(H.text(gettext("Show your SSH public key")),E.hide()):(H.text(gettext("Hide your SSH public key")),E.show()),!1)),O.click(()=>{let e=$("#hosting-auth-form-"+l.val());return"true"===C.val()?(R.text(gettext("Edit credentials")),e.hide(),C.val("false")):(R.text(gettext("Cancel editing credentials")),(e=$("#hosting-auth-form-"+l.val()).show()).show(),C.val("true")),!1})})}}.call(this);
