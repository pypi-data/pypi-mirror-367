[pytest]
# Pytest configuration for flow.dev SDK integration tests

# Test discovery
testpaths = tests/integration
python_files = test_*_dev_sdk*.py test_*_dev_sdk.py
python_classes = Test*
python_functions = test_*

# Markers for different test types
markers =
    dev_sdk: Tests that use flow.dev SDK for fast execution
    isolation: Tests that demonstrate proper test isolation
    performance: Performance benchmarks using dev SDK
    concurrent: Tests that run concurrent operations
    slow: Original slow tests (for comparison)
    migration: Tests showing migration from slow to fast

# Test execution settings
addopts = 
    -v
    --strict-markers
    --tb=short
    --capture=no
    -p no:warnings
    --maxfail=5

# Parallel execution (safe with isolation)
# Uncomment to run tests in parallel
# -n auto

# Coverage settings for dev SDK tests
# --cov=flow.api.dev
# --cov=tests.integration
# --cov-report=html:htmlcov/dev_sdk

# Custom options
# --run-slow : Run original slow tests for comparison
# --dev-instance-type : Instance type for dev VM (default: h100)
# --keep-dev-vm : Don't stop dev VM after tests

# Timeout settings
timeout = 300  # 5 minutes max per test
timeout_method = thread

# Output settings
console_output_style = progress
log_cli = true
log_cli_level = INFO

# Test order - run fast tests first
# Randomize within groups to catch order dependencies
testpaths_order = 
    tests/integration/test_*_dev_sdk.py
    tests/integration/test_runner_with_isolation.py
    tests/integration/test_ssh_dev_sdk.py
    tests/integration/test_fcp_dev_sdk_integration.py