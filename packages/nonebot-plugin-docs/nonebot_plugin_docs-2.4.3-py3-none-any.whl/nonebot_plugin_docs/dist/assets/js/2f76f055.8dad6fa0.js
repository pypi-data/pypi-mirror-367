"use strict";(self.webpackChunknonebot=self.webpackChunknonebot||[]).push([["2514"],{72215:function(e,n,s){s.r(n),s.d(n,{default:()=>x,frontMatter:()=>o,metadata:()=>t,assets:()=>d,toc:()=>g,contentTitle:()=>c});var t=JSON.parse('{"id":"best-practice/alconna/uniseg","title":"\u901A\u7528\u6D88\u606F\u7EC4\u4EF6","description":"\u901A\u7528\u6D88\u606F\u7EC4\u4EF6","source":"@site/versioned_docs/version-2.4.2/best-practice/alconna/uniseg.mdx","sourceDirName":"best-practice/alconna","slug":"/best-practice/alconna/uniseg","permalink":"/website/docs/2.4.2/best-practice/alconna/uniseg","draft":false,"unlisted":false,"editUrl":"https://github.com/nonebot/nonebot2/edit/master/website/versioned_docs/version-2.4.2/best-practice/alconna/uniseg.mdx","tags":[],"version":"2.4.2","lastUpdatedBy":"noneflow[bot]","lastUpdatedAt":1754561629000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"description":"\u901A\u7528\u6D88\u606F\u7EC4\u4EF6"},"sidebar":"tutorial","previous":{"title":"\u914D\u7F6E\u9879","permalink":"/website/docs/2.4.2/best-practice/alconna/config"},"next":{"title":"\u6570\u636E\u5E93","permalink":"/website/docs/2.4.2/best-practice/database/"}}'),a=s("24246"),r=s("80980"),i=s("75037"),l=s("80981");let o={sidebar_position:5,description:"\u901A\u7528\u6D88\u606F\u7EC4\u4EF6"},c="\u901A\u7528\u6D88\u606F\u7EC4\u4EF6",d={},g=[{value:"\u901A\u7528\u6D88\u606F\u6BB5",id:"\u901A\u7528\u6D88\u606F\u6BB5",level:2},{value:"\u901A\u7528\u6D88\u606F\u5E8F\u5217",id:"\u901A\u7528\u6D88\u606F\u5E8F\u5217",level:2},{value:"\u6784\u9020",id:"\u6784\u9020",level:3},{value:"\u62FC\u63A5\u6D88\u606F",id:"\u62FC\u63A5\u6D88\u606F",level:3},{value:"\u4F7F\u7528\u6D88\u606F\u6A21\u677F",id:"\u4F7F\u7528\u6D88\u606F\u6A21\u677F",level:3},{value:"\u68C0\u67E5\u6D88\u606F\u6BB5",id:"\u68C0\u67E5\u6D88\u606F\u6BB5",level:3},{value:"\u83B7\u53D6\u6D88\u606F\u7EAF\u6587\u672C",id:"\u83B7\u53D6\u6D88\u606F\u7EAF\u6587\u672C",level:3},{value:"\u904D\u5386",id:"\u904D\u5386",level:3},{value:"\u8FC7\u6EE4\u3001\u7D22\u5F15\u4E0E\u5207\u7247",id:"\u8FC7\u6EE4\u7D22\u5F15\u4E0E\u5207\u7247",level:3},{value:"\u6D88\u606F\u53D1\u9001",id:"\u6D88\u606F\u53D1\u9001",level:2},{value:"\u6D88\u606F\u53D1\u9001\u5BF9\u8C61",id:"\u6D88\u606F\u53D1\u9001\u5BF9\u8C61",level:3},{value:"\u4E3B\u52A8\u53D1\u9001\u6D88\u606F",id:"\u4E3B\u52A8\u53D1\u9001\u6D88\u606F",level:3},{value:"\u81EA\u5B9A\u4E49\u6D88\u606F\u6BB5",id:"\u81EA\u5B9A\u4E49\u6D88\u606F\u6BB5",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\u901A\u7528\u6D88\u606F\u7EC4\u4EF6",children:"\u901A\u7528\u6D88\u606F\u7EC4\u4EF6"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"uniseg"})," \u6A21\u5757\u5C5E\u4E8E ",(0,a.jsx)(n.code,{children:"nonebot-plugin-alconna"})," \u7684\u5B50\u63D2\u4EF6\uFF0C\u5176\u63D0\u4F9B\u4E86\u4E00\u5957\u901A\u7528\u7684\u6D88\u606F\u7EC4\u4EF6\uFF0C\u7528\u4E8E\u5728 ",(0,a.jsx)(n.code,{children:"nonebot-plugin-alconna"})," \u4E0B\u6784\u5EFA\u901A\u7528\u6D88\u606F\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u901A\u7528\u6D88\u606F\u6BB5",children:"\u901A\u7528\u6D88\u606F\u6BB5"}),"\n",(0,a.jsxs)(n.p,{children:["\u9002\u914D\u5668\u4E0B\u7684\u6D88\u606F\u6BB5\u6807\u6CE8\u4F1A\u5339\u914D\u9002\u914D\u5668\u7279\u5B9A\u7684 ",(0,a.jsx)(n.code,{children:"MessageSegment"}),"\uFF0C \u800C\u901A\u7528\u6D88\u606F\u6BB5\u4E0E\u9002\u914D\u5668\u6D88\u606F\u6BB5\u7684\u533A\u522B\u5728\u4E8E\uFF1A\n\u901A\u7528\u6D88\u606F\u6BB5\u4F1A\u5339\u914D\u591A\u4E2A\u9002\u914D\u5668\u4E2D\u76F8\u4F3C\u7C7B\u578B\u7684\u6D88\u606F\u6BB5\uFF0C\u5E76\u8FD4\u56DE ",(0,a.jsx)(n.code,{children:"uniseg"})," \u6A21\u5757\u4E2D\u5B9A\u4E49\u7684 ",(0,a.jsxs)(n.a,{href:"https://nonebot.dev/docs/next/best-practice/alconna/utils#%E9%80%9A%E7%94%A8%E6%B6%88%E6%81%AF%E6%AE%B5",children:[(0,a.jsx)(n.code,{children:"Segment"})," \u6A21\u578B"]}),", \u4EE5\u8FBE\u5230",(0,a.jsx)(n.strong,{children:"\u8DE8\u5E73\u53F0\u63A5\u6536\u6D88\u606F"}),"\u7684\u4F5C\u7528\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"nonebot-plugin-alconna.uniseg"})," \u63D0\u4F9B\u4E86\u7C7B\u4F3C ",(0,a.jsx)(n.code,{children:"MessageSegment"})," \u7684\u901A\u7528\u6D88\u606F\u6BB5\uFF0C\u5E76\u53EF\u5728 ",(0,a.jsx)(n.code,{children:"Alconna"})," \u4E0B\u76F4\u63A5\u6807\u6CE8\u4F7F\u7528\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'class Segment:\n    """\u57FA\u7C7B\u6807\u6CE8"""\n    children: List["Segment"]\n\nclass Text(Segment):\n    """Text\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u6587\u672C\u5143\u7D20"""\n    text: str\n    styles: Dict[Tuple[int, int], List[str]]\n\nclass At(Segment):\n    """At\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u63D0\u9192\u67D0\u7528\u6237\u7684\u5143\u7D20"""\n    flag: Literal["user", "role", "channel"]\n    target: str\n    display: Optional[str]\n\nclass AtAll(Segment):\n    """AtAll\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u63D0\u9192\u6240\u6709\u4EBA\u7684\u5143\u7D20"""\n    here: bool\n\nclass Emoji(Segment):\n    """Emoji\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u8868\u60C5\u5143\u7D20"""\n    id: str\n    name: Optional[str]\n\nclass Media(Segment):\n    url: Optional[str]\n    id: Optional[str]\n    path: Optional[Union[str, Path]]\n    raw: Optional[Union[bytes, BytesIO]]\n    mimetype: Optional[str]\n    name: str\n\n    to_url: ClassVar[Optional[MediaToUrl]]\n\nclass Image(Media):\n    """Image\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u56FE\u7247\u5143\u7D20"""\n\nclass Audio(Media):\n    """Audio\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u97F3\u9891\u5143\u7D20"""\n    duration: Optional[int]\n\nclass Voice(Media):\n    """Voice\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u8BED\u97F3\u5143\u7D20"""\n    duration: Optional[int]\n\nclass Video(Media):\n    """Video\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u89C6\u9891\u5143\u7D20"""\n\nclass File(Segment):\n    """File\u5BF9\u8C61, \u8868\u793A\u4E00\u7C7B\u6587\u4EF6\u5143\u7D20"""\n    id: str\n    name: Optional[str]\n\nclass Reply(Segment):\n    """Reply\u5BF9\u8C61\uFF0C\u8868\u793A\u4E00\u7C7B\u56DE\u590D\u6D88\u606F"""\n    id: str\n    """\u6B64\u5904\u4E0D\u4E00\u5B9A\u662F\u6D88\u606FID\uFF0C\u53EF\u80FD\u662F\u5176\u4ED6ID\uFF0C\u5982\u6D88\u606F\u5E8F\u53F7\u7B49"""\n    msg: Optional[Union[Message, str]]\n    origin: Optional[Any]\n\nclass Reference(Segment):\n    """Reference\u5BF9\u8C61\uFF0C\u8868\u793A\u4E00\u7C7B\u5F15\u7528\u6D88\u606F\u3002\u8F6C\u53D1\u6D88\u606F (Forward) \u4E5F\u5C5E\u4E8E\u6B64\u7C7B"""\n    id: Optional[str]\n    """\u6B64\u5904\u4E0D\u4E00\u5B9A\u662F\u6D88\u606FID\uFF0C\u53EF\u80FD\u662F\u5176\u4ED6ID\uFF0C\u5982\u6D88\u606F\u5E8F\u53F7\u7B49"""\n    children: List[Union[RefNode, CustomNode]]\n\nclass Hyper(Segment):\n    """Hyper\u5BF9\u8C61\uFF0C\u8868\u793A\u4E00\u7C7B\u8D85\u7EA7\u6D88\u606F\u3002\u5982\u5361\u7247\u6D88\u606F\u3001ark\u6D88\u606F\u3001\u5C0F\u7A0B\u5E8F\u7B49"""\n    format: Literal["xml", "json"]\n    raw: Optional[str]\n    content: Optional[Union[dict, list]]\n\nclass Other(Segment):\n    """\u5176\u4ED6 Segment"""\n    origin: MessageSegment\n\n'})}),"\n",(0,a.jsxs)(n.admonition,{type:"tip",children:[(0,a.jsxs)(n.p,{children:["\u6216\u8BB8\u4F60\u6CE8\u610F\u5230\u4E86 ",(0,a.jsx)(n.code,{children:"Segment"})," \u4E0A\u6709\u4E00\u4E2A ",(0,a.jsx)(n.code,{children:"children"})," \u5C5E\u6027\u3002"]}),(0,a.jsxs)(n.p,{children:["\u8FD9\u662F\u56E0\u4E3A\u5728 ",(0,a.jsx)(n.a,{href:"https://satori.js.org/zh-CN/",children:(0,a.jsx)(n.code,{children:"Satori"})})," \u534F\u8BAE\u7684\u89C4\u5B9A\u4E0B\uFF0C\u4E00\u7C7B\u5143\u7D20\u53EF\u4EE5\u7528\u5176\u5B50\u5143\u7D20\u6765\u4EE3\u8868\u4E00\u7C7B\u517C\u5BB9\u6027\u6D88\u606F\n\uFF08\u4F8B\u5982\uFF0Cqq \u7684\u5546\u573A\u8868\u60C5\u5728\u67D0\u4E9B\u5E73\u53F0\u4E0A\u53EF\u4EE5\u7528\u56FE\u7247\u4EE3\u66FF\uFF09\u3002"]}),(0,a.jsx)(n.p,{children:'\u4E3A\u6B64\uFF0C\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u4E24\u79CD\u65B9\u5F0F\u6765\u8868\u8FBE "\u83B7\u53D6\u5B50\u5143\u7D20" \u7684\u65B9\u6CD5\uFF1A'}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.builtins.uniseg.chronocat import MarketFace\nfrom nonebot_plugin_alconna import Args, Image, Alconna, select, select_first\n\n# \u8868\u793A\u8FD9\u4E2A\u6307\u4EE4\u9700\u8981\u7684\u56FE\u7247\u8981\u4E48\u76F4\u63A5\u662F Image \u8981\u4E48\u662F\u5728 MarketFace \u5143\u7D20\u5185\u7684 Image\nalc1 = Alconna("make_meme", Args["img", [Image, Image.from_(MarketFace)]])\n\n# \u8868\u793A\u8FD9\u4E2A\u6307\u4EE4\u9700\u8981\u7684\u56FE\u7247\u4F1A\u5728\u76EE\u6807\u5143\u7D20\u4E0B\u8FDB\u884C\u641C\u7D22\uFF0C\u5C06\u6240\u6709\u7B26\u5408 Image \u7684\u5143\u7D20\u9009\u51FA\u6765\u5E76\u5C06\u7B2C\u4E00\u4E2A\u4F5C\u4E3A\u7ED3\u679C\nalc2 = Alconna("make_meme", Args["img", select(Image, index=0)])  # \u4E5F\u53EF\u4EE5\u4F7F\u7528 select_first(Image)\n'})})]}),"\n",(0,a.jsx)(n.h2,{id:"\u901A\u7528\u6D88\u606F\u5E8F\u5217",children:"\u901A\u7528\u6D88\u606F\u5E8F\u5217"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"nonebot-plugin-alconna.uniseg"})," \u540C\u65F6\u63D0\u4F9B\u4E86\u4E00\u4E2A\u7C7B\u4F3C\u4E8E ",(0,a.jsx)(n.code,{children:"Message"})," \u7684 ",(0,a.jsx)(n.code,{children:"UniMessage"})," \u7C7B\u578B\uFF0C\u5176\u5143\u7D20\u4E3A\u7ECF\u8FC7\u901A\u7528\u6807\u6CE8\u8F6C\u6362\u540E\u7684\u901A\u7528\u6D88\u606F\u6BB5\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:["\u4F60\u53EF\u4EE5\u7528\u5982\u4E0B\u65B9\u5F0F\u83B7\u53D6 ",(0,a.jsx)(n.code,{children:"UniMessage"}),"\uFF1A"]}),"\n",(0,a.jsxs)(i.Z,{groupId:"get_unimsg",children:[(0,a.jsxs)(l.Z,{value:"depend",label:"\u4F7F\u7528\u4F9D\u8D56\u6CE8\u5165",children:[(0,a.jsxs)(n.p,{children:["\u901A\u8FC7\u63D0\u4F9B\u7684 ",(0,a.jsx)(n.code,{children:"UniversalMessage"})," \u6216 ",(0,a.jsx)(n.code,{children:"UniMsg"})," \u4F9D\u8D56\u6CE8\u5165\u5668\u6765\u83B7\u53D6 ",(0,a.jsx)(n.code,{children:"UniMessage"}),"\u3002"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from nonebot_plugin_alconna.uniseg import UniMsg, At, Reply\n\n\nmatcher = on_xxx(...)\n\n@matcher.handle()\nasync def _(msg: UniMsg):\n    reply = msg[Reply, 0]\n    print(reply.origin)\n    if msg.has(At):\n        ats = msg.get(At)\n        print(ats)\n    ...\n"})})]}),(0,a.jsxs)(l.Z,{value:"method",label:"\u4F7F\u7528 UniMessage.generate",children:[(0,a.jsxs)(n.p,{children:["\u6CE8\u610F\uFF0C",(0,a.jsx)(n.code,{children:"generate"})," \u65B9\u6CD5\u5728\u54CD\u5E94\u5668\u4EE5\u5916\u7684\u5730\u65B9\u5982\u679C\u4E0D\u4F20\u5165 ",(0,a.jsx)(n.code,{children:"event"})," \u4E0E ",(0,a.jsx)(n.code,{children:"bot"})," \u5219\u65E0\u6CD5\u5904\u7406 reply\u3002"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from nonebot import Message, EventMessage\nfrom nonebot_plugin_alconna.uniseg import UniMessage\n\n\nmatcher = on_xxx(...)\n\n@matcher.handle()\nasync def _(message: Message = EventMessage()):\n    msg = await UniMessage.generate(message=message)\n    msg1 = UniMessage.generate_without_reply(message=message)\n"})})]})]}),"\n",(0,a.jsxs)(n.p,{children:["\u4E0D\u4EC5\u5982\u6B64\uFF0C\u4F60\u8FD8\u53EF\u4EE5\u901A\u8FC7 ",(0,a.jsx)(n.code,{children:"UniMessage"})," \u7684 ",(0,a.jsx)(n.code,{children:"export"})," \u4E0E ",(0,a.jsx)(n.code,{children:"send"})," \u65B9\u6CD5\u6765",(0,a.jsx)(n.strong,{children:"\u8DE8\u5E73\u53F0\u53D1\u9001\u6D88\u606F"}),"\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"UniMessage.export"})," \u4F1A\u901A\u8FC7\u4F20\u5165\u7684 ",(0,a.jsx)(n.code,{children:"bot: Bot"})," \u53C2\u6570\uFF0C\u6216\u4E0A\u4E0B\u6587\u4E2D\u7684 ",(0,a.jsx)(n.code,{children:"Bot"})," \u5BF9\u8C61\u8BFB\u53D6\u9002\u914D\u5668\u4FE1\u606F\uFF0C\u5E76\u4F7F\u7528\u5BF9\u5E94\u7684\u751F\u6210\u65B9\u6CD5\u628A\u901A\u7528\u6D88\u606F\u8F6C\u4E3A\u9002\u914D\u5668\u5BF9\u5E94\u7684\u6D88\u606F\u5E8F\u5217\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot import Bot, on_command\nfrom nonebot_plugin_alconna.uniseg import Image, UniMessage\n\n\ntest = on_command("test")\n\n@test.handle()\nasync def handle_test():\n    await test.send(await UniMessage(Image(path="path/to/img")).export())\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u9664\u6B64\u4E4B\u5916 ",(0,a.jsx)(n.code,{children:"UniMessage.send"})," \u65B9\u6CD5\u57FA\u4E8E ",(0,a.jsx)(n.code,{children:"UniMessage.export"})," \u5E76\u8C03\u7528\u5404\u9002\u914D\u5668\u4E0B\u7684\u53D1\u9001\u6D88\u606F\u65B9\u6CD5\uFF0C\u8FD4\u56DE\u4E00\u4E2A ",(0,a.jsx)(n.code,{children:"Receipt"})," \u5BF9\u8C61\uFF0C\u7528\u4E8E\u4FEE\u6539/\u64A4\u56DE\u6D88\u606F\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot import Bot, on_command\nfrom nonebot_plugin_alconna.uniseg import UniMessage\n\n\ntest = on_command("test")\n\n@test.handle()\nasync def handle():\n    receipt = await UniMessage.text("hello!").send(at_sender=True, reply_to=True)\n    await receipt.recall(delay=1)\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u800C\u5728 ",(0,a.jsx)(n.code,{children:"AlconnaMatcher"})," \u4E0B\uFF0C",(0,a.jsx)(n.code,{children:"got"}),", ",(0,a.jsx)(n.code,{children:"send"}),", ",(0,a.jsx)(n.code,{children:"reject"})," \u7B49\u53EF\u4EE5\u53D1\u9001\u6D88\u606F\u7684\u65B9\u6CD5\u7686\u652F\u6301\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"UniMessage"}),"\uFF0C\u4E0D\u9700\u8981\u624B\u52A8\u8C03\u7528 export \u65B9\u6CD5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from arclet.alconna import Alconna, Args\nfrom nonebot_plugin_alconna import Match, AlconnaMatcher, on_alconna\nfrom nonebot_plugin_alconna.uniseg import At,  UniMessage\n\n\ntest_cmd = on_alconna(Alconna("test", Args["target?", At]))\n\n@test_cmd.handle()\nasync def tt_h(matcher: AlconnaMatcher, target: Match[At]):\n    if target.available:\n        matcher.set_path_arg("target", target.result)\n\n@test_cmd.got_path("target", prompt="\u8BF7\u8F93\u5165\u76EE\u6807")\nasync def tt(target: At):\n    await test_cmd.send(UniMessage([target, "\\ndone."]))\n'})}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsxs)(n.p,{children:["\u5728\u54CD\u5E94\u5668\u4EE5\u5916\u7684\u5730\u65B9\uFF0C\u9664\u975E\u542F\u7528\u4E86 ",(0,a.jsx)(n.code,{children:"alconna_apply_fetch_targets"})," \u914D\u7F6E\u9879\uFF0C\u5426\u5219 ",(0,a.jsx)(n.code,{children:"bot"})," \u53C2\u6570\u5FC5\u987B\u624B\u52A8\u4F20\u5165\u3002"]})}),"\n",(0,a.jsx)(n.h3,{id:"\u6784\u9020",children:"\u6784\u9020"}),"\n",(0,a.jsxs)(n.p,{children:["\u5982\u540C ",(0,a.jsx)(n.code,{children:"Message"}),", ",(0,a.jsx)(n.code,{children:"UniMessage"})," \u53EF\u4EE5\u4F20\u5165\u5355\u4E2A\u5B57\u7B26\u4E32/\u6D88\u606F\u6BB5\uFF0C\u6216\u53EF\u8FED\u4EE3\u7684\u5B57\u7B26\u4E32/\u6D88\u606F\u6BB5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.uniseg import UniMessage, At\n\n\nmsg = UniMessage("Hello")\nmsg1 = UniMessage(At("user", "124"))\nmsg2 = UniMessage(["Hello", At("user", "124")])\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"UniMessage"})," \u4E0A\u540C\u65F6\u5B58\u5728\u4FBF\u6377\u65B9\u6CD5\uFF0C\u4EE4\u5176\u53EF\u4EE5\u94FE\u5F0F\u5730\u6DFB\u52A0\u6D88\u606F\u6BB5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.uniseg import UniMessage, At, Image\n\n\nmsg = UniMessage.text("Hello").at("124").image(path="/path/to/img")\nassert msg == UniMessage(\n    ["Hello", At("user", "124"), Image(path="/path/to/img")]\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u62FC\u63A5\u6D88\u606F",children:"\u62FC\u63A5\u6D88\u606F"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"str"}),"\u3001",(0,a.jsx)(n.code,{children:"UniMessage"}),"\u3001",(0,a.jsx)(n.code,{children:"Segment"})," \u5BF9\u8C61\u4E4B\u95F4\u53EF\u4EE5\u76F4\u63A5\u76F8\u52A0\uFF0C\u76F8\u52A0\u5747\u4F1A\u8FD4\u56DE\u4E00\u4E2A\u65B0\u7684 ",(0,a.jsx)(n.code,{children:"UniMessage"})," \u5BF9\u8C61\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'# \u6D88\u606F\u5E8F\u5217\u4E0E\u6D88\u606F\u6BB5\u76F8\u52A0\nUniMessage("text") + Text("text")\n# \u6D88\u606F\u5E8F\u5217\u4E0E\u5B57\u7B26\u4E32\u76F8\u52A0\nUniMessage([Text("text")]) + "text"\n# \u6D88\u606F\u5E8F\u5217\u4E0E\u6D88\u606F\u5E8F\u5217\u76F8\u52A0\nUniMessage("text") + UniMessage([Text("text")])\n# \u5B57\u7B26\u4E32\u4E0E\u6D88\u606F\u5E8F\u5217\u76F8\u52A0\n"text" + UniMessage([Text("text")])\n# \u6D88\u606F\u6BB5\u4E0E\u6D88\u606F\u6BB5\u76F8\u52A0\nText("text") + Text("text")\n# \u6D88\u606F\u6BB5\u4E0E\u5B57\u7B26\u4E32\u76F8\u52A0\nText("text") + "text"\n# \u6D88\u606F\u6BB5\u4E0E\u6D88\u606F\u5E8F\u5217\u76F8\u52A0\nText("text") + UniMessage([Text("text")])\n# \u5B57\u7B26\u4E32\u4E0E\u6D88\u606F\u6BB5\u76F8\u52A0\n"text" + Text("text")\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u5982\u679C\u9700\u8981\u5728\u5F53\u524D\u6D88\u606F\u5E8F\u5217\u540E\u76F4\u63A5\u62FC\u63A5\u65B0\u7684\u6D88\u606F\u6BB5\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"Message.append"}),"\u3001",(0,a.jsx)(n.code,{children:"Message.extend"})," \u65B9\u6CD5\uFF0C\u6216\u8005\u4F7F\u7528\u81EA\u52A0\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'msg = UniMessage([Text("text")])\n# \u81EA\u52A0\nmsg += "text"\nmsg += Text("text")\nmsg += UniMessage([Text("text")])\n# \u9644\u52A0\nmsg.append(Text("text"))\n# \u6269\u5C55\nmsg.extend([Text("text")])\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u4F7F\u7528\u6D88\u606F\u6A21\u677F",children:"\u4F7F\u7528\u6D88\u606F\u6A21\u677F"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"UniMessage.template"})," \u540C\u6837\u7C7B\u4F3C\u4E8E ",(0,a.jsx)(n.code,{children:"Message.template"}),"\uFF0C\u53EF\u4EE5\u7528\u4E8E\u683C\u5F0F\u5316\u6D88\u606F\uFF0C\u5927\u4F53\u7528\u6CD5\u53C2\u8003 ",(0,a.jsx)(n.a,{href:"../../tutorial/message#%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E6%A8%A1%E6%9D%BF",children:"\u6D88\u606F\u6A21\u677F"}),"\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:["\u8FD9\u91CC\u989D\u5916\u8BF4\u660E ",(0,a.jsx)(n.code,{children:"UniMessage.template"})," \u7684\u62D3\u5C55\u63A7\u5236\u7B26"]}),"\n",(0,a.jsxs)(n.p,{children:["\u76F8\u6BD4 ",(0,a.jsx)(n.code,{children:"Message"}),"\uFF0CUniMessage \u5BF9\u4E8E ",(0,a.jsx)(n.code,{children:"{:XXX}"})," \u505A\u4E86\u53E6\u4E00\u7C7B\u62D3\u5C55\u3002\u5176\u80FD\u591F\u8BC6\u522B\u4F8B\u5982 At(xxx, yyy) \u6216 Emoji(aaa, bbb)\u7684\u5B57\u7B26\u4E32\u5E76\u6267\u884C"]}),"\n",(0,a.jsx)(n.p,{children:"\u4EE5 At(...) \u4E3A\u4F8B\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",metastring:"title=\u4F7F\u7528\u901A\u7528\u6D88\u606F\u6BB5\u7684\u62D3\u5C55\u63A7\u5236\u7B26",children:'>>> from nonebot_plugin_alconna.uniseg import UniMessage\n>>>  UniMessage.template("{:At(user, target)}").format(target="123")\nUniMessage(At("user", "123"))\n>>> UniMessage.template("{:At(type=user, target=id)}").format(id="123")\nUniMessage(At("user", "123"))\n>>> UniMessage.template("{:At(type=user, target=123)}").format()\nUniMessage(At("user", "123"))\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u800C\u5728 ",(0,a.jsx)(n.code,{children:"AlconnaMatcher"})," \u4E2D\uFF0C",(0,a.jsx)(n.code,{children:"{:XXX}"})," \u66F4\u8FDB\u4E00\u6B65\u5730\u63D0\u4F9B\u4E86\u83B7\u53D6 ",(0,a.jsx)(n.code,{children:"event"})," \u548C ",(0,a.jsx)(n.code,{children:"bot"})," \u4E2D\u7684\u5C5E\u6027\u7684\u529F\u80FD\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",metastring:"title=\u5728AlconnaMatcher\u4E2D\u4F7F\u7528\u901A\u7528\u6D88\u606F\u6BB5\u7684\u62D3\u5C55\u63A7\u5236\u7B26",children:'from arclet.alconna import Alconna, Args\nfrom nonebot_plugin_alconna import At, Match, UniMessage, AlconnaMatcher, on_alconna\n\n\ntest_cmd = on_alconna(Alconna("test", Args["target?", At]))\n\n@test_cmd.handle()\nasync def tt_h(matcher: AlconnaMatcher, target: Match[At]):\n    if target.available:\n        matcher.set_path_arg("target", target.result)\n\n@test_cmd.got_path(\n    "target",\n    prompt=UniMessage.template("{:At(user, $event.get_user_id())} \u8BF7\u786E\u8BA4\u76EE\u6807")\n)\nasync def tt():\n    await test_cmd.send(\n      UniMessage.template("{:At(user, $event.get_user_id())} \u5DF2\u786E\u8BA4\u76EE\u6807\u4E3A {target}")\n    )\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u53E6\u5916\u4E5F\u6709 ",(0,a.jsx)(n.code,{children:"$message_id"})," \u4E0E ",(0,a.jsx)(n.code,{children:"$target"})," \u4E24\u4E2A\u7279\u6B8A\u503C\u3002"]}),"\n",(0,a.jsx)(n.h3,{id:"\u68C0\u67E5\u6D88\u606F\u6BB5",children:"\u68C0\u67E5\u6D88\u606F\u6BB5"}),"\n",(0,a.jsxs)(n.p,{children:["\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 ",(0,a.jsx)(n.code,{children:"in"})," \u8FD0\u7B97\u7B26\u6216\u6D88\u606F\u5E8F\u5217\u7684 ",(0,a.jsx)(n.code,{children:"has"})," \u65B9\u6CD5\u6765\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'# \u662F\u5426\u5B58\u5728\u6D88\u606F\u6BB5\nAt("user", "1234") in message\n# \u662F\u5426\u5B58\u5728\u6307\u5B9A\u7C7B\u578B\u7684\u6D88\u606F\u6BB5\nAt in message\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u6211\u4EEC\u8FD8\u53EF\u4EE5\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"only"})," \u65B9\u6CD5\u6765\u68C0\u67E5\u6D88\u606F\u4E2D\u662F\u5426\u4EC5\u5305\u542B\u6307\u5B9A\u7684\u6D88\u606F\u6BB5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'# \u662F\u5426\u90FD\u4E3A "test"\nmessage.only("test")\n# \u662F\u5426\u4EC5\u5305\u542B\u6307\u5B9A\u7C7B\u578B\u7684\u6D88\u606F\u6BB5\nmessage.only(Text)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u83B7\u53D6\u6D88\u606F\u7EAF\u6587\u672C",children:"\u83B7\u53D6\u6D88\u606F\u7EAF\u6587\u672C"}),"\n",(0,a.jsxs)(n.p,{children:["\u7C7B\u4F3C\u4E8E ",(0,a.jsx)(n.code,{children:"Message.extract_plain_text()"}),"\uFF0C\u7528\u4E8E\u83B7\u53D6\u901A\u7528\u6D88\u606F\u7684\u7EAF\u6587\u672C\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.uniseg import UniMessage, At\n\n\n# \u63D0\u53D6\u6D88\u606F\u7EAF\u6587\u672C\u5B57\u7B26\u4E32\nassert UniMessage(\n    [At("user", "1234"), "text"]\n).extract_plain_text() == "text"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u904D\u5386",children:"\u904D\u5386"}),"\n",(0,a.jsxs)(n.p,{children:["\u901A\u7528\u6D88\u606F\u5E8F\u5217\u7EE7\u627F\u81EA ",(0,a.jsx)(n.code,{children:"List[Segment]"})," \uFF0C\u56E0\u6B64\u53EF\u4EE5\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"for"})," \u5FAA\u73AF\u904D\u5386\u6D88\u606F\u6BB5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"for segment in message:  # type: Segment\n    ...\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u8FC7\u6EE4\u7D22\u5F15\u4E0E\u5207\u7247",children:"\u8FC7\u6EE4\u3001\u7D22\u5F15\u4E0E\u5207\u7247"}),"\n",(0,a.jsxs)(n.p,{children:["\u6D88\u606F\u5E8F\u5217\u5BF9\u5217\u8868\u7684\u7D22\u5F15\u4E0E\u5207\u7247\u8FDB\u884C\u4E86\u589E\u5F3A\uFF0C\u5728\u539F\u6709\u5217\u8868 ",(0,a.jsx)(n.code,{children:"int"})," \u7D22\u5F15\u4E0E ",(0,a.jsx)(n.code,{children:"slice"})," \u5207\u7247\u7684\u57FA\u7840\u4E0A\uFF0C\u652F\u6301 ",(0,a.jsx)(n.code,{children:"type"})," \u8FC7\u6EE4\u7D22\u5F15\u4E0E\u5207\u7247\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.uniseg import UniMessage, At, Text, Reply\n\n\nmessage = UniMessage(\n    [\n        Reply(...),\n        "text1",\n        At("user", "1234"),\n        "text2"\n    ]\n)\n# \u7D22\u5F15\nmessage[0] == Reply(...)\n# \u5207\u7247\nmessage[0:2] == UniMessage([Reply(...), Text("text1")])\n# \u7C7B\u578B\u8FC7\u6EE4\nmessage[At] == Message([At("user", "1234")])\n# \u7C7B\u578B\u7D22\u5F15\nmessage[At, 0] == At("user", "1234")\n# \u7C7B\u578B\u5207\u7247\nmessage[Text, 0:2] == UniMessage([Text("text1"), Text("text2")])\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u6211\u4EEC\u4E5F\u53EF\u4EE5\u901A\u8FC7\u6D88\u606F\u5E8F\u5217\u7684 ",(0,a.jsx)(n.code,{children:"include"}),"\u3001",(0,a.jsx)(n.code,{children:"exclude"})," \u65B9\u6CD5\u8FDB\u884C\u7C7B\u578B\u8FC7\u6EE4\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"message.include(Text, At)\nmessage.exclude(Reply)\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u540C\u6837\u7684\uFF0C\u6D88\u606F\u5E8F\u5217\u5BF9\u5217\u8868\u7684 ",(0,a.jsx)(n.code,{children:"index"}),"\u3001",(0,a.jsx)(n.code,{children:"count"})," \u65B9\u6CD5\u4E5F\u8FDB\u884C\u4E86\u589E\u5F3A\uFF0C\u53EF\u4EE5\u7528\u4E8E\u7D22\u5F15\u6307\u5B9A\u7C7B\u578B\u7684\u6D88\u606F\u6BB5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# \u6307\u5B9A\u7C7B\u578B\u9996\u4E2A\u6D88\u606F\u6BB5\u7D22\u5F15\nmessage.index(Text) == 1\n# \u6307\u5B9A\u7C7B\u578B\u6D88\u606F\u6BB5\u6570\u91CF\nmessage.count(Text) == 2\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u6B64\u5916\uFF0C\u6D88\u606F\u5E8F\u5217\u6DFB\u52A0\u4E86\u4E00\u4E2A ",(0,a.jsx)(n.code,{children:"get"})," \u65B9\u6CD5\uFF0C\u53EF\u4EE5\u7528\u4E8E\u83B7\u53D6\u6307\u5B9A\u7C7B\u578B\u6307\u5B9A\u4E2A\u6570\u7684\u6D88\u606F\u6BB5\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'# \u83B7\u53D6\u6307\u5B9A\u7C7B\u578B\u6307\u5B9A\u4E2A\u6570\u7684\u6D88\u606F\u6BB5\nmessage.get(Text, 1) == UniMessage([Text("test1")])\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u6D88\u606F\u53D1\u9001",children:"\u6D88\u606F\u53D1\u9001"}),"\n",(0,a.jsxs)(n.p,{children:["\u524D\u9762\u63D0\u5230\uFF0C\u901A\u7528\u6D88\u606F\u53EF\u7528 ",(0,a.jsx)(n.code,{children:"UniMessage.send"})," \u53D1\u9001\u81EA\u8EAB\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"async def send(\n    self,\n    target: Union[Event, Target, None] = None,\n    bot: Optional[Bot] = None,\n    fallback: bool = True,\n    at_sender: Union[str, bool] = False,\n    reply_to: Union[str, bool] = False,\n) -> Receipt:\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5B9E\u9645\u4E0A\uFF0C",(0,a.jsx)(n.code,{children:"UniMessage"})," \u540C\u65F6\u63D0\u4F9B\u4E86\u83B7\u53D6\u6D88\u606F\u4E8B\u4EF6 id \u4E0E\u6D88\u606F\u53D1\u9001\u5BF9\u8C61\u7684\u65B9\u6CD5:"]}),"\n",(0,a.jsxs)(i.Z,{groupId:"get_unimsg",children:[(0,a.jsxs)(l.Z,{value:"depend",label:"\u4F7F\u7528\u4F9D\u8D56\u6CE8\u5165",children:[(0,a.jsxs)(n.p,{children:["\u901A\u8FC7\u63D0\u4F9B\u7684 ",(0,a.jsx)(n.code,{children:"MessageTarget"}),", ",(0,a.jsx)(n.code,{children:"MessageId"})," \u6216 ",(0,a.jsx)(n.code,{children:"MsgTarget"}),", ",(0,a.jsx)(n.code,{children:"MsgId"})," \u4F9D\u8D56\u6CE8\u5165\u5668\u6765\u83B7\u53D6\u6D88\u606F\u4E8B\u4EF6 id \u4E0E\u6D88\u606F\u53D1\u9001\u5BF9\u8C61\u3002"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from nonebot_plugin_alconna.uniseg import MessageId, MsgTarget\n\n\nmatcher = on_xxx(...)\n\n@matcher.handle()\nasycn def _(target: MsgTarget, msg_id: MessageId):\n    ...\n"})})]}),(0,a.jsx)(l.Z,{value:"method",label:"\u4F7F\u7528 UniMessage \u7684\u65B9\u6CD5",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from nonebot import Event, Bot\nfrom nonebot_plugin_alconna.uniseg import UniMessage, Target\n\n\nmatcher = on_xxx(...)\n\n@matcher.handle()\nasycn def _(bot: Bot, event: Event):\n    target: Target = UniMessage.get_target(event, bot)\n    msg_id: str = UniMessage.get_message_id(event, bot)\n\n"})})})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"send"}),", ",(0,a.jsx)(n.code,{children:"get_target"}),", ",(0,a.jsx)(n.code,{children:"get_message_id"})," \u4E2D\u4E0E ",(0,a.jsx)(n.code,{children:"event"}),", ",(0,a.jsx)(n.code,{children:"bot"})," \u76F8\u5173\u7684\u53C2\u6570\u90FD\u4F1A\u5C1D\u8BD5\u4ECE\u4E0A\u4E0B\u6587\u4E2D\u83B7\u53D6\u5BF9\u8C61\u3002"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6D88\u606F\u53D1\u9001\u5BF9\u8C61",children:"\u6D88\u606F\u53D1\u9001\u5BF9\u8C61"}),"\n",(0,a.jsx)(n.p,{children:"\u6D88\u606F\u53D1\u9001\u5BF9\u8C61\u662F\u7528\u6765\u63CF\u8FF0\u54CD\u5E94\u6D88\u606F\u65F6\u7684\u53D1\u9001\u5BF9\u8C61\u6216\u8005\u4E3B\u52A8\u53D1\u9001\u6D88\u606F\u65F6\u7684\u76EE\u6807\u5BF9\u8C61\u7684\u5BF9\u8C61\uFF0C\u5B83\u5305\u542B\u4E86\u4EE5\u4E0B\u5C5E\u6027\uFF1A"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'class Target:\n    id: str\n    """\u76EE\u6807id\uFF1B\u82E5\u4E3A\u7FA4\u804A\u5219\u4E3Agroup_id\u6216\u8005channel_id\uFF0C\u82E5\u4E3A\u79C1\u804A\u5219\u4E3Auser_id"""\n    parent_id: str\n    """\u7236\u7EA7id\uFF1B\u82E5\u4E3A\u9891\u9053\u5219\u4E3Aguild_id\uFF0C\u5176\u4ED6\u60C5\u51B5\u4E0B\u53EF\u80FD\u4E3A\u7A7A\u5B57\u7B26\u4E32\uFF08\u4F8B\u5982 Feishu \u4E0B\u53EF\u4F5C\u4E3A\u90E8\u95E8 id\uFF09"""\n    channel: bool\n    """\u662F\u5426\u4E3A\u9891\u9053\uFF0C\u4EC5\u5F53\u76EE\u6807\u5E73\u53F0\u7B26\u5408\u9891\u9053\u6982\u5FF5\u65F6"""\n    private: bool\n    """\u662F\u5426\u4E3A\u79C1\u804A"""\n    source: str\n    """\u53EF\u80FD\u7684\u4E8B\u4EF6id"""\n    self_id: Union[str, None]\n    """\u673A\u5668\u4EBAid\uFF0C\u82E5\u4E3A None \u5219 Bot \u5BF9\u8C61\u4F1A\u968F\u673A\u9009\u62E9"""\n    selector: Union[Callable[[Bot], Awaitable[bool]], None]\n    """\u9009\u62E9\u5668\uFF0C\u7528\u4E8E\u5728\u591A\u4E2A Bot \u5BF9\u8C61\u4E2D\u9009\u62E9\u7279\u5B9A Bot"""\n    extra: Dict[str, Any]\n    """\u989D\u5916\u4FE1\u606F\uFF0C\u7528\u4E8E\u9002\u914D\u5668\u6269\u5C55"""\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5176\u6784\u9020\u65F6\u9700\u8981\u5982\u4E0B\u53C2\u6570\uFF1A"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"id"})," \u4E3A\u76EE\u6807id\uFF1B\u82E5\u4E3A\u7FA4\u804A\u5219\u4E3A group_id \u6216\u8005 channel_id\uFF0C\u82E5\u4E3A\u79C1\u804A\u5219\u4E3Auser_id"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"parent_id"})," \u4E3A\u7236\u7EA7id\uFF1B\u82E5\u4E3A\u9891\u9053\u5219\u4E3A guild_id\uFF0C\u5176\u4ED6\u60C5\u51B5\u4E0B\u53EF\u80FD\u4E3A\u7A7A\u5B57\u7B26\u4E32\uFF08\u4F8B\u5982 Feishu \u4E0B\u53EF\u4F5C\u4E3A\u90E8\u95E8 id\uFF09"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"channel"})," \u4E3A\u662F\u5426\u4E3A\u9891\u9053\uFF0C\u4EC5\u5F53\u76EE\u6807\u5E73\u53F0\u7B26\u5408\u9891\u9053\u6982\u5FF5\u65F6"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"private"})," \u4E3A\u662F\u5426\u4E3A\u79C1\u804A"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"source"})," \u4E3A\u53EF\u80FD\u7684\u4E8B\u4EF6id"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"self_id"})," \u4E3A\u673A\u5668\u4EBAid\uFF0C\u82E5\u4E3A None \u5219 Bot \u5BF9\u8C61\u4F1A\u968F\u673A\u9009\u62E9"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"selector"})," \u4E3A\u9009\u62E9\u5668\uFF0C\u7528\u4E8E\u5728\u591A\u4E2A Bot \u5BF9\u8C61\u4E2D\u9009\u62E9\u7279\u5B9A Bot"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"scope"})," \u4E3A\u9002\u914D\u5668\u8303\u56F4\uFF0C\u7528\u4E8E\u4F20\u5165\u5185\u7F6E\u7684\u7279\u5B9A\u9009\u62E9\u5668"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"adapter"})," \u4E3A\u9002\u914D\u5668\u540D\u79F0\uFF0C\u82E5\u4E3A None \u5219\u9700\u8981\u660E\u786E\u6307\u5B9A Bot \u5BF9\u8C61"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"platform"})," \u4E3A\u5E73\u53F0\u540D\u79F0\uFF0C\u4EC5\u5F53\u76EE\u6807\u9002\u914D\u5668\u5B58\u5728\u591A\u4E2A\u5E73\u53F0\u65F6\u4F7F\u7528"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"extra"})," \u4E3A\u989D\u5916\u4FE1\u606F\uFF0C\u7528\u4E8E\u9002\u914D\u5668\u6269\u5C55"]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["\u901A\u8FC7 ",(0,a.jsx)(n.code,{children:"Target"})," \u5BF9\u8C61\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728 ",(0,a.jsx)(n.code,{children:"UniMessage.send"})," \u4E2D\u6307\u5B9A\u53D1\u9001\u5BF9\u8C61\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.uniseg import UniMessage, MsgTarget, Target, SupportScope\n\n\nmatcher = on_xxx(...)\n\n@matcher.handle()\nasync def _(target: MsgTarget):\n    await UniMessage("Hello!").send(target=target)\n    target1 = Target("xxxx", scope=SupportScope.qq_client)\n    await UniMessage("Hello!").send(target=target1)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u4E3B\u52A8\u53D1\u9001\u6D88\u606F",children:"\u4E3B\u52A8\u53D1\u9001\u6D88\u606F"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"UniMessage.send"})," \u4E5F\u53EF\u4EE5\u7528\u4E8E\u4E3B\u52A8\u53D1\u9001\u6D88\u606F\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from nonebot_plugin_alconna.uniseg import UniMessage, Target, SupportScope\nfrom nonebot import get_driver\n\n\ndriver = get_driver()\n\n@driver.on_startup\nasync def on_startup():\n    target = Target("xxxx", scope=SupportScope.qq_client)\n    await UniMessage("Hello!").send(target=target)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u81EA\u5B9A\u4E49\u6D88\u606F\u6BB5",children:"\u81EA\u5B9A\u4E49\u6D88\u606F\u6BB5"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"uniseg"})," \u63D0\u4F9B\u4E86\u90E8\u5206\u65B9\u6CD5\u6765\u5141\u8BB8\u7528\u6237\u81EA\u5B9A\u4E49 Segment \u7684\u5E8F\u5217\u5316\u548C\u53CD\u5E8F\u5217\u5316\uFF1A"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from dataclasses import dataclass\n\nfrom nonebot.adapters import Bot\nfrom nonebot.adapters import MessageSegment as BaseMessageSegment\nfrom nonebot.adapters.satori import Custom, Message, MessageSegment\n\nfrom nonebot_plugin_alconna.uniseg.builder import MessageBuilder\nfrom nonebot_plugin_alconna.uniseg.exporter import MessageExporter\nfrom nonebot_plugin_alconna.uniseg import Segment, custom_handler, custom_register\n\n\n@dataclass\nclass MarketFace(Segment):\n    tabId: str\n    faceId: str\n    key: str\n\n\n@custom_register(MarketFace, "chronocat:marketface")\ndef mfbuild(builder: MessageBuilder, seg: BaseMessageSegment):\n    if not isinstance(seg, Custom):\n        raise ValueError("MarketFace can only be built from Satori Message")\n    return MarketFace(**seg.data)(*builder.generate(seg.children))\n\n\n@custom_handler(MarketFace)\nasync def mfexport(exporter: MessageExporter, seg: MarketFace, bot: Bot, fallback: bool):\n    if exporter.get_message_type() is Message:\n        return MessageSegment("chronocat:marketface", seg.data)(await exporter.export(seg.children, bot, fallback))\n\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u5177\u4F53\u800C\u8A00\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"custom_register"})," \u6765\u589E\u52A0\u4E00\u4E2A\u4ECE MessageSegment \u5230 Segment \u7684\u5904\u7406\u65B9\u6CD5\uFF1B\u4F7F\u7528 ",(0,a.jsx)(n.code,{children:"custom_handler"})," \u6765\u589E\u52A0\u4E00\u4E2A\u4ECE Segment \u5230 MessageSegment \u7684\u5904\u7406\u65B9\u6CD5\u3002"]})]})}function x(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},80981:function(e,n,s){s.d(n,{Z:function(){return r}});var t=s(24246);s(27378);var a=s(90496);function r(e){let{children:n,hidden:s,className:r}=e;return(0,t.jsx)("div",{role:"tabpanel",className:(0,a.Z)("tab-panel",r),hidden:s,children:n})}},75037:function(e,n,s){s.d(n,{Z:()=>j});var t=s("24246"),a=s("27378"),r=s("90496"),i=s("85403"),l=s("3620"),o=s("77090"),c=s("76180"),d=s("23418"),g=s("19073");function h(e){let{value:n,tabValues:s}=e;return s.some(e=>e.value===n)}var x=s("3344");function p(e){let{className:n,selectedValue:s,selectValue:a,tabValues:l}=e,o=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{let n=e.currentTarget,t=l[o.indexOf(n)].value;t!==s&&(c(n),a(t))},g=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{let s=o.indexOf(e.currentTarget)+1;n=o[s]??o[0];break}case"ArrowLeft":{let s=o.indexOf(e.currentTarget)-1;n=o[s]??o[o.length-1]}}n?.focus()};return(0,t.jsx)("div",{className:"not-prose",children:(0,t.jsxs)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs tabs-list",n),children:[l.map(e=>{let{value:n,label:a,attributes:i}=e;return(0,t.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>{o.push(e)},onKeyDown:g,onClick:d,...i,className:(0,r.Z)("tab tab-lifted tab-item",i?.className,s===n&&"tab-active tab-item-active"),children:a??n},n)}),(0,t.jsx)("div",{className:"tab tab-lifted tab-item tab-spacer"})]})})}function u(e){let{lazy:n,children:s,selectedValue:r}=e,i=(Array.isArray(s)?s:[s]).filter(Boolean);if(n){let e=i.find(e=>e.props.value===r);return e?(0,t.jsx)("div",{children:(0,a.cloneElement)(e)}):null}return(0,t.jsx)("div",{children:i.map((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==r}))})}function m(e){let n=function(e){let{defaultValue:n,queryString:s=!1,groupId:t}=e,r=function(e){let{values:n,children:s}=e;return(0,a.useMemo)(()=>{let e=n??(a.Children.toArray(s).filter(e=>"\n"!==e).map(e=>{if(!e||a.isValidElement(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]).map(e=>{let{props:{value:n,label:s,attributes:t,default:a}}=e;return{value:n,label:s,attributes:t,default:a}});return!function(e){let n=(0,d.lx)(e,(e,n)=>e.value===n.value);if(n.length>0)throw Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}(e),[i,x]=(0,a.useState)(()=>(function(e){let{defaultValue:n,tabValues:s}=e;if(0===s.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:s}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${s.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}let t=s.find(e=>e.default)??s[0];if(!t)throw Error("Unexpected error: 0 tabValues");return t.value})({defaultValue:n,tabValues:r})),[p,u]=function(e){let{queryString:n=!1,groupId:s}=e,t=(0,l.k6)(),r=function(e){let{queryString:n=!1,groupId:s}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!s)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:n,groupId:s});return[(0,c._X)(r),(0,a.useCallback)(e=>{if(!r)return;let n=new URLSearchParams(t.location.search);n.set(r,e),t.replace({...t.location,search:n.toString()})},[r,t])]}({queryString:s,groupId:t}),[m,j]=function(e){let{groupId:n}=e,s=n?`docusaurus.tab.${n}`:null,[t,r]=(0,g.Nk)(s);return[t,(0,a.useCallback)(e=>{s&&r.set(e)},[s,r])]}({groupId:t}),f=(()=>{let e=p??m;return h({value:e,tabValues:r})?e:null})();return(0,o.Z)(()=>{f&&x(f)},[f]),{selectedValue:i,selectValue:(0,a.useCallback)(e=>{if(!h({value:e,tabValues:r}))throw Error(`Can't select invalid tab value=${e}`);x(e),u(e),j(e)},[u,j,r]),tabValues:r}}(e);return(0,t.jsxs)("div",{className:"tabs-container",children:[(0,t.jsx)(p,{...e,...n}),(0,t.jsx)(u,{...e,...n})]})}function j(e){let n=(0,x.Z)();return(0,t.jsx)(m,{...e},String(n))}},80980:function(e,n,s){s.d(n,{Z:function(){return l},a:function(){return i}});var t=s(27378);let a={},r=t.createContext(a);function i(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);