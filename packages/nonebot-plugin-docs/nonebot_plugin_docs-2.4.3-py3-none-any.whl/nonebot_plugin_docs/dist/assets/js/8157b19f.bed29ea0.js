"use strict";(self.webpackChunknonebot=self.webpackChunknonebot||[]).push([["2638"],{79228:function(e,n,s){s.r(n),s.d(n,{default:()=>x,frontMatter:()=>c,metadata:()=>t,assets:()=>d,toc:()=>l,contentTitle:()=>a});var t=JSON.parse('{"id":"tutorial/handler","title":"\u4E8B\u4EF6\u5904\u7406","description":"\u5904\u7406\u63A5\u6536\u5230\u7684\u7279\u5B9A\u4E8B\u4EF6","source":"@site/versioned_docs/version-2.4.3/tutorial/handler.mdx","sourceDirName":"tutorial","slug":"/tutorial/handler","permalink":"/website/docs/tutorial/handler","draft":false,"unlisted":false,"editUrl":"https://github.com/nonebot/nonebot2/edit/master/website/versioned_docs/version-2.4.3/tutorial/handler.mdx","tags":[],"version":"2.4.3","lastUpdatedBy":"noneflow[bot]","lastUpdatedAt":1754561629000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"description":"\u5904\u7406\u63A5\u6536\u5230\u7684\u7279\u5B9A\u4E8B\u4EF6","options":{"menu":[{"category":"tutorial","weight":70}]}},"sidebar":"tutorial","previous":{"title":"\u4E8B\u4EF6\u54CD\u5E94\u5668","permalink":"/website/docs/tutorial/matcher"},"next":{"title":"\u83B7\u53D6\u4E8B\u4EF6\u4FE1\u606F","permalink":"/website/docs/tutorial/event-data"}}'),i=s("24246"),r=s("80980"),o=s("70203");let c={sidebar_position:5,description:"\u5904\u7406\u63A5\u6536\u5230\u7684\u7279\u5B9A\u4E8B\u4EF6",options:{menu:[{category:"tutorial",weight:70}]}},a="\u4E8B\u4EF6\u5904\u7406",d={},l=[{value:"\u8BA4\u8BC6\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B",id:"\u8BA4\u8BC6\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B",level:2},{value:"\u4E8B\u4EF6\u5904\u7406\u51FD\u6570",id:"\u4E8B\u4EF6\u5904\u7406\u51FD\u6570",level:2},{value:"\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C",id:"\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u4E8B\u4EF6\u5904\u7406",children:"\u4E8B\u4EF6\u5904\u7406"})}),"\n","\n",(0,i.jsxs)(n.p,{children:["\u5728\u6211\u4EEC\u6536\u5230\u4E8B\u4EF6\uFF0C\u5E76\u88AB\u67D0\u4E2A\u4E8B\u4EF6\u54CD\u5E94\u5668\u6B63\u786E\u54CD\u5E94\u540E\uFF0C\u4FBF\u6B63\u5F0F\u5F00\u542F\u4E86\u5BF9\u4E8E\u8FD9\u4E2A\u4E8B\u4EF6\u7684",(0,i.jsx)(n.strong,{children:"\u5904\u7406\u6D41\u7A0B"}),"\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u8BA4\u8BC6\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B",children:"\u8BA4\u8BC6\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B"}),"\n",(0,i.jsxs)(n.p,{children:["\u5C31\u50CF\u6211\u4EEC\u5728\u89E3\u51B3\u95EE\u9898\u65F6\u9700\u8981\u9075\u5FAA\u6D41\u7A0B\u4E00\u6837\uFF0C\u5904\u7406\u4E00\u4E2A\u4E8B\u4EF6\u4E5F\u9700\u8981\u4E00\u5957\u6D41\u7A0B\u3002\u5728\u4E8B\u4EF6\u54CD\u5E94\u5668\u5BF9\u4E00\u4E2A\u4E8B\u4EF6\u8FDB\u884C\u54CD\u5E94\u4E4B\u540E\uFF0C\u4F1A\u4F9D\u6B21\u6267\u884C\u4E00\u7CFB\u5217\u7684",(0,i.jsx)(n.strong,{children:"\u4E8B\u4EF6\u5904\u7406\u4F9D\u8D56"}),"\uFF08\u901A\u5E38\u662F\u51FD\u6570\uFF09\u3002\u7B80\u5355\u6765\u8BF4\uFF0C\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u5E76\u4E0D\u662F\u4E00\u4E2A\u51FD\u6570\u3001\u4E00\u4E2A\u5BF9\u8C61\u6216\u4E00\u4E2A\u65B9\u6CD5\uFF0C\u800C\u662F\u4E00\u6574\u5957\u7531\u5F00\u53D1\u8005\u8BBE\u8BA1\u7684\u6D41\u7A0B\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u8FD9\u4E2A\u6D41\u7A0B\u4E2D\uFF0C\u6211\u4EEC",(0,i.jsx)(n.strong,{children:"\u76EE\u524D"}),"\u53EA\u9700\u8981\u4E86\u89E3\u4E24\u4E2A\u6982\u5FF5\uFF1A\u51FD\u6570\u5F62\u5F0F\u7684\u201C\u4E8B\u4EF6\u5904\u7406\u4F9D\u8D56\u201D\uFF08\u4E0B\u79F0\u201C\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u201D\uFF09\u548C\u201C\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u201D\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u4E8B\u4EF6\u5904\u7406\u51FD\u6570",children:"\u4E8B\u4EF6\u5904\u7406\u51FD\u6570"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u4E8B\u4EF6\u54CD\u5E94\u5668\u4E2D\uFF0C\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u53EF\u4EE5\u7531\u4E00\u4E2A\u6216\u591A\u4E2A\u201C\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u201D\u7EC4\u6210\uFF0C\u8FD9\u4E9B\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u5C06\u4F1A\u6309\u7167\u987A\u5E8F\u4F9D\u6B21\u5BF9\u4E8B\u4EF6\u8FDB\u884C\u5904\u7406\uFF0C\u76F4\u5230\u5168\u90E8\u6267\u884C\u5B8C\u6210\u6216\u88AB\u4E2D\u65AD\u3002\u6211\u4EEC\u53EF\u4EE5\u91C7\u7528\u4E8B\u4EF6\u54CD\u5E94\u5668\u7684\u201C\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u88C5\u9970\u5668\u201D\u6765\u6DFB\u52A0\u8FD9\u4E9B\u201C\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u201D\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u987E\u540D\u601D\u4E49\uFF0C\u201C\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u88C5\u9970\u5668\u201D\u662F\u4E00\u4E2A",(0,i.jsx)(n.a,{href:"https://docs.python.org/zh-cn/3/glossary.html#term-decorator",children:"\u88C5\u9970\u5668\uFF08decorator\uFF09"}),"\uFF0C\u90A3\u4E48\u5B83\u7684\u4F7F\u7528\u65B9\u6CD5\u4E5F\u540C",(0,i.jsx)(n.a,{href:"https://docs.python.org/zh-cn/3/reference/compound_stmts.html#function-definitions",children:"\u51FD\u6570\u5B9A\u4E49"}),"\u4E2D\u6240\u5C55\u793A\u7684\u5305\u88C5\u7528\u6CD5\u76F8\u540C\u3002\u4F8B\u5982\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{6-8} title=weather/__init__.py",children:'from nonebot.rule import to_me\nfrom nonebot.plugin import on_command\n\nweather = on_command("\u5929\u6C14", rule=to_me(), aliases={"weather", "\u67E5\u5929\u6C14"}, priority=10, block=True)\n\n@weather.handle()\nasync def handle_function():\n    pass  # do something here\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u4E0A\u65B9\u793A\u4F8B\u6240\u793A\uFF0C\u6211\u4EEC\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"weather"})," \u54CD\u5E94\u5668\u7684 ",(0,i.jsx)(n.code,{children:"handle"})," \u88C5\u9970\u5668\u88C5\u9970\u4E86\u4E00\u4E2A\u51FD\u6570 ",(0,i.jsx)(n.code,{children:"handle_function"}),"\u3002",(0,i.jsx)(n.code,{children:"handle_function"})," \u51FD\u6570\u4F1A\u88AB\u6DFB\u52A0\u5230 ",(0,i.jsx)(n.code,{children:"weather"})," \u7684\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u4E2D\u3002\u5728 ",(0,i.jsx)(n.code,{children:"weather"})," \u54CD\u5E94\u5668\u88AB\u89E6\u53D1\u4E4B\u540E\uFF0C\u5C06\u4F1A\u4F9D\u6B21\u8C03\u7528 ",(0,i.jsx)(n.code,{children:"weather"})," \u54CD\u5E94\u5668\u7684\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\uFF0C\u5373 ",(0,i.jsx)(n.code,{children:"handle_function"})," \u6765\u5BF9\u4E8B\u4EF6\u8FDB\u884C\u5904\u7406\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C",children:"\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u6765\u8FDB\u884C\u4E00\u4E9B\u4EA4\u4E92\u6216\u6539\u53D8\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\uFF0C\u4F8B\u5982\u5411\u673A\u5668\u4EBA\u7528\u6237\u53D1\u9001\u6D88\u606F\u6216\u63D0\u524D\u7ED3\u675F\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u7B49\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u4E0E\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u88C5\u9970\u5668\u7C7B\u4F3C\uFF0C\u901A\u5E38\u4F5C\u4E3A\u4E8B\u4EF6\u54CD\u5E94\u5668 ",(0,i.jsx)(n.code,{children:"Matcher"})," \u7684",(0,i.jsx)(n.a,{href:"https://docs.python.org/zh-cn/3/library/functions.html#classmethod",children:"\u7C7B\u65B9\u6CD5"}),"\u5B58\u5728\uFF0C\u56E0\u6B64\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u7684\u8C03\u7528\u65B9\u6CD5\u4E5F\u662F ",(0,i.jsx)(n.code,{children:"Matcher.func()"})," \u7684\u5F62\u5F0F\u3002\u4E0D\u8FC7\u4E0D\u540C\u7684\u662F\uFF0C\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u5E76\u4E0D\u662F\u88C5\u9970\u5668\uFF0C\u56E0\u6B64\u5E76\u4E0D\u9700\u8981@\u8FDB\u884C\u6807\u6CE8\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{8,9} title=weather/__init__.py",children:'from nonebot.rule import to_me\nfrom nonebot.plugin import on_command\n\nweather = on_command("\u5929\u6C14", rule=to_me(), aliases={"weather", "\u67E5\u5929\u6C14"}, priority=10, block=True)\n\n@weather.handle()\nasync def handle_function():\n    # await weather.send("\u5929\u6C14\u662F...")\n    await weather.finish("\u5929\u6C14\u662F...")\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u4E0A\u65B9\u793A\u4F8B\u6240\u793A\uFF0C\u6211\u4EEC\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"weather"})," \u54CD\u5E94\u5668\u7684 ",(0,i.jsx)(n.code,{children:"finish"})," \u64CD\u4F5C\u65B9\u6CD5\u5411\u673A\u5668\u4EBA\u7528\u6237\u56DE\u590D\u4E86 ",(0,i.jsx)(n.code,{children:"\u5929\u6C14\u662F..."})," \u5E76\u7ED3\u675F\u4E86\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u3002\u6548\u679C\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(o.Z,{msgs:[{position:"right",msg:"/\u5929\u6C14"},{position:"left",msg:"\u5929\u6C14\u662F..."}]}),"\n",(0,i.jsxs)(n.p,{children:["\u503C\u5F97\u6CE8\u610F\u7684\u662F\uFF0C\u5728\u6267\u884C ",(0,i.jsx)(n.code,{children:"finish"})," \u65B9\u6CD5\u65F6\uFF0CNoneBot \u4F1A\u5728\u5411\u673A\u5668\u4EBA\u7528\u6237\u53D1\u9001\u6D88\u606F\u5185\u5BB9\u540E\u629B\u51FA ",(0,i.jsx)(n.code,{children:"FinishedException"})," \u5F02\u5E38\u6765\u7ED3\u675F\u4E8B\u4EF6\u54CD\u5E94\u6D41\u7A0B\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5728 ",(0,i.jsx)(n.code,{children:"finish"})," \u88AB\u6267\u884C\u540E\uFF0C\u540E\u7EED\u7684\u7A0B\u5E8F\u662F\u4E0D\u4F1A\u88AB\u6267\u884C\u7684\u3002\u5982\u679C\u4F60\u9700\u8981\u56DE\u590D\u673A\u5668\u4EBA\u7528\u6237\u6D88\u606F\u4F46\u4E0D\u60F3\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u7ED3\u675F\uFF0C\u53EF\u4EE5\u4F7F\u7528\u6CE8\u91CA\u7684\u90E8\u5206\u4E2D\u5C55\u793A\u7684 ",(0,i.jsx)(n.code,{children:"send"})," \u65B9\u6CD5\u3002"]}),"\n",(0,i.jsxs)(n.admonition,{title:"\u8B66\u544A",type:"danger",children:[(0,i.jsxs)(n.p,{children:["\u7531\u4E8E ",(0,i.jsx)(n.code,{children:"finish"})," \u662F\u901A\u8FC7\u629B\u51FA ",(0,i.jsx)(n.code,{children:"FinishedException"})," \u5F02\u5E38\u6765\u7ED3\u675F\u4E8B\u4EF6\u7684\uFF0C\u56E0\u6B64\u5F02\u5E38\u53EF\u80FD\u4F1A\u88AB\u672A\u52A0\u9650\u5236\u7684 ",(0,i.jsx)(n.code,{children:"try-except"})," \u6355\u83B7\uFF0C\u5F71\u54CD\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u6B63\u786E\u5904\u7406\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u6B63\u5E38\u7ED3\u675F\u6B64\u4E8B\u4EF6\u3002\u8BF7\u52A1\u5FC5\u5728\u5F02\u5E38\u6355\u83B7\u4E2D\u6307\u5B9A\u9519\u8BEF\u7C7B\u578B\u6216\u6392\u9664\u6240\u6709 ",(0,i.jsx)(n.a,{href:"/website/docs/api/exception#MatcherException",children:"MatcherException"})," \u7C7B\u578B\u7684\u5F02\u5E38\uFF08\u5982\u4E0B\u6240\u793A\uFF09\uFF0C\u6216\u5C06 ",(0,i.jsx)(n.code,{children:"finish"})," \u79FB\u51FA\u6355\u83B7\u8303\u56F4\u8FDB\u884C\u4F7F\u7528\u3002"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from nonebot.exception import MatcherException\n\ntry:\n    await weather.finish("\u5929\u6C14\u662F...")\nexcept MatcherException:\n    raise\nexcept Exception as e:\n    pass # do something here\n'})})]}),"\n",(0,i.jsxs)(n.p,{children:["\u76EE\u524D NoneBot \u63D0\u4F9B\u4E86\u591A\u79CD\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\uFF0C\u5176\u4E2D\u5305\u62EC\u7528\u4E8E\u673A\u5668\u4EBA\u7528\u6237\u4EA4\u4E92\u4E0E\u6D41\u7A0B\u63A7\u5236\u4E24\u5927\u7C7B\uFF0C\u8FDB\u9636\u4F7F\u7528\u65B9\u6CD5\u53EF\u4EE5\u67E5\u770B",(0,i.jsx)(n.a,{href:"/website/docs/appendices/session-control",children:"\u4F1A\u8BDD\u63A7\u5236"}),"\u3002"]})]})}function x(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},70203:function(e,n,s){s.d(n,{Z:function(){return h}});var t=s(24246),i=s(27378),r=s(90496),o=s(70486),c=s(92739),a=s(85870),d=s(32896);function l(e){let{msg:n,position:s="left",monospace:i=!1}=e,{navbar:{logo:l}}=(0,a.Th)(),h={light:(0,o.ZP)(l.src),dark:(0,o.ZP)(l.srcDark||l.src)},x="right"===s;return(0,t.jsxs)("div",{className:(0,r.Z)("chat",x?"chat-end":"chat-start"),children:[(0,t.jsx)("div",{className:"chat-image avatar",children:(0,t.jsx)("div",{className:(0,r.Z)("messenger-chat-avatar",x&&"messenger-chat-avatar-user"),children:x?(0,t.jsx)(c.G,{icon:["fas","user"]}):(0,t.jsx)(d.Z,{sources:h})})}),(0,t.jsx)("div",{className:(0,r.Z)("chat-bubble messenger-chat-bubble",i&&"font-mono"),dangerouslySetInnerHTML:{__html:n.replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;")}})]})}function h(e){let{msgs:n=[]}=e;return(0,t.jsxs)("div",{className:"messenger-container",children:[(0,t.jsxs)("header",{className:"messenger-title",children:[(0,t.jsx)("div",{className:"messenger-title-back",children:(0,t.jsx)(c.G,{icon:["fas","chevron-left"]})}),(0,t.jsx)("div",{className:"messenger-title-name",children:(0,t.jsx)("span",{children:"NoneBot"})}),(0,t.jsx)("div",{className:"messenger-title-more",children:(0,t.jsx)(c.G,{icon:["fas","bars"]})})]}),(0,t.jsx)("div",{className:"messenger-chat",children:n.map((e,n)=>(0,i.createElement)(l,{...e,key:n}))}),(0,t.jsxs)("div",{className:"messenger-footer",children:[(0,t.jsxs)("div",{className:"messenger-footer-action",children:[(0,t.jsx)("div",{className:"messenger-footer-action-input",children:(0,t.jsx)("input",{className:"input input-xs input-bordered input-info w-full",readOnly:!0})}),(0,t.jsx)("div",{className:"messenger-footer-action-send",children:(0,t.jsx)("button",{className:"btn btn-xs btn-info no-animation text-white",children:"\u53D1\u9001"})})]}),(0,t.jsxs)("div",{className:"messenger-footer-tools",children:[(0,t.jsx)("div",{children:(0,t.jsx)(c.G,{icon:["fas","microphone"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(c.G,{icon:["fas","image"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(c.G,{icon:["fas","camera"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(c.G,{icon:["fas","wallet"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(c.G,{icon:["fas","smile-wink"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(c.G,{icon:["fas","plus-circle"]})})]})]})]})}},80980:function(e,n,s){s.d(n,{Z:function(){return c},a:function(){return o}});var t=s(27378);let i={},r=t.createContext(i);function o(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);