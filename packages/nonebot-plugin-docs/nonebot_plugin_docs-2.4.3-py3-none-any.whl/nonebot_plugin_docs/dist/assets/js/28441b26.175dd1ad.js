"use strict";(self.webpackChunknonebot=self.webpackChunknonebot||[]).push([["8401"],{24273:function(n,e,s){s.r(e),s.d(e,{default:()=>p,frontMatter:()=>a,metadata:()=>i,assets:()=>o,toc:()=>d,contentTitle:()=>l});var i=JSON.parse('{"id":"best-practice/alconna/matcher","title":"Alconna \u63D2\u4EF6","description":"\u54CD\u5E94\u89C4\u5219\u7684\u4F7F\u7528","source":"@site/versioned_docs/version-2.4.2/best-practice/alconna/matcher.mdx","sourceDirName":"best-practice/alconna","slug":"/best-practice/alconna/matcher","permalink":"/website/docs/2.4.2/best-practice/alconna/matcher","draft":false,"unlisted":false,"editUrl":"https://github.com/nonebot/nonebot2/edit/master/website/versioned_docs/version-2.4.2/best-practice/alconna/matcher.mdx","tags":[],"version":"2.4.2","lastUpdatedBy":"noneflow[bot]","lastUpdatedAt":1754561629000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"description":"\u54CD\u5E94\u89C4\u5219\u7684\u4F7F\u7528"},"sidebar":"tutorial","previous":{"title":"Alconna \u672C\u4F53","permalink":"/website/docs/2.4.2/best-practice/alconna/command"},"next":{"title":"\u914D\u7F6E\u9879","permalink":"/website/docs/2.4.2/best-practice/alconna/config"}}'),c=s("24246"),t=s("80980"),r=s("70203");let a={sidebar_position:3,description:"\u54CD\u5E94\u89C4\u5219\u7684\u4F7F\u7528"},l="Alconna \u63D2\u4EF6",o={},d=[{value:"\u54CD\u5E94\u5668\u4F7F\u7528",id:"\u54CD\u5E94\u5668\u4F7F\u7528",level:2},{value:"\u4F9D\u8D56\u6CE8\u5165",id:"\u4F9D\u8D56\u6CE8\u5165",level:2},{value:"\u591A\u5E73\u53F0\u9002\u914D",id:"\u591A\u5E73\u53F0\u9002\u914D",level:2},{value:"\u6761\u4EF6\u63A7\u5236",id:"\u6761\u4EF6\u63A7\u5236",level:2},{value:"\u54CD\u5E94\u5668\u521B\u5EFA\u88C5\u9970",id:"\u54CD\u5E94\u5668\u521B\u5EFA\u88C5\u9970",level:2},{value:"\u7C7BKoishi\u6784\u9020\u5668",id:"\u7C7Bkoishi\u6784\u9020\u5668",level:2},{value:"\u8FD4\u56DE\u503C\u4E2D\u95F4\u4EF6",id:"\u8FD4\u56DE\u503C\u4E2D\u95F4\u4EF6",level:2},{value:"\u5339\u914D\u62D3\u5C55",id:"\u5339\u914D\u62D3\u5C55",level:2},{value:"\u8865\u5168\u4F1A\u8BDD",id:"\u8865\u5168\u4F1A\u8BDD",level:2},{value:"\u5185\u7F6E\u63D2\u4EF6",id:"\u5185\u7F6E\u63D2\u4EF6",level:2}];function h(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"alconna-\u63D2\u4EF6",children:"Alconna \u63D2\u4EF6"})}),"\n",(0,c.jsx)(e.p,{children:"\u5C55\u793A\uFF1A"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import At, Image, on_alconna\nfrom arclet.alconna import Args, Option, Alconna, Arparma, MultiVar, Subcommand\n\n\nalc = Alconna(\n    ["/", "!"],\n    "role-group",\n    Subcommand(\n        "add",\n        Args["name", str],\n        Option("member", Args["target", MultiVar(At)]),\n    ),\n    Option("list"),\n    Option("icon", Args["icon", Image])\n)\nrg = on_alconna(alc, auto_send_output=True)\n\n\n@rg.handle()\nasync def _(result: Arparma):\n    if result.find("list"):\n        img: bytes = await gen_role_group_list_image()\n        await rg.finish(Image(raw=img))\n    if result.find("add"):\n        group = await create_role_group(result.query[str]("add.name"))\n        if result.find("add.member"):\n            ats = result.query[tuple[At, ...]]("add.member.target")\n            group.extend(member.target for member in ats)\n        await rg.finish("\u6DFB\u52A0\u6210\u529F")\n'})}),"\n",(0,c.jsx)(e.h2,{id:"\u54CD\u5E94\u5668\u4F7F\u7528",children:"\u54CD\u5E94\u5668\u4F7F\u7528"}),"\n",(0,c.jsxs)(e.p,{children:["\u672C\u63D2\u4EF6\u57FA\u4E8E ",(0,c.jsx)(e.strong,{children:"Alconna"}),"\uFF0C\u4E3A ",(0,c.jsx)(e.strong,{children:"Nonebot"})," \u63D0\u4F9B\u4E86\u4E00\u7C7B\u65B0\u7684\u4E8B\u4EF6\u54CD\u5E94\u5668\u8F85\u52A9\u51FD\u6570 ",(0,c.jsx)(e.code,{children:"on_alconna"}),"\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"def on_alconna(\n    command: Alconna | str,\n    skip_for_unmatch: bool = True,\n    auto_send_output: bool = False,\n    aliases: set[str | tuple[str, ...]] | None = None,\n    comp_config: CompConfig | None = None,\n    extensions: list[type[Extension] | Extension] | None = None,\n    exclude_ext: list[type[Extension] | str] | None = None,\n    use_origin: bool = False,\n    use_cmd_start: bool = False,\n    use_cmd_sep: bool = False,\n    **kwargs,\n    ...,\n):\n"})}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"command"}),": Alconna \u547D\u4EE4\u6216\u5B57\u7B26\u4E32\uFF0C\u5B57\u7B26\u4E32\u5C06\u901A\u8FC7 ",(0,c.jsx)(e.code,{children:"AlconnaFormat"})," \u8F6C\u6362\u4E3A Alconna \u547D\u4EE4"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"skip_for_unmatch"}),": \u662F\u5426\u5728\u547D\u4EE4\u4E0D\u5339\u914D\u65F6\u8DF3\u8FC7\u8BE5\u54CD\u5E94"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"auto_send_output"}),": \u662F\u5426\u81EA\u52A8\u53D1\u9001\u8F93\u51FA\u4FE1\u606F\u5E76\u8DF3\u8FC7\u54CD\u5E94"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"aliases"}),": \u547D\u4EE4\u522B\u540D\uFF0C \u4F5C\u7528\u7C7B\u4F3C\u4E8E ",(0,c.jsx)(e.code,{children:"on_command"})," \u4E2D\u7684 aliases"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"comp_config"}),": \u8865\u5168\u4F1A\u8BDD\u914D\u7F6E\uFF0C \u4E0D\u4F20\u5165\u5219\u4E0D\u542F\u7528\u8865\u5168\u4F1A\u8BDD"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"extensions"}),": \u9700\u8981\u52A0\u8F7D\u7684\u5339\u914D\u6269\u5C55, \u53EF\u4EE5\u662F\u6269\u5C55\u7C7B\u6216\u6269\u5C55\u5B9E\u4F8B"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"exclude_ext"}),": \u9700\u8981\u6392\u9664\u7684\u5339\u914D\u6269\u5C55, \u53EF\u4EE5\u662F\u6269\u5C55\u7C7B\u6216\u6269\u5C55\u7684id"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"use_origin"}),": \u662F\u5426\u4F7F\u7528\u672A\u7ECF to_me \u7B49\u5904\u7406\u8FC7\u7684\u6D88\u606F"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"use_cmd_start"}),": \u662F\u5426\u4F7F\u7528 COMMAND_START \u4F5C\u4E3A\u547D\u4EE4\u524D\u7F00"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"use_cmd_sep"}),": \u662F\u5426\u4F7F\u7528 COMMAND_SEP \u4F5C\u4E3A\u547D\u4EE4\u5206\u9694\u7B26"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"on_alconna"})," \u8FD4\u56DE\u7684\u662F ",(0,c.jsx)(e.code,{children:"Matcher"})," \u7684\u5B50\u7C7B ",(0,c.jsx)(e.code,{children:"AlconnaMatcher"})," \uFF0C\u5176\u62D3\u5C55\u4E86\u5982\u4E0B\u65B9\u6CD5\uFF1A"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:".assign(path, value, or_not)"}),": \u7528\u4E8E\u5BF9\u5305\u542B\u591A\u4E2A\u9009\u9879/\u5B50\u547D\u4EE4\u7684\u547D\u4EE4\u7684\u5206\u6D3E\u5904\u7406\uFF08\u5177\u4F53\u8BF7\u770B",(0,c.jsx)(e.a,{href:"/website/docs/2.4.2/best-practice/alconna/matcher#%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6",children:"\u6761\u4EF6\u63A7\u5236"}),"\uFF09"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:".got_path(path, prompt, middleware)"}),": \u5728 ",(0,c.jsx)(e.code,{children:"got"})," \u65B9\u6CD5\u7684\u57FA\u7840\u4E0A\uFF0C\u4F1A\u4EE5 path \u5BF9\u5E94\u7684\u53C2\u6570\u4E3A\u51C6\uFF0C\u8BFB\u53D6\u4F20\u5165 message \u7684\u6700\u540E\u4E00\u4E2A\u6D88\u606F\u6BB5\u5E76\u9A8C\u8BC1\u8F6C\u6362"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:".set_path_arg(key, value)"}),", ",(0,c.jsx)(e.code,{children:".get_path_arg(key)"}),": \u7C7B\u4F3C ",(0,c.jsx)(e.code,{children:"set_arg"})," \u548C ",(0,c.jsx)(e.code,{children:"got_arg"}),"\uFF0C\u4E3A ",(0,c.jsx)(e.code,{children:"got_path"})," \u7684\u7279\u5316\u7248\u672C"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:".reject_path(path[, prompt, fallback])"}),": \u7C7B\u4F3C\u4E8E ",(0,c.jsx)(e.code,{children:"reject_arg"}),"\uFF0C\u5BF9\u5E94 ",(0,c.jsx)(e.code,{children:"got_path"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:".dispatch"}),": \u540C\u6837\u7684\u5206\u6D3E\u5904\u7406\uFF0C\u4F46\u662F\u662F\u7C7B\u4F3C ",(0,c.jsx)(e.code,{children:"CommandGroup"})," \u4E00\u6837\u8FD4\u56DE\u65B0\u7684 ",(0,c.jsx)(e.code,{children:"AlconnaMatcher"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:".got"}),", ",(0,c.jsx)(e.code,{children:"send"}),", ",(0,c.jsx)(e.code,{children:"reject"}),", ... : \u62D3\u5C55\u4E86 prompt \u7C7B\u578B\uFF0C\u5373\u652F\u6301\u4F7F\u7528 ",(0,c.jsx)(e.code,{children:"UniMessage"})," \u4F5C\u4E3A prompt"]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u5B9E\u4F8B\uFF1A"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot import require\nrequire("nonebot_plugin_alconna")\n\nfrom arclet.alconna import Alconna, Option, Args\nfrom nonebot_plugin_alconna import on_alconna, Match, UniMessage\n\n\nlogin = on_alconna(Alconna(["/"], "login", Args["password?", str], Option("-r|--recall"))) # \u8FD9\u91CC["/"]\u6307\u547D\u4EE4\u524D\u7F00\u5FC5\u987B\u662F/\n\n# /login -r \u89E6\u53D1\n@login.assign("recall")\nasync def login_exit():\n    await login.finish("\u5DF2\u9000\u51FA")\n\n# /login xxx \u89E6\u53D1\n@login.assign("password")\nasync def login_handle(pw: Match[str]):\n    if pw.available:\n        login.set_path_arg("password", pw.result)\n\n# /login \u89E6\u53D1\n@login.got_path("password", prompt=UniMessage.template("{:At(user, $event.get_user_id())} \u8BF7\u8F93\u5165\u5BC6\u7801"))\nasync def login_got(password: str):\n	assert password\n	await login.send("\u767B\u5F55\u6210\u529F")\n'})}),"\n",(0,c.jsx)(e.h2,{id:"\u4F9D\u8D56\u6CE8\u5165",children:"\u4F9D\u8D56\u6CE8\u5165"}),"\n",(0,c.jsx)(e.p,{children:"\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u4E00\u7CFB\u5217\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570\uFF0C\u4FBF\u4E8E\u5728\u54CD\u5E94\u51FD\u6570\u4E2D\u83B7\u53D6\u89E3\u6790\u7ED3\u679C\uFF1A"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaResult"}),": ",(0,c.jsx)(e.code,{children:"CommandResult"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaMatches"}),": ",(0,c.jsx)(e.code,{children:"Arparma"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaDuplication"}),": ",(0,c.jsx)(e.code,{children:"Duplication"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaMatch"}),": ",(0,c.jsx)(e.code,{children:"Match"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaQuery"}),": ",(0,c.jsx)(e.code,{children:"Query"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["\u540C\u65F6\uFF0C\u57FA\u4E8E ",(0,c.jsxs)(e.a,{href:"https://github.com/nonebot/nonebot2/pull/1832",children:[(0,c.jsx)(e.code,{children:"Annotated"})," \u652F\u6301"]}),"\uFF0C\u6DFB\u52A0\u4E86\u4E24\u7C7B\u6CE8\u89E3\uFF1A"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlcMatches"}),"\uFF1A\u540C ",(0,c.jsx)(e.code,{children:"AlconnaMatches"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlcResult"}),"\uFF1A\u540C ",(0,c.jsx)(e.code,{children:"AlconnaResult"})]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u53EF\u4EE5\u770B\u5230\uFF0C\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u51E0\u7C7B\u989D\u5916\u7684\u6A21\u578B\uFF1A"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"CommandResult"}),": \u89E3\u6790\u7ED3\u679C\uFF0C\u5305\u62EC\u4E86\u6E90\u547D\u4EE4 ",(0,c.jsx)(e.code,{children:"source: Alconna"})," \uFF0C\u89E3\u6790\u7ED3\u679C ",(0,c.jsx)(e.code,{children:"result: Arparma"}),"\uFF0C\u4EE5\u53CA\u53EF\u80FD\u7684\u8F93\u51FA\u4FE1\u606F ",(0,c.jsx)(e.code,{children:"output: str | None"})," \u5B57\u6BB5"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"Match"}),": \u5339\u914D\u9879\uFF0C\u8868\u793A\u53C2\u6570\u662F\u5426\u5B58\u5728\u4E8E ",(0,c.jsx)(e.code,{children:"all_matched_args"})," \u5185\uFF0C\u53EF\u7528 ",(0,c.jsx)(e.code,{children:"Match.available"})," \u5224\u65AD\u662F\u5426\u5339\u914D\uFF0C",(0,c.jsx)(e.code,{children:"Match.result"})," \u83B7\u53D6\u5339\u914D\u7684\u503C"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"Query"}),": \u67E5\u8BE2\u9879\uFF0C\u8868\u793A\u53C2\u6570\u662F\u5426\u53EF\u7531 ",(0,c.jsx)(e.code,{children:"Arparma.query"})," \u67E5\u8BE2\u5E76\u83B7\u5F97\u7ED3\u679C\uFF0C\u53EF\u7528 ",(0,c.jsx)(e.code,{children:"Query.available"})," \u5224\u65AD\u662F\u5426\u67E5\u8BE2\u6210\u529F\uFF0C",(0,c.jsx)(e.code,{children:"Query.result"})," \u83B7\u53D6\u67E5\u8BE2\u7ED3\u679C"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"Alconna"})," \u9ED8\u8BA4\u4F9D\u8D56\u6CE8\u5165\u7684\u76EE\u6807\u53C2\u6570\u7686\u4E0D\u9700\u8981\u4F7F\u7528\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570\uFF0C \u8BE5\u6548\u679C\u5BF9\u4E8E ",(0,c.jsx)(e.code,{children:"AlconnaMatcher.got_path"})," \u4E0B\u7684 Arg \u540C\u6837\u6709\u6548\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'async def handle(\n    result: CommandResult,\n    arp: Arparma,\n    dup: Duplication,\n    source: Alconna,\n    abc: str,  # \u7C7B\u4F3C Match, \u4F46\u662F\u82E5\u5339\u914D\u7ED3\u679C\u4E0D\u5B58\u5728\u5BF9\u5E94\u5B57\u6BB5\u5219\u8DF3\u8FC7\u8BE5 handler\n    foo: Match[str],\n    bar: Query[int] = Query("ttt.bar", 0)  # Query \u4ECD\u7136\u9700\u8981\u4E00\u4E2A\u9ED8\u8BA4\u503C\u6765\u4F20\u9012 path \u53C2\u6570\n):\n    ...\n'})}),"\n",(0,c.jsxs)(e.admonition,{type:"note",children:[(0,c.jsxs)(e.p,{children:["\u5982\u679C\u4F60\u66F4\u559C\u6B22 Depends \u5F0F\u7684\u4F9D\u8D56\u6CE8\u5165\uFF0C",(0,c.jsx)(e.code,{children:"nonebot_plugin_alconna"})," \u540C\u65F6\u63D0\u4F9B\u4E86\u4E00\u7CFB\u5217\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570\uFF0C\u4ED6\u4EEC\u5305\u62EC\uFF1A"]}),(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaResult"}),": ",(0,c.jsx)(e.code,{children:"CommandResult"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaMatches"}),": ",(0,c.jsx)(e.code,{children:"Arparma"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaDuplication"}),": ",(0,c.jsx)(e.code,{children:"Duplication"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaMatch"}),": ",(0,c.jsx)(e.code,{children:"Match"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570\uFF0C\u5176\u80FD\u591F\u989D\u5916\u4F20\u5165\u4E00\u4E2A middleware \u51FD\u6570\u6765\u5904\u7406\u5F97\u5230\u7684\u53C2\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaQuery"}),": ",(0,c.jsx)(e.code,{children:"Query"})," \u7C7B\u578B\u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570\uFF0C\u5176\u80FD\u591F\u989D\u5916\u4F20\u5165\u4E00\u4E2A middleware \u51FD\u6570\u6765\u5904\u7406\u5F97\u5230\u7684\u53C2\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaExecResult"}),": \u63D0\u4F9B\u6302\u8F7D\u5728\u547D\u4EE4\u4E0A\u7684 callback \u7684\u8FD4\u56DE\u7ED3\u679C (",(0,c.jsx)(e.code,{children:"Dict[str, Any]"}),") \u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"AlconnaExtension"}),": \u63D0\u4F9B\u6307\u5B9A\u7C7B\u578B\u7684 ",(0,c.jsx)(e.code,{children:"Extension"})," \u7684\u4F9D\u8D56\u6CE8\u5165\u51FD\u6570"]}),"\n"]})]}),"\n",(0,c.jsx)(e.p,{children:"\u5B9E\u4F8B:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot import require\nrequire("nonebot_plugin_alconna")\n\nfrom nonebot_plugin_alconna import (\n    on_alconna,\n    Match,\n    Query,\n    AlconnaMatch,\n    AlcResult\n)\nfrom arclet.alconna import Alconna, Args, Option, Arparma\n\n\ntest = on_alconna(\n    Alconna(\n        "test",\n        Option("foo", Args["bar", int]),\n        Option("baz", Args["qux", bool, False])\n    ),\n    auto_send_output=True\n)\n\n@test.handle()\nasync def handle_test1(result: AlcResult):\n    await test.send(f"matched: {result.matched}")\n    await test.send(f"maybe output: {result.output}")\n\n@test.handle()\nasync def handle_test2(result: Arparma):\n    await test.send(f"head result: {result.header_result}")\n    await test.send(f"args: {result.all_matched_args}")\n\n@test.handle()\nasync def handle_test3(bar: Match[int] = AlconnaMatch("bar")):\n    if bar.available:\n        await test.send(f"foo={bar.result}")\n\n@test.handle()\nasync def handle_test4(qux: Query[bool] = Query("baz.qux", False)):\n    if qux.available:\n        await test.send(f"baz.qux={qux.result}")\n'})}),"\n",(0,c.jsx)(e.h2,{id:"\u591A\u5E73\u53F0\u9002\u914D",children:"\u591A\u5E73\u53F0\u9002\u914D"}),"\n",(0,c.jsx)(e.p,{children:"\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u901A\u7528\u6D88\u606F\u6BB5\u6807\u6CE8\uFF0C \u901A\u7528\u6D88\u606F\u6BB5\u5E8F\u5217\uFF0C \u4F7F\u63D2\u4EF6\u4F7F\u7528\u8005\u53EF\u4EE5\u5FFD\u7565\u5E73\u53F0\u4E4B\u95F4\u5B57\u6BB5\u7684\u5DEE\u5F02"}),"\n",(0,c.jsxs)(e.p,{children:["\u54CD\u5E94\u5668\u4F7F\u7528\u793A\u4F8B\u4E2D\u4F7F\u7528\u4E86\u6D88\u606F\u6BB5\u6807\u6CE8\uFF0C\u5176\u4E2D ",(0,c.jsx)(e.code,{children:"At"})," \u5C5E\u4E8E\u901A\u7528\u6807\u6CE8\uFF0C\u800C ",(0,c.jsx)(e.code,{children:"Image"})," \u5C5E\u4E8E ",(0,c.jsx)(e.code,{children:"onebot12"})," \u9002\u914D\u5668\u4E0B\u7684\u6807\u6CE8\u3002"]}),"\n",(0,c.jsxs)(e.p,{children:["\u5177\u4F53\u4ECB\u7ECD\u548C\u4F7F\u7528\u8BF7\u67E5\u770B ",(0,c.jsx)(e.a,{href:"/website/docs/2.4.2/best-practice/alconna/uniseg#%E9%80%9A%E7%94%A8%E6%B6%88%E6%81%AF%E6%AE%B5",children:"\u901A\u7528\u4FE1\u606F\u7EC4\u4EF6"})]}),"\n",(0,c.jsx)(e.p,{children:"\u672C\u63D2\u4EF6\u4E3A\u4EE5\u4E0B\u9002\u914D\u5668\u63D0\u4F9B\u4E86\u4E13\u95E8\u7684\u9002\u914D\u5668\u6807\u6CE8\uFF1A"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"\u534F\u8BAE\u540D\u79F0"}),(0,c.jsx)(e.th,{children:"\u8DEF\u5F84"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-onebot",children:"OneBot \u534F\u8BAE"})}),(0,c.jsx)(e.td,{children:"adapters.onebot11, adapters.onebot12"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-telegram",children:"Telegram"})}),(0,c.jsx)(e.td,{children:"adapters.telegram"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-feishu",children:"\u98DE\u4E66"})}),(0,c.jsx)(e.td,{children:"adapters.feishu"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-github",children:"GitHub"})}),(0,c.jsx)(e.td,{children:"adapters.github"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-qq",children:"QQ bot"})}),(0,c.jsx)(e.td,{children:"adapters.qq"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-ding",children:"\u9489\u9489"})}),(0,c.jsx)(e.td,{children:"adapters.ding"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-dodo",children:"Dodo"})}),(0,c.jsx)(e.td,{children:"adapters.dodo"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-console",children:"Console"})}),(0,c.jsx)(e.td,{children:"adapters.console"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/Tian-que/nonebot-adapter-kaiheila",children:"\u5F00\u9ED1\u5566"})}),(0,c.jsx)(e.td,{children:"adapters.kook"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/ieew/nonebot_adapter_mirai2",children:"Mirai"})}),(0,c.jsx)(e.td,{children:"adapters.mirai"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/JustUndertaker/adapter-ntchat",children:"Ntchat"})}),(0,c.jsx)(e.td,{children:"adapters.ntchat"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/17TheWord/nonebot-adapter-minecraft",children:"MineCraft"})}),(0,c.jsx)(e.td,{children:"adapters.minecraft"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/wwweww/adapter-bilibili",children:"BiliBili Live"})}),(0,c.jsx)(e.td,{children:"adapters.bilibili"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/onebot-walle/nonebot_adapter_walleq",children:"Walle-Q"})}),(0,c.jsx)(e.td,{children:"adapters.onebot12"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-discord",children:"Discord"})}),(0,c.jsx)(e.td,{children:"adapters.discord"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-red",children:"Red \u534F\u8BAE"})}),(0,c.jsx)(e.td,{children:"adapters.red"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.a,{href:"https://github.com/nonebot/adapter-satori",children:"Satori \u534F\u8BAE"})}),(0,c.jsx)(e.td,{children:"adapters.satori"})]})]})]}),"\n",(0,c.jsx)(e.h2,{id:"\u6761\u4EF6\u63A7\u5236",children:"\u6761\u4EF6\u63A7\u5236"}),"\n",(0,c.jsxs)(e.p,{children:["\u672C\u63D2\u4EF6\u53EF\u4EE5\u901A\u8FC7 ",(0,c.jsx)(e.code,{children:"assign"})," \u6765\u63A7\u5236\u4E00\u4E2A\u5177\u4F53\u7684\u54CD\u5E94\u51FD\u6570\u662F\u5426\u5728\u4E0D\u6EE1\u8DB3\u6761\u4EF6\u65F6\u8DF3\u8FC7\u54CD\u5E94\u3002"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'...\nfrom nonebot import require\nrequire("nonebot_plugin_alconna")\n...\n\nfrom arclet.alconna import Alconna, Subcommand, Option, Args\nfrom nonebot_plugin_alconna import on_alconna, CommandResult\n\n\npip = Alconna(\n    "pip",\n    Subcommand(\n        "install", Args["pak", str],\n        Option("--upgrade"),\n        Option("--force-reinstall")\n    ),\n    Subcommand("list", Option("--out-dated"))\n)\n\npip_cmd = on_alconna(pip)\n\n# \u4EC5\u5728\u547D\u4EE4\u4E3A `pip install pip` \u65F6\u54CD\u5E94\n@pip_cmd.assign("install.pak", "pip")\nasync def update(res: CommandResult):\n    ...\n\n# \u4EC5\u5728\u547D\u4EE4\u4E3A `pip list` \u65F6\u54CD\u5E94\n@pip_cmd.assign("list")\nasync def list_(res: CommandResult):\n    ...\n\n# \u5728\u547D\u4EE4\u4E3A `pip install xxx` \u65F6\u54CD\u5E94\n@pip_cmd.assign("install")\nasync def install(res: CommandResult):\n    ...\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u6B64\u5916\uFF0C\u4F7F\u7528 ",(0,c.jsx)(e.code,{children:"AlconnaMatcher.dispatch"})," \u8FD8\u80FD\u50CF ",(0,c.jsx)(e.code,{children:"CommandGroup"})," \u4E00\u6837\u4E3A\u6BCF\u4E2A\u5206\u53D1\u8BBE\u7F6E\u72EC\u7ACB\u7684 matcher\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'update_cmd = pip_cmd.dispatch("install.pak", "pip")\n\n@update_cmd.handle()\nasync def update(arp: CommandResult):\n    ...\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u53E6\u5916\uFF0C",(0,c.jsx)(e.code,{children:"AlconnaMatcher"})," \u6709\u7C7B\u4F3C\u4E8E ",(0,c.jsx)(e.code,{children:"got"})," \u7684 ",(0,c.jsx)(e.code,{children:"got_path"}),"\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import At, Match, UniMessage, on_alconna\n\n\ntest_cmd = on_alconna(Alconna("test", Args["target?", Union[str, At]]))\n\n@test_cmd.handle()\nasync def tt_h(target: Match[Union[str, At]]):\n    if target.available:\n        test_cmd.set_path_arg("target", target.result)\n\n@test_cmd.got_path("target", prompt="\u8BF7\u8F93\u5165\u76EE\u6807")\nasync def tt(target: Union[str, At]):\n    await test_cmd.send(UniMessage(["ok\\n", target]))\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"got_path"})," \u4E0E ",(0,c.jsx)(e.code,{children:"assign"}),"\uFF0C",(0,c.jsx)(e.code,{children:"Match"}),"\uFF0C",(0,c.jsx)(e.code,{children:"Query"})," \u7B49\u5730\u65B9\u4E00\u6837\uFF0C\u90FD\u9700\u8981\u6307\u660E ",(0,c.jsx)(e.code,{children:"path"})," \u53C2\u6570 (\u5373\u5BF9\u5E94 Arg \u9A8C\u8BC1\u7684\u8DEF\u5F84)"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"got_path"})," \u4F1A\u83B7\u53D6\u6D88\u606F\u7684\u6700\u540E\u4E00\u4E2A\u6D88\u606F\u6BB5\u5E76\u8F6C\u4E3A path \u5BF9\u5E94\u7684\u7C7B\u578B\uFF0C\u4F8B\u5982\u793A\u4F8B\u4E2D ",(0,c.jsx)(e.code,{children:"target"})," \u5BF9\u5E94\u7684 Arg \u91CC\u8981\u6C42 str \u6216 At\uFF0C\u5219 got \u540E\u7528\u6237\u8F93\u5165\u7684\u6D88\u606F\u53EA\u6709\u4E3A text \u6216 at \u624D\u80FD\u8FDB\u5165\u5904\u7406\u51FD\u6570\u3002"]}),"\n",(0,c.jsxs)(e.admonition,{type:"tip",children:[(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"path"})," \u652F\u6301 ~XXX \u8BED\u6CD5\uFF0C\u5176\u4F1A\u628A ~ \u66FF\u6362\u4E3A\u53EF\u80FD\u7684\u7236\u7EA7\u8DEF\u5F84\uFF1A"]}),(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:' pip = Alconna(\n     "pip",\n     Subcommand(\n         "install",\n         Args["pak", str],\n         Option("--upgrade|-U"),\n         Option("--force-reinstall"),\n     ),\n     Subcommand("list", Option("--out-dated")),\n )\n\n pipcmd = on_alconna(pip)\n pip_install_cmd = pipcmd.dispatch("install")\n\n\n @pip_install_cmd.assign("~upgrade")\n async def pip1_u(pak: Query[str] = Query("~pak")):\n     await pip_install_cmd.finish(f"pip upgrading {pak.result}...")\n'})})]}),"\n",(0,c.jsx)(e.h2,{id:"\u54CD\u5E94\u5668\u521B\u5EFA\u88C5\u9970",children:"\u54CD\u5E94\u5668\u521B\u5EFA\u88C5\u9970"}),"\n",(0,c.jsxs)(e.p,{children:["\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u4E00\u4E2A ",(0,c.jsx)(e.code,{children:"funcommand"})," \u88C5\u9970\u5668, \u5176\u7528\u4E8E\u5C06\u4E00\u4E2A\u63A5\u53D7\u4EFB\u610F\u53C2\u6570\uFF0C \u8FD4\u56DE ",(0,c.jsx)(e.code,{children:"str"})," \u6216 ",(0,c.jsx)(e.code,{children:"Message"})," \u6216 ",(0,c.jsx)(e.code,{children:"MessageSegment"})," \u7684\u51FD\u6570\u8F6C\u6362\u4E3A\u547D\u4EE4\u54CD\u5E94\u5668\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"from nonebot_plugin_alconna import funcommand\n\n\n@funcommand()\nasync def echo(msg: str):\n    return msg\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u5176\u7B49\u540C\u4E8E\uFF1A"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from arclet.alconna import Alconna, Args\nfrom nonebot_plugin_alconna import on_alconna, AlconnaMatch, Match\n\n\necho = on_alconna(Alconna("echo", Args["msg", str]))\n\n@echo.handle()\nasync def echo_exit(msg: Match[str] = AlconnaMatch("msg")):\n    await echo.finish(msg.result)\n\n'})}),"\n",(0,c.jsx)(e.h2,{id:"\u7C7Bkoishi\u6784\u9020\u5668",children:"\u7C7BKoishi\u6784\u9020\u5668"}),"\n",(0,c.jsxs)(e.p,{children:["\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u4E00\u4E2A ",(0,c.jsx)(e.code,{children:"Command"})," \u6784\u9020\u5668\uFF0C\u5176\u57FA\u4E8E ",(0,c.jsx)(e.code,{children:"arclet.alconna.tools"})," \u4E2D\u7684 ",(0,c.jsx)(e.code,{children:"AlconnaString"}),"\uFF0C \u4EE5\u7C7B\u4F3C ",(0,c.jsx)(e.code,{children:"Koishi"})," \u4E2D\u6CE8\u518C\u547D\u4EE4\u7684\u65B9\u5F0F\u6765\u6784\u5EFA\u4E00\u4E2A ",(0,c.jsx)(e.strong,{children:"AlconnaMatcher"})," \uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import Command, Arparma\n\n\nbook = (\n    Command("book", "\u6D4B\u8BD5")\n    .option("writer", "-w <id:int>")\n    .option("writer", "--anonymous", {"id": 0})\n    .usage("book [-w <id:int> | --anonymous]")\n    .shortcut("\u6D4B\u8BD5", {"args": ["--anonymous"]})\n    .build()\n)\n\n@book.handle()\nasync def _(arp: Arparma):\n    await book.send(str(arp.options))\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u751A\u81F3\uFF0C\u4F60\u53EF\u4EE5\u8BBE\u7F6E ",(0,c.jsx)(e.code,{children:"action"})," \u6765\u8BBE\u5B9A\u54CD\u5E94\u884C\u4E3A\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'book = (\n    Command("book", "\u6D4B\u8BD5")\n    .option("writer", "-w <id:int>")\n    .option("writer", "--anonymous", {"id": 0})\n    .usage("book [-w <id:int> | --anonymous]")\n    .shortcut("\u6D4B\u8BD5", {"args": ["--anonymous"]})\n    .action(lambda options: str(options))  # \u4F1A\u81EA\u52A8\u901A\u8FC7 bot.send \u53D1\u9001\n    .build()\n)\n'})}),"\n",(0,c.jsx)(e.h2,{id:"\u8FD4\u56DE\u503C\u4E2D\u95F4\u4EF6",children:"\u8FD4\u56DE\u503C\u4E2D\u95F4\u4EF6"}),"\n",(0,c.jsxs)(e.p,{children:["\u5728 ",(0,c.jsx)(e.code,{children:"AlconnaMatch"}),"\uFF0C",(0,c.jsx)(e.code,{children:"AlconnaQuery"})," \u6216 ",(0,c.jsx)(e.code,{children:"got_path"})," \u4E2D\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528 ",(0,c.jsx)(e.code,{children:"middleware"})," \u53C2\u6570\u6765\u4F20\u5165\u4E00\u4E2A\u5BF9\u8FD4\u56DE\u503C\u8FDB\u884C\u5904\u7406\u7684\u51FD\u6570\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import image_fetch\n\n\nmask_cmd = on_alconna(\n    Alconna("search", Args["img?", Image]),\n)\n\n\n@mask_cmd.handle()\nasync def mask_h(matcher: AlconnaMatcher, img: Match[bytes] = AlconnaMatch("img", image_fetch)):\n    result = await search_img(img.result)\n    await matcher.send(result.content)\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u5176\u4E2D\uFF0C",(0,c.jsx)(e.code,{children:"image_fetch"})," \u662F\u4E00\u4E2A\u4E2D\u95F4\u4EF6\uFF0C\u5176\u63A5\u53D7\u4E00\u4E2A ",(0,c.jsx)(e.code,{children:"Image"})," \u5BF9\u8C61\uFF0C\u5E76\u63D0\u53D6\u56FE\u7247\u7684\u4E8C\u8FDB\u5236\u6570\u636E\u8FD4\u56DE\u3002"]}),"\n",(0,c.jsx)(e.h2,{id:"\u5339\u914D\u62D3\u5C55",children:"\u5339\u914D\u62D3\u5C55"}),"\n",(0,c.jsxs)(e.p,{children:["\u672C\u63D2\u4EF6\u63D0\u4F9B\u4E86\u4E00\u4E2A ",(0,c.jsx)(e.code,{children:"Extension"})," \u7C7B\uFF0C\u5176\u7528\u4E8E\u81EA\u5B9A\u4E49 AlconnaMatcher \u7684\u90E8\u5206\u884C\u4E3A"]}),"\n",(0,c.jsxs)(e.p,{children:["\u4F8B\u5982\u4E00\u4E2A ",(0,c.jsx)(e.code,{children:"LLMExtension"})," \u53EF\u4EE5\u5982\u4E0B\u5B9E\u73B0 (\u4EC5\u4E3E\u4F8B)\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import Extension, Alconna, on_alconna, Interface\n\n\nclass LLMExtension(Extension):\n    @property\n    def priority(self) -> int:\n        return 10\n\n    @property\n    def id(self) -> str:\n        return "LLMExtension"\n\n    def __init__(self, llm):\n      self.llm = llm\n\n    def post_init(self, alc: Alconna) -> None:\n        self.llm.add_context(alc.command, alc.meta.description)\n\n    async def receive_wrapper(self, bot, event, receive):\n        resp = await self.llm.input(str(receive))\n        return receive.__class__(resp.content)\n\n    def before_catch(self, name, annotation, default):\n        return name == "llm"\n\n    def catch(self, interface: Interface):\n        if interface.name == "llm":\n            return self.llm\n\nmatcher = on_alconna(\n    Alconna(...),\n    extensions=[LLMExtension(LLM)]\n)\n...\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u90A3\u4E48\u6DFB\u52A0\u4E86 ",(0,c.jsx)(e.code,{children:"LLMExtension"})," \u7684\u54CD\u5E94\u5668\u4FBF\u80FD\u63A5\u53D7\u4EFB\u4F55\u80FD\u901A\u8FC7 llm \u7FFB\u8BD1\u4E3A\u5177\u4F53\u547D\u4EE4\u7684\u81EA\u7136\u8BED\u8A00\u6D88\u606F\uFF0C\u540C\u65F6\u53EF\u4EE5\u5728\u54CD\u5E94\u5668\u4E2D\u4E3A\u6240\u6709 ",(0,c.jsx)(e.code,{children:"llm"})," \u53C2\u6570\u6CE8\u5165\u6A21\u578B\u53D8\u91CF\u3002"]}),"\n",(0,c.jsxs)(e.p,{children:["\u76EE\u524D ",(0,c.jsx)(e.code,{children:"Extension"})," \u7684\u529F\u80FD\u6709\uFF1A"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"validate"}),": \u5BF9\u4E8E\u4E8B\u4EF6\u7684\u6765\u6E90\u9002\u914D\u5668\u6216 bot \u9009\u62E9\u662F\u5426\u63A5\u53D7\u54CD\u5E94"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"output_converter"}),": \u8F93\u51FA\u4FE1\u606F\u7684\u81EA\u5B9A\u4E49\u8F6C\u6362\u65B9\u6CD5"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"message_provider"}),": \u4ECE\u4F20\u5165\u4E8B\u4EF6\u4E2D\u81EA\u5B9A\u4E49\u63D0\u53D6\u6D88\u606F\u7684\u65B9\u6CD5"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"receive_provider"}),": \u5BF9\u4F20\u5165\u7684\u6D88\u606F (Message \u6216 UniMessage) \u7684\u989D\u5916\u5904\u7406"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"context_provider"}),": \u5BF9\u547D\u4EE4\u4E0A\u4E0B\u6587\u7684\u989D\u5916\u5904\u7406"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"permission_check"}),": \u547D\u4EE4\u5BF9\u6D88\u606F\u89E3\u6790\u5E76\u786E\u8BA4\u5934\u90E8\u5339\u914D\uFF08\u5373\u786E\u8BA4\u9009\u62E9\u54CD\u5E94\uFF09\u65F6\u5BF9\u53D1\u9001\u8005\u7684\u6743\u9650\u5224\u65AD"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"parse_wrapper"}),": \u5BF9\u547D\u4EE4\u89E3\u6790\u7ED3\u679C\u7684\u989D\u5916\u5904\u7406"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"send_wrapper"}),": \u5BF9\u53D1\u9001\u7684\u6D88\u606F (Message \u6216 UniMessage) \u7684\u989D\u5916\u5904\u7406"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"before_catch"}),": \u81EA\u5B9A\u4E49\u4F9D\u8D56\u6CE8\u5165\u7684\u7ED1\u5B9A\u786E\u8BA4\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"catch"}),": \u81EA\u5B9A\u4E49\u4F9D\u8D56\u6CE8\u5165\u5904\u7406\u51FD\u6570"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"post_init"}),": \u54CD\u5E94\u5668\u521B\u5EFA\u540E\u5BF9\u547D\u4EE4\u5BF9\u8C61\u7684\u989D\u5916\u5904\u7406"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["\u4F8B\u5982\u5185\u7F6E\u7684 ",(0,c.jsx)(e.code,{children:"DiscordSlashExtension"}),"\uFF0C\u5176\u53EF\u81EA\u52A8\u5C06 Alconna \u5BF9\u8C61\u7FFB\u8BD1\u6210 slash \u6307\u4EE4\u5E76\u6CE8\u518C\uFF0C\u4E14\u5C06\u6536\u5230\u7684\u6307\u4EE4\u4EA4\u4E92\u4E8B\u4EF6\u8F6C\u4E3A\u6307\u4EE4\u4F9B\u547D\u4EE4\u89E3\u6790\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import Match, on_alconna\nfrom nonebot_plugin_alconna.builtins.extensions.discord import DiscordSlashExtension\n\n\nalc = Alconna(\n    ["/"],\n    "permission",\n    Subcommand("add", Args["plugin", str]["priority?", int]),\n    Option("remove", Args["plugin", str]["time?", int]),\n    meta=CommandMeta(description="\u6743\u9650\u7BA1\u7406"),\n)\n\nmatcher = on_alconna(alc, extensions=[DiscordSlashExtension()])\n\n@matcher.assign("add")\nasync def add(plugin: Match[str], priority: Match[int]):\n    await matcher.finish(f"added {plugin.result} with {priority.result if priority.available else 0}")\n\n@matcher.assign("remove")\nasync def remove(plugin: Match[str], time: Match[int]):\n    await matcher.finish(f"removed {plugin.result} with {time.result if time.available else -1}")\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u76EE\u524D\u63D2\u4EF6\u63D0\u4F9B\u4E86 4 \u4E2A\u5185\u7F6E\u7684 ",(0,c.jsx)(e.code,{children:"Extension"}),"\uFF0C\u5B83\u4EEC\u5728 ",(0,c.jsx)(e.code,{children:"nonebot_plugin_alconna.builtins.extensions"})," \u4E0B\uFF1A"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"ReplyRecordExtension"}),": \u5C06\u6D88\u606F\u4E8B\u4EF6\u4E2D\u7684\u56DE\u590D\u6682\u5B58\u5728 extension \u4E2D\uFF0C\u4F7F\u5F97\u89E3\u6790\u7528\u7684\u6D88\u606F\u4E0D\u5E26\u56DE\u590D\u4FE1\u606F\uFF0C\u540C\u65F6\u53EF\u4EE5\u5728\u540E\u7EED\u7684\u5904\u7406\u4E2D\u83B7\u53D6\u56DE\u590D\u4FE1\u606F\u3002"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"DiscordSlashExtension"}),": \u5C06 Alconna \u7684\u547D\u4EE4\u81EA\u52A8\u8F6C\u6362\u4E3A Discord \u7684 Slash Command\uFF0C\u5E76\u5C06 Slash Command \u7684\u4EA4\u4E92\u4E8B\u4EF6\u8F6C\u6362\u4E3A\u6D88\u606F\u4EA4\u7ED9 Alconna \u5904\u7406\u3002"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"MarkdownOutputExtension"}),": \u5C06 Alconna \u7684\u81EA\u52A8\u8F93\u51FA\u8F6C\u6362\u4E3A Markdown \u683C\u5F0F"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.code,{children:"TelegramSlashExtension"}),": \u5C06 Alconna \u7684\u547D\u4EE4\u6CE8\u518C\u5728 Telegram \u4E0A\u4EE5\u83B7\u5F97\u63D0\u793A\u3002"]}),"\n"]}),"\n",(0,c.jsx)(e.admonition,{type:"tip",children:(0,c.jsx)(e.p,{children:"\u5168\u5C40\u7684 Extension \u53EF\u5EF6\u8FDF\u52A0\u8F7D (\u5373\u82E5\u6709\u5168\u5C40\u62D3\u5C55\u52A0\u8F7D\u4E8E\u90E8\u5206 AlconnaMatcher \u4E4B\u540E\uFF0C\u8FD9\u90E8\u5206\u54CD\u5E94\u5668\u4F1A\u88AB\u8FFD\u52A0\u62D3\u5C55)"})}),"\n",(0,c.jsx)(e.h2,{id:"\u8865\u5168\u4F1A\u8BDD",children:"\u8865\u5168\u4F1A\u8BDD"}),"\n",(0,c.jsxs)(e.p,{children:["\u8865\u5168\u4F1A\u8BDD\u57FA\u4E8E ",(0,c.jsx)(e.a,{href:"/website/docs/2.4.2/best-practice/alconna/command#%E5%8D%8A%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8",children:(0,c.jsx)(e.code,{children:"\u534A\u81EA\u52A8\u8865\u5168"})}),"\uFF0C\u7528\u4E8E\u6307\u4EE4\u53C2\u6570\u7F3A\u5931\u6216\u53C2\u6570\u9519\u8BEF\u65F6\u7ED9\u4E88\u4EA4\u4E92\u5F0F\u63D0\u793A\uFF0C\u7C7B\u4F3C\u4E8E ",(0,c.jsx)(e.code,{children:"got-reject"}),"\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import Alconna, Args, Field, At, on_alconna\n\nalc = Alconna(\n    "\u6DFB\u52A0\u6559\u5E08",\n    Args["name", str, Field(completion=lambda: "\u8BF7\u8F93\u5165\u59D3\u540D")],\n    Args["phone", int, Field(completion=lambda: "\u8BF7\u8F93\u5165\u624B\u673A\u53F7")],\n    Args["at", [str, At], Field(completion=lambda: "\u8BF7\u8F93\u5165\u6559\u5E08\u53F7")],\n)\n\ncmd = on_alconna(alc, comp_config={"lite": True}, skip_for_unmatch=False)\n\n@cmd.handle()\nasync def handle(result: Arparma):\n    cmd.finish("\u6DFB\u52A0\u6210\u529F")\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u6B64\u65F6\uFF0C\u5F53\u7528\u6237\u8F93\u5165 ",(0,c.jsx)(e.code,{children:"\u6DFB\u52A0\u6559\u5E08"})," \u65F6\uFF0C\u4F1A\u81EA\u52A8\u63D0\u793A\u7528\u6237\u8F93\u5165\u59D3\u540D\uFF0C\u624B\u673A\u53F7\u548C\u6559\u5E08\u53F7\uFF0C\u7528\u6237\u8F93\u5165\u540E\u4F1A\u81EA\u52A8\u8FDB\u5165\u4E0B\u4E00\u4E2A\u63D0\u793A\uFF1A"]}),"\n",(0,c.jsx)(r.Z,{msgs:[{position:"right",msg:"\u6DFB\u52A0\u6559\u5E08"},{position:"left",msg:"\u4EE5\u4E0B\u662F\u5EFA\u8BAE\u7684\u8F93\u5165\uFF1A \n- name: \u8BF7\u8F93\u5165\u59D3\u540D"},{position:"right",msg:"foo"},{position:"left",msg:"\u4EE5\u4E0B\u662F\u5EFA\u8BAE\u7684\u8F93\u5165\uFF1A \n- phone: \u8BF7\u8F93\u5165\u624B\u673A\u53F7"},{position:"right",msg:"12345"},{position:"left",msg:"\u4EE5\u4E0B\u662F\u5EFA\u8BAE\u7684\u8F93\u5165\uFF1A \n- at: \u8BF7\u8F93\u5165\u6559\u5E08\u53F7"},{position:"right",msg:"@me"},{position:"left",msg:"\u6DFB\u52A0\u6210\u529F"}]}),"\n",(0,c.jsx)(e.p,{children:"\u8865\u5168\u4F1A\u8BDD\u914D\u7F6E\u5982\u4E0B\uFF1A"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'class CompConfig(TypedDict):\n    tab: NotRequired[str]\n    """\u7528\u4E8E\u5207\u6362\u63D0\u793A\u7684\u6307\u4EE4\u7684\u540D\u79F0"""\n    enter: NotRequired[str]\n    """\u7528\u4E8E\u8F93\u5165\u63D0\u793A\u7684\u6307\u4EE4\u7684\u540D\u79F0"""\n    exit: NotRequired[str]\n    """\u7528\u4E8E\u9000\u51FA\u4F1A\u8BDD\u7684\u6307\u4EE4\u7684\u540D\u79F0"""\n    timeout: NotRequired[int]\n    """\u8D85\u65F6\u65F6\u95F4"""\n    hide_tabs: NotRequired[bool]\n    """\u662F\u5426\u9690\u85CF\u6240\u6709\u63D0\u793A"""\n    hides: NotRequired[Set[Literal["tab", "enter", "exit"]]]\n    """\u9690\u85CF\u7684\u6307\u4EE4"""\n    disables: NotRequired[Set[Literal["tab", "enter", "exit"]]]\n    """\u7981\u7528\u7684\u6307\u4EE4"""\n    lite: NotRequired[bool]\n    """\u662F\u5426\u4F7F\u7528\u7B80\u6D01\u7248\u672C\u7684\u8865\u5168\u4F1A\u8BDD\uFF08\u76F8\u5F53\u4E8E\u540C\u65F6\u914D\u7F6E disables\u3001hides\u3001hide_tabs\uFF09"""\n'})}),"\n",(0,c.jsx)(e.h2,{id:"\u5185\u7F6E\u63D2\u4EF6",children:"\u5185\u7F6E\u63D2\u4EF6"}),"\n",(0,c.jsxs)(e.p,{children:["\u7C7B\u4F3C\u4E8E Nonebot \u672C\u8EAB\u63D0\u4F9B\u7684\u5185\u7F6E\u63D2\u4EF6\uFF0C",(0,c.jsx)(e.code,{children:"nonebot_plugin_alconna"})," \u63D0\u4F9B\u4E86\u4E24\u4E2A\u5185\u7F6E\u63D2\u4EF6\uFF1A",(0,c.jsx)(e.code,{children:"echo"})," \u548C ",(0,c.jsx)(e.code,{children:"help"}),"\u3002"]}),"\n",(0,c.jsxs)(e.p,{children:["\u4F60\u53EF\u4EE5\u7528\u672C\u63D2\u4EF6\u7684 ",(0,c.jsx)(e.code,{children:"load_builtin_plugin(s)"})," \u6765\u52A0\u8F7D\u5B83\u4EEC\uFF1A"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:'from nonebot_plugin_alconna import load_builtin_plugins\n\nload_builtin_plugins("echo", "help")\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u5176\u4E2D ",(0,c.jsx)(e.code,{children:"help"})," \u4EC5\u80FD\u5217\u51FA\u6240\u6709 Alconna \u6307\u4EE4\u3002"]}),"\n",(0,c.jsx)(r.Z,{msgs:[{position:"right",msg:"/\u5E2E\u52A9"},{position:"left",msg:"# \u5F53\u524D\u53EF\u7528\u7684\u547D\u4EE4\u6709:\n 0 /echo : echo \u6307\u4EE4\n 1 /help : \u663E\u793A\u6240\u6709\u547D\u4EE4\u5E2E\u52A9\n# \u8F93\u5165'\u547D\u4EE4\u540D -h|--help' \u67E5\u770B\u7279\u5B9A\u547D\u4EE4\u7684\u8BED\u6CD5"},{position:"right",msg:"/echo [\u56FE\u7247]"},{position:"left",msg:"[\u56FE\u7247]"}]})]})}function p(n={}){let{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(h,{...n})}):h(n)}},70203:function(n,e,s){s.d(e,{Z:function(){return h}});var i=s(24246),c=s(27378),t=s(90496),r=s(70486),a=s(92739),l=s(85870),o=s(32896);function d(n){let{msg:e,position:s="left",monospace:c=!1}=n,{navbar:{logo:d}}=(0,l.Th)(),h={light:(0,r.ZP)(d.src),dark:(0,r.ZP)(d.srcDark||d.src)},p="right"===s;return(0,i.jsxs)("div",{className:(0,t.Z)("chat",p?"chat-end":"chat-start"),children:[(0,i.jsx)("div",{className:"chat-image avatar",children:(0,i.jsx)("div",{className:(0,t.Z)("messenger-chat-avatar",p&&"messenger-chat-avatar-user"),children:p?(0,i.jsx)(a.G,{icon:["fas","user"]}):(0,i.jsx)(o.Z,{sources:h})})}),(0,i.jsx)("div",{className:(0,t.Z)("chat-bubble messenger-chat-bubble",c&&"font-mono"),dangerouslySetInnerHTML:{__html:e.replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;")}})]})}function h(n){let{msgs:e=[]}=n;return(0,i.jsxs)("div",{className:"messenger-container",children:[(0,i.jsxs)("header",{className:"messenger-title",children:[(0,i.jsx)("div",{className:"messenger-title-back",children:(0,i.jsx)(a.G,{icon:["fas","chevron-left"]})}),(0,i.jsx)("div",{className:"messenger-title-name",children:(0,i.jsx)("span",{children:"NoneBot"})}),(0,i.jsx)("div",{className:"messenger-title-more",children:(0,i.jsx)(a.G,{icon:["fas","bars"]})})]}),(0,i.jsx)("div",{className:"messenger-chat",children:e.map((n,e)=>(0,c.createElement)(d,{...n,key:e}))}),(0,i.jsxs)("div",{className:"messenger-footer",children:[(0,i.jsxs)("div",{className:"messenger-footer-action",children:[(0,i.jsx)("div",{className:"messenger-footer-action-input",children:(0,i.jsx)("input",{className:"input input-xs input-bordered input-info w-full",readOnly:!0})}),(0,i.jsx)("div",{className:"messenger-footer-action-send",children:(0,i.jsx)("button",{className:"btn btn-xs btn-info no-animation text-white",children:"\u53D1\u9001"})})]}),(0,i.jsxs)("div",{className:"messenger-footer-tools",children:[(0,i.jsx)("div",{children:(0,i.jsx)(a.G,{icon:["fas","microphone"]})}),(0,i.jsx)("div",{children:(0,i.jsx)(a.G,{icon:["fas","image"]})}),(0,i.jsx)("div",{children:(0,i.jsx)(a.G,{icon:["fas","camera"]})}),(0,i.jsx)("div",{children:(0,i.jsx)(a.G,{icon:["fas","wallet"]})}),(0,i.jsx)("div",{children:(0,i.jsx)(a.G,{icon:["fas","smile-wink"]})}),(0,i.jsx)("div",{children:(0,i.jsx)(a.G,{icon:["fas","plus-circle"]})})]})]})]})}},80980:function(n,e,s){s.d(e,{Z:function(){return a},a:function(){return r}});var i=s(27378);let c={},t=i.createContext(c);function r(n){let e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:r(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);