"use strict";(self.webpackChunknonebot=self.webpackChunknonebot||[]).push([["342"],{77335:function(e,n,s){s.r(n),s.d(n,{default:()=>p,frontMatter:()=>r,metadata:()=>t,assets:()=>l,toc:()=>d,contentTitle:()=>c});var t=JSON.parse('{"id":"appendices/api-calling","title":"\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3","description":"\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3\uFF0C\u5B8C\u6210\u66F4\u591A\u529F\u80FD","source":"@site/versioned_docs/version-2.4.1/appendices/api-calling.mdx","sourceDirName":"appendices","slug":"/appendices/api-calling","permalink":"/website/docs/2.4.1/appendices/api-calling","draft":false,"unlisted":false,"editUrl":"https://github.com/nonebot/nonebot2/edit/master/website/versioned_docs/version-2.4.1/appendices/api-calling.mdx","tags":[],"version":"2.4.1","lastUpdatedBy":"noneflow[bot]","lastUpdatedAt":1754561629000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"description":"\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3\uFF0C\u5B8C\u6210\u66F4\u591A\u529F\u80FD","options":{"menu":[{"category":"appendices","weight":50}]}},"sidebar":"tutorial","previous":{"title":"\u4F1A\u8BDD\u72B6\u6001","permalink":"/website/docs/2.4.1/appendices/session-state"},"next":{"title":"\u6743\u9650\u63A7\u5236","permalink":"/website/docs/2.4.1/appendices/permission"}}'),i=s("24246"),o=s("80980"),a=s("70203");let r={sidebar_position:4,description:"\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3\uFF0C\u5B8C\u6210\u66F4\u591A\u529F\u80FD",options:{menu:[{category:"appendices",weight:50}]}},c="\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3",l={},d=[{value:"\u53D1\u9001\u5E73\u53F0\u7279\u6B8A\u6D88\u606F",id:"\u53D1\u9001\u5E73\u53F0\u7279\u6B8A\u6D88\u606F",level:2},{value:"\u8C03\u7528\u5E73\u53F0 API",id:"\u8C03\u7528\u5E73\u53F0-api",level:2},{value:"\u83B7\u53D6 Bot",id:"\u83B7\u53D6-bot",level:3},{value:"\u8C03\u7528 API",id:"\u8C03\u7528-api",level:3}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3",children:"\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3"})}),"\n","\n",(0,i.jsxs)(n.p,{children:["\u5728 NoneBot \u4E2D\uFF0C\u9664\u4E86\u4F7F\u7528\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u53D1\u9001\u6587\u672C\u6D88\u606F\u5916\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u76F4\u63A5\u901A\u8FC7\u4F7F\u7528\u534F\u8BAE\u9002\u914D\u5668\u63D0\u4F9B\u7684\u65B9\u6CD5\u6765\u4F7F\u7528\u5E73\u53F0\u7279\u5B9A\u7684\u63A5\u53E3\uFF0C\u5B8C\u6210\u53D1\u9001\u7279\u6B8A\u6D88\u606F\u3001\u83B7\u53D6\u4FE1\u606F\u7B49\u5176\u4ED6\u5E73\u53F0\u63D0\u4F9B\u7684\u529F\u80FD\u3002\u540C\u65F6\uFF0C\u5728\u90E8\u5206\u65E0\u6CD5\u4F7F\u7528\u4E8B\u4EF6\u54CD\u5E94\u5668\u7684\u60C5\u51B5\u4E2D\uFF0C\u4F8B\u5982",(0,i.jsx)(n.a,{href:"/website/docs/2.4.1/best-practice/scheduler",children:"\u5B9A\u65F6\u4EFB\u52A1"}),"\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u4F7F\u7528\u5E73\u53F0\u63A5\u53E3\u6765\u5B8C\u6210\u9700\u8981\u7684\u529F\u80FD\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u53D1\u9001\u5E73\u53F0\u7279\u6B8A\u6D88\u606F",children:"\u53D1\u9001\u5E73\u53F0\u7279\u6B8A\u6D88\u606F"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u4E4B\u524D\u7684\u7AE0\u8282\u4E2D\uFF0C\u6211\u4EEC\u4ECB\u7ECD\u4E86\u5982\u4F55\u5411\u7528\u6237\u53D1\u9001\u6587\u672C\u6D88\u606F\u4EE5\u53CA",(0,i.jsx)(n.a,{href:"/website/docs/2.4.1/tutorial/message",children:"\u5982\u4F55\u5904\u7406\u5E73\u53F0\u6D88\u606F"}),"\uFF0C\u73B0\u5728\u6211\u4EEC\u6765\u5411\u7528\u6237\u53D1\u9001\u5E73\u53F0\u7279\u6B8A\u6D88\u606F\u3002"]}),"\n",(0,i.jsx)(n.admonition,{title:"\u6CE8\u610F",type:"caution",children:(0,i.jsxs)(n.p,{children:["\u5728\u4EE5\u4E0B\u7684\u793A\u4F8B\u4E2D\uFF0C\u6211\u4EEC\u5C06\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"Console"})," \u534F\u8BAE\u9002\u914D\u5668\u6765\u6F14\u793A\u5982\u4F55\u53D1\u9001\u5E73\u53F0\u6D88\u606F\u3002\u5728\u5B9E\u9645\u4F7F\u7528\u4E2D\uFF0C\u4F60\u9700\u8981\u786E\u4FDD\u4F60\u4F7F\u7528\u7684",(0,i.jsx)(n.strong,{children:"\u6D88\u606F\u5E8F\u5217\u7C7B\u578B"}),"\u4E0E\u4F60\u6240\u8981\u53D1\u9001\u7684",(0,i.jsx)(n.strong,{children:"\u5E73\u53F0\u7C7B\u578B"}),"\u4E00\u81F4\u3002"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{4,7-17} title=weather/__init__.py",children:'import inspect\nfrom nonebot.adapters.console import MessageSegment\n\n@weather.got("location", prompt=MessageSegment.emoji("question") + "\u8BF7\u8F93\u5165\u5730\u540D")\nasync def got_location(location: str = ArgPlainText()):\n    result = await weather.send(\n        MessageSegment.markdown(\n            inspect.cleandoc(\n                f"""\n                # {location}\n\n                - \u4ECA\u5929\n\n                   \u26C5 \u591A\u4E91 20\u2103~24\u2103\n                """\n            )\n        )\n    )\n'})}),"\n",(0,i.jsx)(a.Z,{msgs:[{position:"right",msg:"/\u5929\u6C14"},{position:"left",msg:"\u2753\u8BF7\u8F93\u5165\u5730\u540D"},{position:"right",msg:"\u5317\u4EAC"},{position:"left",monospace:!0,msg:"\u250F\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503      \u5317\u4EAC       \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251B\n\u2022 \u4ECA\u5929\n\u26C5 \u591A\u4E91 20\u2103~24\u2103"}]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u4E0A\u9762\u7684\u793A\u4F8B\u4E2D\uFF0C\u6211\u4EEC\u4F7F\u7528\u4E86 ",(0,i.jsx)(n.code,{children:"Console"})," \u534F\u8BAE\u9002\u914D\u5668\u63D0\u4F9B\u7684 ",(0,i.jsx)(n.code,{children:"MessageSegment"})," \u7C7B\u6765\u53D1\u9001\u5E73\u53F0\u7279\u5B9A\u7684\u6D88\u606F ",(0,i.jsx)(n.code,{children:"emoji"})," \u548C ",(0,i.jsx)(n.code,{children:"markdown"}),"\u3002\u8FD9\u4E24\u79CD\u6D88\u606F\u53EF\u4EE5\u663E\u793A\u5728\u7EC8\u7AEF\u4E2D\uFF0C\u4F46\u662F\u65E0\u6CD5\u5728\u5176\u4ED6\u5E73\u53F0\u4E0A\u4F7F\u7528\u3002\u5728\u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528 ",(0,i.jsx)(n.code,{children:"str"}),"\u3001\u6D88\u606F\u5E8F\u5217\u3001\u6D88\u606F\u6BB5\u3001\u6D88\u606F\u6A21\u677F\u56DB\u79CD\u7C7B\u578B\u6765\u53D1\u9001\u6D88\u606F\uFF0C\u4F46\u5176\u4E2D\u53EA\u6709 ",(0,i.jsx)(n.code,{children:"str"})," \u548C",(0,i.jsx)(n.a,{href:"/website/docs/2.4.1/tutorial/message#%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E6%A8%A1%E6%9D%BF",children:"\u7EAF\u6587\u672C\u5F62\u5F0F\u7684\u6D88\u606F\u6A21\u677F\u7C7B\u578B"}),"\u6D88\u606F\u53EF\u4EE5\u5728\u6240\u6709\u5E73\u53F0\u4E0A\u4F7F\u7528\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"send"})," \u4E8B\u4EF6\u54CD\u5E94\u5668\u64CD\u4F5C\u5B9E\u9645\u4E0A\u662F\u7531\u534F\u8BAE\u9002\u914D\u5668\u901A\u8FC7\u8C03\u7528\u5E73\u53F0 API \u6765\u5B9E\u73B0\u7684\uFF0C\u901A\u5E38\u4F1A\u5C06 API \u8C03\u7528\u7684\u7ED3\u679C\u4F5C\u4E3A\u8FD4\u56DE\u503C\u8FD4\u56DE\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u8C03\u7528\u5E73\u53F0-api",children:"\u8C03\u7528\u5E73\u53F0 API"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 NoneBot \u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 ",(0,i.jsx)(n.code,{children:"Bot"})," \u5BF9\u8C61\u6765\u8C03\u7528\u534F\u8BAE\u9002\u914D\u5668\u652F\u6301\u7684\u5E73\u53F0 API\uFF0C\u6765\u5B8C\u6210\u66F4\u591A\u7684\u529F\u80FD\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u83B7\u53D6-bot",children:"\u83B7\u53D6 Bot"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u8C03\u7528\u5E73\u53F0 API \u4E4B\u524D\uFF0C\u6211\u4EEC\u9996\u5148\u8981\u83B7\u5F97 Bot \u5BF9\u8C61\u3002\u6709\u4E24\u79CD\u65B9\u5F0F\u53EF\u4EE5\u83B7\u5F97 Bot \u5BF9\u8C61\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u4E8B\u4EF6\u5904\u7406\u6D41\u7A0B\u7684\u4E0A\u4E0B\u6587\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u4F9D\u8D56\u6CE8\u5165 Bot \u6765\u83B7\u53D6\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{1,4} title=weather/__init__.py",children:'from nonebot.adapters import Bot\n\n@weather.got("location", prompt="\u8BF7\u8F93\u5165\u5730\u540D")\nasync def got_location(bot: Bot, location: str = ArgPlainText()):\n    ...\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u4F9D\u8D56\u6CE8\u5165\u4F1A\u786E\u4FDD\u4F60\u83B7\u5F97\u7684 Bot \u5BF9\u8C61\u4E0E\u7C7B\u578B\u6CE8\u89E3\u7684 Bot \u7C7B\u578B\u4E00\u81F4\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5982\u679C\u4F60\u4F7F\u7528\u7684\u662F Bot \u57FA\u7C7B\uFF0C\u5C06\u4F1A\u5141\u8BB8\u4EFB\u4F55\u5E73\u53F0\u7684 Bot \u5BF9\u8C61\uFF1B\u5982\u679C\u4F60\u4F7F\u7528\u7684\u662F\u5E73\u53F0\u7279\u5B9A\u7684 Bot \u7C7B\u578B\uFF0C\u5C06\u4F1A\u53EA\u5141\u8BB8\u8BE5\u5E73\u53F0\u7684 Bot \u5BF9\u8C61\uFF0C\u5176\u4ED6\u7C7B\u578B\u7684 Bot \u5C06\u4F1A\u8DF3\u8FC7\u8FD9\u4E2A\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u3002\u66F4\u591A\u8BE6\u60C5\u8BF7\u53C2\u8003",(0,i.jsx)(n.a,{href:"/website/docs/2.4.1/appendices/overload",children:"\u4E8B\u4EF6\u5904\u7406\u91CD\u8F7D"}),"\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u5176\u4ED6\u60C5\u51B5\u4E0B\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 NoneBot \u63D0\u4F9B\u7684\u65B9\u6CD5\u6765\u83B7\u53D6 Bot \u5BF9\u8C61\uFF0C\u8FD9\u4E9B\u65B9\u6CD5\u5C06\u4F1A\u5728",(0,i.jsx)(n.a,{href:"/website/docs/2.4.1/advanced/adapter#%E8%8E%B7%E5%8F%96-bot-%E5%AF%B9%E8%B1%A1",children:"\u4F7F\u7528\u9002\u914D\u5668"}),"\u4E2D\u8BE6\u7EC6\u4ECB\u7ECD\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{4,6}",children:'from nonebot import get_bot\n\n# \u83B7\u53D6\u5F53\u524D\u6240\u6709 Bot \u4E2D\u7684\u7B2C\u4E00\u4E2A\nbot = get_bot()\n# \u83B7\u53D6\u6307\u5B9A ID \u7684 Bot\nbot = get_bot("bot_id")\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u8C03\u7528-api",children:"\u8C03\u7528 API"}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u83B7\u5F97 Bot \u5BF9\u8C61\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7 Bot \u7684\u5B9E\u4F8B\u65B9\u6CD5\u6765\u8C03\u7528\u5E73\u53F0 API\uFF1A"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{2,5}",children:'# \u901A\u8FC7 bot.api_name(**kwargs) \u7684\u65B9\u6CD5\u8C03\u7528 API\nresult = await bot.get_user_info(user_id=12345678)\n\n# \u901A\u8FC7 bot.call_api(api_name, **kwargs) \u7684\u65B9\u6CD5\u8C03\u7528 API\nresult = await bot.call_api("get_user_info", user_id=12345678)\n'})}),"\n",(0,i.jsx)(n.admonition,{title:"\u6CE8\u610F",type:"caution",children:(0,i.jsx)(n.p,{children:"\u5B9E\u9645\u53EF\u4EE5\u4F7F\u7528\u7684 API \u4EE5\u53CA\u53C2\u6570\u53D6\u51B3\u4E8E\u5E73\u53F0\u63D0\u4F9B\u7684\u63A5\u53E3\u4EE5\u53CA\u534F\u8BAE\u9002\u914D\u5668\u7684\u5B9E\u73B0\uFF0C\u8BF7\u53C2\u8003\u534F\u8BAE\u9002\u914D\u5668\u4EE5\u53CA\u5E73\u53F0\u6587\u6863\u3002"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u4E86\u89E3\u4E86\u5982\u4F55\u8C03\u7528 API \u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u6765\u6539\u8FDB ",(0,i.jsx)(n.code,{children:"weather"})," \u63D2\u4EF6\uFF0C\u4F7F\u5F97\u6D88\u606F\u53D1\u9001\u540E\uFF0C\u8C03\u7528 ",(0,i.jsx)(n.code,{children:"Console"})," \u63A5\u53E3\u54CD\u94C3\u63D0\u9192\u673A\u5668\u4EBA\u7528\u6237\uFF1A"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{4,18} title=weather/__init__.py",children:'from nonebot.adapters.console import Bot, MessageSegment\n\n@weather.got("location", prompt=MessageSegment.emoji("question") + "\u8BF7\u8F93\u5165\u5730\u540D")\nasync def got_location(bot: Bot, location: str = ArgPlainText()):\n    await weather.send(\n        MessageSegment.markdown(\n            inspect.cleandoc(\n                f"""\n                # {location}\n\n                - \u4ECA\u5929\n\n                   \u26C5 \u591A\u4E91 20\u2103~24\u2103\n                """\n            )\n        )\n    )\n    await bot.bell()\n'})})]})}function p(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},70203:function(e,n,s){s.d(n,{Z:function(){return h}});var t=s(24246),i=s(27378),o=s(90496),a=s(70486),r=s(92739),c=s(85870),l=s(32896);function d(e){let{msg:n,position:s="left",monospace:i=!1}=e,{navbar:{logo:d}}=(0,c.Th)(),h={light:(0,a.ZP)(d.src),dark:(0,a.ZP)(d.srcDark||d.src)},p="right"===s;return(0,t.jsxs)("div",{className:(0,o.Z)("chat",p?"chat-end":"chat-start"),children:[(0,t.jsx)("div",{className:"chat-image avatar",children:(0,t.jsx)("div",{className:(0,o.Z)("messenger-chat-avatar",p&&"messenger-chat-avatar-user"),children:p?(0,t.jsx)(r.G,{icon:["fas","user"]}):(0,t.jsx)(l.Z,{sources:h})})}),(0,t.jsx)("div",{className:(0,o.Z)("chat-bubble messenger-chat-bubble",i&&"font-mono"),dangerouslySetInnerHTML:{__html:n.replace(/\n/g,"<br/>").replace(/ /g,"&nbsp;")}})]})}function h(e){let{msgs:n=[]}=e;return(0,t.jsxs)("div",{className:"messenger-container",children:[(0,t.jsxs)("header",{className:"messenger-title",children:[(0,t.jsx)("div",{className:"messenger-title-back",children:(0,t.jsx)(r.G,{icon:["fas","chevron-left"]})}),(0,t.jsx)("div",{className:"messenger-title-name",children:(0,t.jsx)("span",{children:"NoneBot"})}),(0,t.jsx)("div",{className:"messenger-title-more",children:(0,t.jsx)(r.G,{icon:["fas","bars"]})})]}),(0,t.jsx)("div",{className:"messenger-chat",children:n.map((e,n)=>(0,i.createElement)(d,{...e,key:n}))}),(0,t.jsxs)("div",{className:"messenger-footer",children:[(0,t.jsxs)("div",{className:"messenger-footer-action",children:[(0,t.jsx)("div",{className:"messenger-footer-action-input",children:(0,t.jsx)("input",{className:"input input-xs input-bordered input-info w-full",readOnly:!0})}),(0,t.jsx)("div",{className:"messenger-footer-action-send",children:(0,t.jsx)("button",{className:"btn btn-xs btn-info no-animation text-white",children:"\u53D1\u9001"})})]}),(0,t.jsxs)("div",{className:"messenger-footer-tools",children:[(0,t.jsx)("div",{children:(0,t.jsx)(r.G,{icon:["fas","microphone"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(r.G,{icon:["fas","image"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(r.G,{icon:["fas","camera"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(r.G,{icon:["fas","wallet"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(r.G,{icon:["fas","smile-wink"]})}),(0,t.jsx)("div",{children:(0,t.jsx)(r.G,{icon:["fas","plus-circle"]})})]})]})]})}},80980:function(e,n,s){s.d(n,{Z:function(){return r},a:function(){return a}});var t=s(27378);let i={},o=t.createContext(i);function a(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);