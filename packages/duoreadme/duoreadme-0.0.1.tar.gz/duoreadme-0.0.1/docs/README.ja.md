# DuoReadme - 複数言語対応のREADME生成ツール

DuoReadmeは、プロジェクトコードとREADMEを複数言語に自動翻訳し、標準化された多言語ドキュメントを生成する強力なCLIツールです。

## 特徴

- **多言語サポート**：中国語、英語、日本語、韓国語、フランス語、ドイツ語、スペイン語、イタリア語、ポルトガル語、ロシア語など、100以上の言語をサポートしています。完全な言語リストについては、[ISO言語コード](./LANGUAGE.md)をご覧ください。
- **スマート解析**：プロジェクト構造とコード内容を自動的に解析します。
- **バッチ処理**：ワンクリックですべての言語のREADMEドキュメントを生成します。
- **テンセントクラウド統合**：テンセントクラウドインテリジェンスプラットフォームと統合されています。
- **標準設定**：一般的なプロジェクト標準を使用し、英語のREADME.mdをルートディレクトリに、他の言語のREADME.mdファイルをdocsディレクトリに配置します。

## インストール

```bash
pip install duoreadme
```

## 使用方法

### 基本的な使い方

```bash
# 利用可能なすべてのコマンドを表示
duoreadme --help

# 複数言語のREADMEを生成（自動的に.gitignoreフィルタリングを適用）
duoreadme gen

# 生成するプロジェクトパスを指定
duoreadme gen --project-path ./myproject

# 翻訳する言語を指定
duoreadme gen --languages "zh-Hans,en,ja,ko,fr"

# READMEファイルの純粋なテキスト翻訳
duoreadme trans --languages "zh-Hans,en,ja"
```

### 利用可能なコマンド

#### gen - 複数言語のREADMEを生成
```bash
# デフォルト設定を使用して複数言語のREADMEを生成
duoreadme gen

# プロジェクトパスを指定
duoreadme gen --project-path ./myproject

# 翻訳する言語を指定
duoreadme gen --languages "zh-Hans,en,ja,ko,fr"

# 詳細な出力を表示
duoreadme gen --verbose

# デバッグモードを有効にする（詳細なログを表示）
duoreadme gen --debug
```

#### trans - 純粋なテキスト翻訳
```bash
# デフォルト設定を使用してREADMEファイルを翻訳
duoreadme trans

# プロジェクトパスを指定
duoreadme trans --project-path ./myproject

# 翻訳する言語を指定
duoreadme trans --languages "zh-Hans,en,ja,ko,fr"

# 詳細な出力を表示
duoreadme trans --verbose

# デバッグモードを有効にする（詳細なログを表示）
duoreadme trans --debug
```

**transコマンドについて**

`trans`コマンドは、プロジェクトのルートディレクトリからREADMEファイルを読み取り、それを複数言語に翻訳する純粋なテキスト翻訳機能です。プロジェクト全体の構造を処理する`gen`コマンドとは異なり、`trans`はREADMEの内容にのみ焦点を当てています。

- プロジェクトのルートディレクトリからREADME.mdファイルを読み取る
- 指定された言語に内容を翻訳する
- `gen`と同じ解析および生成ロジックを使用して、複数言語のREADMEファイルを生成する
- APIリクエストに`code_text`パラメータを含めない（純粋なテキスト翻訳）
- `gen`コマンドと同じオプションをサポートして一貫性を保つ

**.gitignoreサポートについて**

翻訳者は、プロジェクトのルートディレクトリにある`.gitignore`ファイルを自動的に検出し、無視されるファイルやディレクトリをフィルタリングします。これにより、プロジェクト内の本当に重要なソースコードファイルのみが翻訳され、一時ファイル、ビルドアーティファクト、依存関係パッケージなどが回避されます。

- プロジェクトに`.gitignore`ファイルがある場合、自動的にフィルタリングルールを適用します。
- `.gitignore`ファイルがない場合、すべてのテキストファイルを読み取ります。
- 標準の`.gitignore`構文（ワイルドカード、ディレクトリパターンなど）をサポートします。
- `README.md`ファイルを優先的に読み取り、その後他のソースコードファイルを読み取ります。

**🔍 全体のコード読み取りロジック**

DuoReadmeは、翻訳される内容が包括的かつ正確であることを確保するために、インテリジェントなプロジェクト内容読み取り戦略を採用しています：

#### 1. ファイルスキャン戦略
```
プロジェクトのルートディレクトリ
├── README.md （優先読み取り）
├── .gitignore （フィルタリング用）
├── src/ （ソースコードディレクトリ）
├── lib/ （ライブラリファイルディレクトリ）
├── docs/ （ドキュメントディレクトリ）
└── その他の設定ファイル
```

#### 2. 読み取り優先順位
1. **README.md** - メインプロジェクトドキュメント、優先読み取りおよび圧縮処理
2. **ソースコードファイル** - 重要度によって読み取り
3. **設定ファイル** - プロジェクト設定ファイル
4. **ドキュメントファイル** - その他のドキュメント説明

#### 3. コンテンツ処理ワークフロー

##### 3.1 ファイルフィルタリング
- 自動的に`.gitignore`ルールを適用
- バイナリファイル、一時ファイル、ビルドアーティファクトをフィルタリング
- テキストファイルのみを処理（.md, .py, .js, .java, .cpp など）

##### 3.2 コンテンツ圧縮
- **README.md**: 3000文字に圧縮し、核心内容を保持
- **ソースコードファイル**: 重要なファイルをインテリジェントに選択し、各ファイルを2000文字に圧縮
- **総コンテンツ制限**: 1回の翻訳あたり最大15KB、長いコンテンツは自動的にバッチ処理

##### 3.3 インテリジェント選択
- 主要論理を含むファイルを優先
- テストファイル、サンプルファイル、一時ファイルをスキップ
- キーとなる関数定義、クラス定義、コメントを保持

#### 4. バッチ処理メカニズム
プロジェクト内容が15KBを超える場合、システムは自動的にバッチ処理を行います：

```
コンテンツ分析 → ファイルグループ分け → バッチ翻訳 → 結果のマージ
```

- **ファイルグループ分け**: ファイルタイプと重要度でグループ分け
- **バッチ翻訳**: 1回のバッチで15KBのコンテンツを処理
- **結果のマージ**: 複数のバッチからの結果をインテリジェントにマージ

#### 5. サポートされているファイルタイプ
- **ドキュメントファイル**: `.md`, `.txt`, `.rst`
- **ソースコード**: `.py`, `.js`, `.java`, `.cpp`, `.c`, `.go`, `.rs`
- **設定ファイル**: `.yaml`, `.yml`, `.json`, `.toml`
- **その他のテキスト**: `.sql`, `.sh`, `.bat`

#### 6. コンテンツ最適化
- 重複するコンテンツを自動的に削除
- キーとなる構造情報を保持
- 長いテキストのインテリジェント圧縮を行い、読みやすさを維持
- コメントとドキュメント文字列の保持を優先

#### config - 設定情報の表示
```bash
# 現在の組み込み設定を表示
duoreadme config

# 詳細な設定情報を表示するためにデバッグモードを有効にする
duoreadme config --debug
```

#### set - 組み込み設定の更新（開発専用）
```bash
# 新しい設定を組み込み設定に適用（開発/ビルド専用）
duoreadme set my_config.yaml
```

#### export - 組み込み設定のエクスポート
```bash
# 現在の組み込み設定をエクスポート
duoreadme export -o exported_config.yaml
```

#### グローバルオプション

```bash
# バージョン情報を表示
duoreadme --version

# ヘルプ情報を表示
duoreadme --help
```

#### プログラミングインターフェース

```python
from src.core.translator import Translator
from src.core.parser import Parser

# 翻訳者を作成
translator = Translator()

# プロジェクト内容を翻訳
result = translator.translate_project("./sample_project")

# 複数言語の内容を解析
parser = Parser()
readme_dict = parser.parse_multilingual_content(result)
```

## 設定

#### 環境変数

```bash
# テンセントクラウド設定
export TENCENTCLOUD_SECRET_ID="your_secret_id"
export TENCENTCLOUD_SECRET_KEY="your_secret_key"
# アプリケーション設定
export DUOREADME_BOT_APP_KEY="your_bot_app_key"
```

#### 設定ファイル（開発/ビルド専用）

[config.yaml.example](./config.yaml.example)ファイルを確認して、設定ファイルを確認してください。

## ログ

DuoReadmeは、翻訳プロセスの詳細を理解するのに役立つ、完全なログシステムを提供します：

#### ログレベル

- **DEBUG**: 詳細なデバッグ情報（デバッグモードでのみ表示）
- **INFO**: 一般情報（デフォルト表示）
- **WARNING**: 警告情報
- **ERROR**: エラー情報
- **CRITICAL**: 重大なエラー情報

#### 使用方法

##### デバッグモード
```bash
# 詳細なデバッグ情報を含むすべてのログレベルを表示
duoreadme gen --debug
```

##### デバッグ情報には次のものが含まれます
- 設定ファイルの読み取りプロセス
- ファイルスキャンおよびフィルタリングの詳細
- 翻訳リクエストの詳細情報
- コンテンツ圧縮およびバッチ処理プロセス
- ファイル生成および保存ステップ
- エラーおよび例外の詳細情報

## テスト

```bash
# すべてのテストを実行
python -m pytest tests/

# 特定のテストを実行
python -m pytest tests/test_translator.py
```

要件：各言語に対して完全な翻訳を生成し、元の形式および構造を保持します。