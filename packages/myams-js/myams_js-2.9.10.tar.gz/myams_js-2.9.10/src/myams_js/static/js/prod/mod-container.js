!function(a,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var t={exports:{}};e(t.exports),a.modContainer=t.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.container=void 0;const e=MyAMS.$,t=a.container={switchElementAttribute:a=>function(a,t){MyAMS.require("ajax","alert","i18n").then((()=>{const t=a.parents("td").first(),n=e("i",t),s=t.parents("tr"),o=s.parents("table"),r=e(`thead th:nth-child(${t.index()+1})`,o);let d=a.data("ams-location")||r.data("ams-location")||s.data("ams-location")||o.data("ams-location")||"";d&&(d+="/");const l=a.data("ams-update-target")||r.data("ams-update-target")||s.data("ams-update-target")||o.data("ams-update-target")||"switch-element-attribute.json",i=s.data("ams-element-name"),c=n.attr("data-original-title")||n.attr("title");n.tooltip("hide").replaceWith('<i class="fas fa-spinner fa-spin"></i>'),MyAMS.ajax.post(d+l,{object_name:i,attribute_name:r.data("ams-attribute-name")}).then(((a,n,s)=>{let o=e("i",t);"success"===a.status?(a.state?o.replaceWith(`<i class="${r.data("ams-icon-on")}"></i>`):o.replaceWith(`<i class="${r.data("ams-icon-off")}"></i>`),c&&(o=e("i",t),o.addClass("hint").attr("data-original-title",c)),a.handle_json&&MyAMS.ajax.handleJSON(a)):MyAMS.ajax.handleJSON(a)}))}))},moveToGrandParent:(a,t)=>new Promise(((n,s)=>{const o=e(t.draggable),r=e(a.target),d=e(a.target).parents("table"),l=d.data("ams-location");MyAMS.require("ajax","error").then((()=>{MyAMS.ajax.post(`${l}/${r.data("ams-drop-action")||d.data("ams-drop-action")}`,{source:o.data("ams-element-name")}).then((a=>{"success"===a.status?(o.remove(),d.hasClass("datatable")?d.DataTable().row(o).remove().draw():o.remove(),a.handle_json&&MyAMS.ajax.handleJSON(a)):MyAMS.ajax.handleJSON(a),n(a)}))}),s)})),moveToNewParent:(a,t)=>new Promise(((n,s)=>{const o=e(t.draggable),r=e(a.target),d=e(a.target).parents("table"),l=d.data("ams-location");MyAMS.require("ajax","error").then((()=>{MyAMS.ajax.post(`${l}/${r.data("ams-drop-action")||d.data("ams-drop-action")}`,{source:o.data("ams-element-name"),parent:r.data("ams-element-name")}).then((a=>{"success"===a.status?(o.remove(),d.hasClass("datatable")?d.DataTable().row(o).remove().draw():o.remove(),a.handle_json&&MyAMS.ajax.handleJSON(a)):MyAMS.ajax.handleJSON(a),n(a)}))}),s)})),selectElement:a=>{const t=e(a.currentTarget);setTimeout((function(){t.prop("checked",!t.prop("checked")).change()}),50),a.stopPropagation()},selectAllElements:a=>{const t=e(a.currentTarget),n=e(t).parents("table");e('input[type="checkbox"]',n).prop("checked",t.prop("checked"))},getSelectedElements:a=>{const t=e(a).data(),n=t.amsContainerSource,s=e(`input[name="${n}"]`).first().parents("table"),o=e("tbody",s),r=e(`input[name="${n}"]:checked`,o).listattr("value");e(`input[name="${t.amsContainerTarget}"]`).val(r.join(","))},removeSelectedElements:(a,t)=>{const n=t.source,s=e(`input[name="${n}"]`).first().parents("table"),o=e("tbody",s);e(`input[name="${n}"]:checked`,o).parents("tr").each(((a,t)=>{s.hasClass("datatable")?s.DataTable().row(t).remove().draw():e(t).remove()}))},deleteElement:a=>function(a,t){MyAMS.require("ajax","alert","i18n").then((()=>{MyAMS.alert.bigBox({status:"danger",icon:"fas fa-bell",title:MyAMS.i18n.WARNING,message:MyAMS.i18n.CONFIRM_REMOVE,successLabel:MyAMS.i18n.CONFIRM,cancelLabel:MyAMS.i18n.BTN_CANCEL}).then((t=>{if("success"!==t)return;const n=a.parents("td"),s=n.parents("tr"),o=s.parents("table"),r=e(`thead th:nth-child(${n.index()+1})`,o);let d=a.data("ams-location")||r.data("ams-location")||s.data("ams-location")||o.data("ams-location")||"";d&&(d+="/");const l=a.data("ams-delete-target")||r.data("ams-delete-target")||s.data("ams-delete-target")||o.data("ams-delete-target")||"delete-element.json",i=s.data("ams-element-name");MyAMS.ajax.post(d+l,{object_name:i}).then(((a,e,t)=>{"success"===a.status?(o.hasClass("datatable")?o.DataTable().row(s).remove().draw():s.remove(),a.handle_json&&MyAMS.ajax.handleJSON(a)):MyAMS.ajax.handleJSON(a)}))}))}))}};window.MyAMS&&(MyAMS.env.bundle?MyAMS.config.modules.push("container"):(MyAMS.container=t,console.debug("MyAMS: container module loaded...")))}));