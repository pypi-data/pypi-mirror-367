!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var a={exports:{}};t(a.exports),e.modPlugins=a.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.calendar=a,e.checker=n,e.colorPicker=r,e.contextMenu=o,e.datatables=c,e.datetime=l,e.dragdrop=m,e.dropzone=d,e.editor=u,e.fileInput=p,e.imgAreaSelect=M,e.inputMask=y,e.select2=h,e.svgPlugin=b,e.switcher=S,e.tinymce=x,e.treeview=A,e.validate=f;const t=MyAMS.$;if(!t.templates){const e=require("jsrender");t.templates=e.templates}function a(e){return new Promise(((a,s)=>{const n=t(".calendar",e);n.length>0?MyAMS.ajax.check(window.FullCalendar,`${MyAMS.env.baseURL}../ext/fullcalendar-global${MyAMS.env.extext}.js`).then((e=>{n.each(((e,a)=>{const s=t(a),n=s.data(),r={plugins:[],initialView:"dayGridMonth",themeSystem:"bootstrap",locale:t("html").attr("lang"),headerToolbar:{start:"title",center:"today",right:"prev,next"},bootstrapFontAwesome:{prev:"fa-chevron-left",next:"fa-chevron-right"},firstDay:1,weekNumberCalculation:"ISO"};let o=t.extend({},r,n.calendarOptions||n.options);o=MyAMS.core.executeFunctionByName(n.amsCalendarInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.calendar",[s,o,i]),i.veto)return;const c=new FullCalendar.Calendar(a,o);s.trigger("after-init.ams.calendar",[s,c]),c.render()})),a(n)}),s):a(null)}))}const s=t.templates({markup:'\n\t<span class="custom-control custom-switch">\n\t\t<input type="checkbox"\n\t\t\t   id="{{: fieldId }}" name="{{: fieldName }}"\n\t\t\t   class="custom-control-input checker"\n\t\t\t   {{if checked}}checked{{/if}}\n\t\t\t   {{if readonly}}disabled{{/if}}\n\t\t\t   value="{{: value }}" />\n\t\t{{if prefix}}\n\t\t<input type="hidden" class="prefix"\n\t\t\t   id="{{: prefix}}{{: fieldName}}_prefix"\n\t\t\t   name="{{: prefix}}{{: fieldName}}"\n\t\t\t   value="{{if state===\'on\'}}{{: checkedValue}}{{else}}{{: uncheckedValue}}{{/if}}" />\n\t\t{{else marker}}\n\t\t<input type="hidden" class="marker"\n\t\t\t   name="{{: fieldName}}{{: marker}}"\n\t\t\t   value="1" />\n\t\t{{/if}}\n\t\t<label for="{{: fieldId }}"\n\t\t\t   class="custom-control-label">\n\t\t\t{{: legend }}\n\t\t</label>\n\t</span>\n'});function n(e){return new Promise((a=>{const n=t("legend.checker",e);n.length>0?(n.each(((e,a)=>{const n=t(a),r=n.data();if(!r.amsChecker){const e=n.parent("fieldset"),a=r.amsCheckerState||r.amsState,o=e.hasClass("switched")||"on"===a,i=r.amsCheckerFieldname||r.amsFieldname||`checker_${MyAMS.core.generateId()}`,c=i.replace(/\./g,"_"),l=r.amsCheckerHiddenPrefix||r.amsHiddenPrefix,m=r.amsCheckerMarker||r.amsMarker||!1,d=r.amsCheckerMode||r.amsMode||"hide",u=r.amsCheckerValueOn||r.amsValueOn||"true",p=r.amsCheckerValueOff||r.amsValueOff||"false",M=r.amsCheckerValue||r.amsValue,y=r.amsCheckerReadonly||r.amsReadonly,g={legend:n.text(),fieldName:i,fieldId:c,value:M||!0,checked:o,readonly:y,prefix:l,state:a,checkedValue:u,uncheckedValue:p,marker:m},h={veto:!1};if(n.trigger("before-init.ams.checker",[n,g,h]),h.veto)return;n.html(s.render(g)),t("input",n).change((a=>{const s=t(a.target),o=s.is(":checked"),i={veto:!1};if(n.trigger("before-switch.ams.checker",[n,i]),i.veto)s.prop("checked",!o);else if(MyAMS.core.executeFunctionByName(r.amsCheckerChangeHandler||r.amsChangeHandler,document,n,o),!r.amsCheckerCancelDefault&&!r.amsCancelDefault){const t=s.siblings(".prefix");"hide"===d?o?(e.removeClass("switched"),t.val(u),n.trigger("opened.ams.checker",[n])):(e.addClass("switched"),t.val(p),n.trigger("closed.ams.checker",[n])):(e.prop("disabled",!o),t.val(o?u:p))}})),n.closest("form").on("reset",(()=>{const e=t(".checker",n);e.prop("checked")!==o&&e.click()})),o||("hide"===d?e.addClass("switched"):e.prop("disabled",!0)),n.trigger("after-init.ams.checker",[n]),n.data("ams-checker",!0)}})),a(n)):a(null)}))}function r(e){return new Promise(((a,s)=>{const n=t(".color",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(t.fn.colorpicker,`${MyAMS.env.baseURL}../ext/bootstrap-colorpicker${MyAMS.env.extext}.js`).then((e=>{const r=[];e&&r.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/bootstrap-colorpicker${MyAMS.env.extext}.css`,"colorpicker")),t.when.apply(t,r).then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data(),r={format:n.amsColorpickerFormat||n.amsFormat||"hex",useHashPrefix:!1!==(n.amsColorpickerUseHashPrefix||n.amsUseHashPrefix||!1),useAlpha:!1!==(n.amsColorpickerUseAlpha||n.amsUseAlpha||!1),change:MyAMS.core.getFunctionByName(n.amsColorpickerChange||n.amsChange),colorpickerChange:MyAMS.core.getFunctionByName(n.amsColorpickerPickerChange||n.amsPickerChange),colorpickerCreate:MyAMS.core.getFunctionByName(n.amsColorpickerPickerCreate||n.amsPickerCreate),colorpickerDestroy:MyAMS.core.getFunctionByName(n.amsColorpickerPickerDestroy||n.amsPickerDestroy),colorpickerEnable:MyAMS.core.getFunctionByName(n.amsColorpickerPickerEnable||n.amsPickerEnable),colorpickerDisable:MyAMS.core.getFunctionByName(n.amsColorpickerPickerDisable||n.amsPickerDisable),colorpickerHide:MyAMS.core.getFunctionByName(n.amsColorpickerPickerHide||n.amsPickerHide),colorpickerInvalid:MyAMS.core.getFunctionByName(n.amsColorpickerPickerInvalid||n.amsPickerInvalid),colorpickerShow:MyAMS.core.getFunctionByName(n.amsColorpickerPickerShow||n.amsPickerShow),colorpickerUpdate:MyAMS.core.getFunctionByName(n.amsColorpickerPickerUpdate||n.amsPickerUpdate),mousemove:MyAMS.core.getFunctionByName(n.amsColorpickerMousemove||n.amsMousemove)};let o=t.extend({},r,n.amsColorpickerOptions||n.amsOptions);o=MyAMS.core.executeFunctionByName(n.amsColorpickerInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.colorpicker",[s,o,i]),i.veto)return;const c=s.colorpicker(o);MyAMS.core.executeFunctionByName(n.amsColorpickerAfterInitCallback||n.amsAfterInit,document,s,c,o),s.trigger("after-init.ams.colorpicker",[s,c])})),a(n)}),s)}),s)}),s):a(null)}))}function o(e){return new Promise(((a,s)=>{const n=t(".context-menu",e);n.length>0?MyAMS.require("menu").then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data(),r={menuSelector:n.amsContextmenuSelector||n.amsMenuSelector};let o=t.extend({},r,n.amsContextmenuOptions||n.amsOptions);o=MyAMS.core.executeFunctionByName(n.amsContextmenuInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.contextmenu",[s,o,i]),i.veto)return;const c=s.contextMenu(o);MyAMS.core.executeFunctionByName(n.amsContextmenuAfterInitCallback||n.amsAfterInit,document,s,c,o),s.trigger("after-init.ams.contextmenu",[s,c])})),a(n)}),s):a(null)}))}const i={init:()=>{const e=t.fn.dataTable.ext.type;e.detect.unshift((e=>null!==e&&e.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\/(0[1-9]|1[0-2])\/[0-3][0-9]{3}$/)?"date-euro":null)),e.detect.unshift((e=>null!==e&&e.match(/^(0[1-9]|[1-2][0-9]|3[0-1])\/(0[1-9]|1[0-2])\/[0-3][0-9]{3} - ([0-1][0-9]|2[0-3]):[0-5][0-9]$/)?"datetime-euro":null)),t.extend(e.order,{"numeric-comma-asc":(e,t)=>{let a=e.replace(/,/,".").replace(/ /g,""),s=t.replace(/,/,".").replace(/ /g,"");return a=parseFloat(a),s=parseFloat(s),a<s?-1:a>s?1:0},"numeric-comma-desc":(e,t)=>{let a=e.replace(/,/,".").replace(/ /g,""),s=t.replace(/,/,".").replace(/ /g,"");return a=parseFloat(a),s=parseFloat(s),a<s?1:a>s?-1:0},"date-euro-pre":e=>{const a=t.trim(e);let s;if(""!==a){const e=a.split("/");s=1*(e[2]+e[1]+e[0])}else s=1e7;return s},"date-euro-asc":(e,t)=>e-t,"date-euro-desc":(e,t)=>t-e,"datetime-euro-pre":e=>{const a=t.trim(e);let s;if(""!==a){const e=a.split(" - "),t=e[0].split("/"),n=e[1].split(":");s=1*(t[2]+t[1]+t[0]+n[0]+n[1])}else s=1e11;return s},"datetime-euro-asc":(e,t)=>e-t,"datetime-euro-desc":(e,t)=>t-e})},preReorder:function(e,a){t(e.target).data("ams-reorder-source",a)},reorderRows:function(e){return new Promise(((a,s)=>{const n=t(e.target),r=n.DataTable(),o=n.data();let i,c=o.amsReorderInputTarget,l=o.amsReorderUrl;c||l||a();const m=t(">tbody >tr",n),d=MyAMS.core.getFunctionByName(o.amsReorderData)||"data-ams-row-value";i="function"==typeof d?t.makeArray(m).map(d):m.listattr(d);const u=o.amsReorderSeparator||";";if(c?(c=t(c),c.exists()&&c.val(i.join(u))):i=i.join(u),l){if(l=MyAMS.core.executeFunctionByName(l,document,n)||l,!l.startsWith(window.location.protocol)&&!l.startsWith("/")){const e=n.data("ams-location");l=`${e||""}/${l}`}if(i.length>0){let e;if(o.amsReorderPostData)e=MyAMS.core.executeFunctionByName(o.amsReorderPostData,document,n,i);else{const t=o.amsReorderPostAttr||"order";e={},e[t]=i}MyAMS.require("ajax").then((()=>{MyAMS.ajax.post(l,e).then(((e,s,i)=>{t("td.sorter",n).each(((e,a)=>{t(a).removeData().attr("data-order",e),r.row(t(a).parents("tr").get(0)).invalidate().draw()}));const c=o.amsReorderCallback;c?MyAMS.core.executeFunctionByName(c,document,n,e,s,i).then((function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];a.apply(n,...t)})):MyAMS.ajax.handleJSON(e,n.parents(".dataTables_wrapper")).then((()=>{a(e)}))}),s)}))}}}))}};function c(e){const a=`${MyAMS.env.baseURL}../ext/datatables/`,s=`${MyAMS.env.baseURL}../../css/ext/datatables/`;return new Promise(((n,r)=>{const o=t(".datatable",e);o.length>0?MyAMS.ajax.check(t.fn.dataTable,`${MyAMS.env.baseURL}../ext/datatables/jquery.dataTables${MyAMS.env.extext}.js`).then((e=>{const c=[];e&&(c.push(MyAMS.core.getScript(`${a}dataTables.bootstrap4${MyAMS.env.extext}.js`)),c.push(MyAMS.core.getCSS(`${s}dataTables.bootstrap4${MyAMS.env.extext}.css`,"datatables-bs4"))),t.when.apply(t,c).then((()=>{const c={},l=[],m=[],d=[],u={};o.each(((e,n)=>{const r=t(n),o=r.data();if("default"===o.buttons?(r.attr("data-buttons",'["copy", "print"]'),r.removeData("buttons"),o.buttons=r.data("buttons")):"all"===o.buttons&&(r.attr("data-buttons",'["copy", "csv", "excel", "print", "pdf", "colvis"]'),r.removeData("buttons"),o.buttons=r.data("buttons")),!o.autoFill||u.autoFill||t.fn.dataTable.AutoFill||(l.push(`${a}dataTables.autoFill${MyAMS.env.extext}.js`),m.push(`${a}autoFill.bootstrap4${MyAMS.env.extext}.js`),c["dt-autofill-bs4"]=`${s}autoFill.bootstrap4${MyAMS.env.extext}.css`,u.autoFill=!0),o.buttons&&(u.buttons||t.fn.dataTable.Buttons||(l.push(`${a}dataTables.buttons${MyAMS.env.extext}.js`),m.push(`${a}buttons.bootstrap4${MyAMS.env.extext}.js`),m.push(`${a}buttons.html5${MyAMS.env.extext}.js`),c["dt-buttons-bs4"]=`${s}buttons.bootstrap4${MyAMS.env.extext}.css`,u.buttons=!0),t.isArray(o.buttons))){const e=[];for(const s of o.buttons)switch(s){case"copy":e.push({extend:"copyHtml5",exportOptions:{columns:":not(.no-export):visible"}});break;case"csv":e.push({extend:"csvHtml5",exportOptions:{columns:":not(.no-export):visible"}});break;case"excel":u.buttons_excel||t.fn.dataTable.ext.buttons.excelHtml5||(l.push(`${a}jszip${MyAMS.env.extext}.js`),u.buttons_excel=!0),e.push({extend:"excelHtml5",exportOptions:{columns:":not(.no-export):visible"}});break;case"pdf":u.buttons_pdf||window.pdfMake||(l.push(`${a}pdfmake${MyAMS.env.extext}.js`),m.push(`${a}vfs_fonts${MyAMS.env.extext}.js`),u.buttons_pdf=!0),e.push({extend:"pdfHtml5",exportOptions:{columns:":not(.no-export):visible"}});break;case"print":u.buttons_print||t.fn.dataTable.ext.buttons.print||(d.push(`${a}buttons.print${MyAMS.env.extext}.js`),u.buttons_print=!0),e.push({extend:"print",exportOptions:{columns:":not(.no-export):visible"}});break;case"colvis":u.buttons_colvis||t.fn.dataTable.ext.buttons.colvis||(d.push(`${a}buttons.colVis${MyAMS.env.extext}.js`),u.buttons_colvis=!0),e.push({extend:"colvis"})}o.buttons=e}!o.colReorder||u.colReorder||t.fn.dataTable.ColReorder||(l.push(`${a}dataTables.colReorder${MyAMS.env.extext}.js`),m.push(`${a}colReorder.bootstrap4${MyAMS.env.extext}.js`),c["dt-colreorder-bs4"]=`${s}colReorder.bootstrap4${MyAMS.env.extext}.css`,u.colReorder=!0),!o.fixedColumns||u.fixedColumns||t.fn.dataTable.FixedColumns||(l.push(`${a}dataTables.fixedColumns${MyAMS.env.extext}.js`),m.push(`${a}fixedColumns.bootstrap4${MyAMS.env.extext}.js`),c["dt-fixedcolumns-bs4"]=`${s}fixedColumns.bootstrap4${MyAMS.env.extext}.css`,u.fixedColumns=!0),!o.fixedHeader||u.fixedHeader||t.fn.dataTable.FixedHeader||(l.push(`${a}dataTables.fixedHeader${MyAMS.env.extext}.js`),m.push(`${a}fixedHeader.bootstrap4${MyAMS.env.extext}.js`),c["dt-fixedheader-bs4"]=`${s}fixedHeader.bootstrap4${MyAMS.env.extext}.css`,u.fixedHeader=!0),!o.keyTable||u.keyTable||t.fn.dataTable.KeyTable||(l.push(`${a}dataTables.keyTable${MyAMS.env.extext}.js`),m.push(`${a}keyTable.bootstrap4${MyAMS.env.extext}.js`),c["dt-keytable-bs4"]=`${s}keyTable.bootstrap4${MyAMS.env.extext}.css`,u.keyTable=!0),!1===o.responsive||u.responsive||t.fn.dataTable.Responsive||(l.push(`${a}dataTables.responsive${MyAMS.env.extext}.js`),m.push(`${a}responsive.bootstrap4${MyAMS.env.extext}.js`),c["dt-responsive-bs4"]=`${s}responsive.bootstrap4${MyAMS.env.extext}.css`,u.responsive=!0),!o.rowGroup||u.rowGroup||t.fn.dataTable.RowGroup||(l.push(`${a}dataTables.rowGroup${MyAMS.env.extext}.js`),m.push(`${a}rowGroup.bootstrap4${MyAMS.env.extext}.js`),c["dt-rowgroup-bs4"]=`${s}rowGroup.bootstrap4${MyAMS.env.extext}.css`,u.rowGroup=!0),!o.rowReorder||u.rowReorder||t.fn.dataTable.RowReorder||(l.push(`${a}dataTables.rowReorder${MyAMS.env.extext}.js`),m.push(`${a}rowReorder.bootstrap4${MyAMS.env.extext}.js`),c["dt-rowreorder-bs4"]=`${s}rowReorder.bootstrap4${MyAMS.env.extext}.css`,u.rowReorder=!0),!o.scroller||u.scroller||t.fn.dataTable.Scroller||(l.push(`${a}dataTables.scroller${MyAMS.env.extext}.js`),m.push(`${a}scroller.bootstrap4${MyAMS.env.extext}.js`),c["dt-scroller-bs4"]=`${s}scroller.bootstrap4${MyAMS.env.extext}.css`,u.scroller=!0),!o.searchBuilder||u.searchBuilder||t.fn.dataTable.SearchBuilder||(l.push(`${a}dataTables.searchBuilder${MyAMS.env.extext}.js`),m.push(`${a}searchBuilder.bootstrap4${MyAMS.env.extext}.js`),c["dt-searchbuilder-bs4"]=`${s}searchBuilder.bootstrap4${MyAMS.env.extext}.css`,u.searchBuilder=!0),!o.searchPanes||u.searchPanes||t.fn.dataTable.SearchPanes||(u.select||t.fn.dataTable.select||(l.push(`${a}dataTables.select${MyAMS.env.extext}.js`),m.push(`${a}select.bootstrap4${MyAMS.env.extext}.js`),c["dt-select-bs4"]=`${s}select.bootstrap4${MyAMS.env.extext}.css`,u.select=!0),m.push(`${a}dataTables.searchPanes${MyAMS.env.extext}.js`),d.push(`${a}searchPanes.bootstrap4${MyAMS.env.extext}.js`),c["dt-searchpanes-bs4"]=`${s}searchPanes.bootstrap4${MyAMS.env.extext}.css`,u.searchPanes=!0),!o.select||u.select||t.fn.dataTable.select||(l.push(`${a}dataTables.select${MyAMS.env.extext}.js`),m.push(`${a}select.bootstrap4${MyAMS.env.extext}.js`),c["dt-select-bs4"]=`${s}select.bootstrap4${MyAMS.env.extext}.css`,u.select=!0),!o.stateRestore||u.stateRestore||t.fn.dataTables.stateRestore||(l.push(`${a}dataTables.stateRestore${MyAMS.env.extext}.js`),m.push(`${a}stateRestore.bootstrap4${MyAMS.env.extext}.js`),c["dt-staterestore-bs4"]=`${s}stateRestore.bootstrap4${MyAMS.env.extext}.css`,u.stateRestore=!0)})),t.when.apply(t,l.map(MyAMS.core.getScript)).then((()=>t.when.apply(t,m.map(MyAMS.core.getScript)).then((()=>t.when.apply(t,d.map(MyAMS.core.getScript)).then((()=>{e&&i.init();for(const[e,t]of Object.entries(c))MyAMS.core.getCSS(t,e);o.each(((e,a)=>{const s=t(a);if(t.fn.dataTable.isDataTable(s))return;const n=s.data();let r=n.amsDatatableDom||n.amsDom||n.dom||"";r||(n.buttons&&(r+="<'row px-4 float-right'B>"),n.searchBuilder&&(r+="Q"),n.searchPanes&&(r+="P"),!1===n.searching&&!1===n.lengthChange||(r+="<'row px-2'",!1!==n.searching&&(r+="<'col-sm-6 col-md-8'f>"),!1!==n.lengthChange&&(r+="<'col-sm-6 col-md-4'l>"),r+=">"),r+="<'row'<'col-sm-12'tr>>",!1===n.info&&!1===n.paging||(r+="<'row px-2 py-1'",!1!==n.info&&(r+="<'col-sm-12 col-md-5'i>"),!1!==n.paging&&(r+="<'col-sm-12 col-md-7'p>"),r+=">")),(n.buttons||n.searchBuilder||n.searchPanes||!1!==n.searching)&&!1!==n.lengthChange||s.siblings("h3").addClass("mb-0");const o={language:n.amsDatatableLanguage||n.amsLanguage||MyAMS.i18n.plugins.datatables,responsive:!0,dom:r};let c=n.amsDatatableOrder||n.amsOrder;if("string"==typeof c){const e=c.split(";");c=[];for(const t of e){const e=t.split(",");e[0]=parseInt(e[0]),c.push(e)}}c&&(o.order=c);const l=t("thead th",s),m=[];l.each(((e,a)=>{m[e]=t(a).data("ams-column")||{}}));const d=l.listattr("data-ams-sortable");for(const e of d.entries()){const[t,a]=e;n.rowReorder?m[t].sortable=!1:void 0!==a&&(m[t].sortable="string"==typeof a?JSON.parse(a):a)}const u=l.listattr("data-ams-type");for(const e of u.entries()){const[t,a]=e;void 0!==a&&(m[t].type=a)}o.columns=m;let p=t.extend({},o,n.amsDatatableOptions||n.amsOptions);p=MyAMS.core.executeFunctionByName(n.amsDatatableInitCallback||n.amsInit,document,s,p)||p;const M={veto:!1};s.trigger("before-init.ams.datatable",[s,p,M]),M.veto||setTimeout((()=>{t.fn.dataTable.Buttons&&(t.fn.dataTable.Buttons.defaults.dom.button.className=n.amsDatatableButtonsClassname||n.amsButtonsClassname||"btn btn-sm btn-secondary");const e=s.DataTable(p);MyAMS.core.executeFunctionByName(n.amsDatatableAfterInitCallback||n.amsAfterInit,document,s,e,p),s.trigger("after-init.ams.datatable",[s,e]),p.rowReorder&&(e.on("pre-row-reorder",MyAMS.core.getFunctionByName(n.amsDatatablePreReorder||n.amsPreReorder)||i.preReorder),e.on("row-reorder",MyAMS.core.getFunctionByName(n.amsDatatableReordered||n.amsReordered)||i.reorderRows))}),100)})),n(o)}),r)),r)),r)}),r)}),r):n(null)}))}function l(e){return new Promise(((a,s)=>{const n=t(".datetime",e);n.length>0?MyAMS.ajax.check(window.moment,`${MyAMS.env.baseURL}../ext/moment${MyAMS.env.extext}.js`).then((()=>{MyAMS.ajax.check(t.fn.datetimepicker,`${MyAMS.env.baseURL}../ext/tempusdominus-bootstrap4${MyAMS.env.extext}.js`).then((e=>{const s=[];e&&s.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/tempusdominus-bootstrap4${MyAMS.env.extext}.css`,"tempusdominus")),t.when.apply(t,s).then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data(),r={locale:n.amsDatetimeLanguage||n.amsLanguage||MyAMS.i18n.language,icons:{time:"far fa-clock",date:"far fa-calendar",up:"fas fa-arrow-up",down:"fas fa-arrow-down",previous:"fas fa-chevron-left",next:"fas fa-chevron-right",today:"far fa-calendar-check-o",clear:"far fa-trash",close:"far fa-times"},date:s.val(),format:n.amsDatetimeFormat||n.amsFormat};let o=t.extend({},r,n.datetimeOptions||n.options);o=MyAMS.core.executeFunctionByName(n.amsDatetimeInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.datetime",[s,o,i]),i.veto)return;s.datetimepicker(o);const c=s.data("datetimepicker");(n.amsDatetimeIsoTarget||n.amsIsoTarget)&&s.on("change.datetimepicker",(e=>{const a=t(e.currentTarget).data();t(a.amsDatetimeIsoTarget||a.amsIsoTarget).val(e.date?e.date.toISOString(!0):null)})),s.trigger("after-init.ams.datetime",[s,c])})),a(n)}))}),s)}),s):a(null)}))}function m(e){return new Promise(((a,s)=>{const n=t(".draggable, .droppable, .sortable, .resizable",e);n.length>0?MyAMS.ajax.check(t.fn.draggable,`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then((()=>{MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/jquery-ui.structure${MyAMS.env.extext}.css`,"jquery-ui").then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data();if(s.hasClass("draggable")){const e={axis:n.amsDraggableAxis||n.amsAxis,cursor:n.amsDraggableCursor||"move",containment:n.amsDraggableContainment||n.amsContainment,delay:n.amsDraggableDelay||n.amsDelay,handle:n.amsDraggableHandle||n.amsHandle,connectToSortable:n.amsDraggableConnectSortable||n.amsConnectSortable,revert:n.amsDraggableRevert||n.amsRevert,revertDuration:n.amsDraggableRevertDuration||n.amsRevertDuration,helper:MyAMS.core.getFunctionByName(n.amsDraggableHelper)||n.amsDraggableHelper,start:MyAMS.core.getFunctionByName(n.amsDraggableStart)||function(e,a){t(e.currentTarget).data("is-dragging",!0)},stop:MyAMS.core.getFunctionByName(n.amsDraggableStop)||function(e,a){setTimeout((()=>{t(e.currentTarget).data("is-dragging",!1)}),100)}};let a=t.extend({},e,n.amsDraggableOptions||n.amsOptions);a=MyAMS.core.executeFunctionByName(n.amsDraggableInitCallback||n.amsInit,document,s,a)||a;const r={veto:!1};if(s.trigger("before-init.ams.draggable",[s,a,r]),r.veto)return;const o=s.draggable(a);s.disableSelection(),MyAMS.core.executeFunctionByName(n.amsDraggableAfterInitCallback||n.amsAfterInit,document,s,o,a),s.trigger("after-init.ams.draggable",[s,o])}if(s.hasClass("droppable")){const e={accept:n.amsDroppableAccept||n.amsAccept,classes:n.amsDroppableClasses,drop:MyAMS.core.getFunctionByName(n.amsDroppableDrop)};let a=t.extend({},e,n.amsDroppableOptions||n.amsOptions);a=MyAMS.core.executeFunctionByName(n.amsDroppableInitCallback||n.amsInit,document,s,a)||a;const r={veto:!1};if(s.trigger("before-init.ams.droppable",[s,a,r]),r.veto)return;const o=s.droppable(a);MyAMS.core.executeFunctionByName(n.amsDroppableAfterInitCallback||n.amsAfterInit,document,s,o,a),s.trigger("after-init.ams.droppable",[s,o])}if(s.hasClass("sortable")){const e={items:n.amsSortableItems,handle:n.amsSortableHandle,helper:MyAMS.core.getFunctionByName(n.amsSortableHelper)||n.amsSortableHelper,connectWith:n.amsSortableConnectwith,containment:n.amsSortableContainment,placeholder:n.amsSortablePlaceholder,start:MyAMS.core.getFunctionByName(n.amsSortableStart),over:MyAMS.core.getFunctionByName(n.amsSortableOver),stop:MyAMS.core.getFunctionByName(n.amsSortableStop)};let a=t.extend({},e,n.amsSortableOptions||n.amsOptions);a=MyAMS.core.executeFunctionByName(n.amsSortableInitCallback||n.amsInit,document,s,a)||a;const r={veto:!1};if(s.trigger("before-init.ams.sortable",[s,a,r]),r.veto)return;const o=s.sortable(a);s.disableSelection(),MyAMS.core.executeFunctionByName(n.amsSortableAfterInitCallback||n.amsAfterInit,document,s,o,a),s.trigger("after-init.ams.sortable",[s,o])}if(s.hasClass("resizable")){const e={autoHide:!1===n.amsResizableAutohide||n.amsResizableAutohide,containment:n.amsResizableContainment,grid:n.amsResizableGrid,handles:n.amsResizableHandles,start:MyAMS.core.getFunctionByName(n.amsResizableStart),resize:MyAMS.core.getFunctionByName(n.amsResizableResize),stop:MyAMS.core.getFunctionByName(n.amsResizableStop)};let a=t.extend({},e,n.amsResizableOptions||n.amsOptions);a=MyAMS.core.executeFunctionByName(n.amsResizableInitCallback||n.amsInit,document,s,a)||a;const r={veto:!1};if(s.trigger("before-init.ams.resizable",[s,a,r]),r.veto)return;const o=s.resizable(a);s.disableSelection(),MyAMS.core.executeFunctionByName(n.amsResizableAfterInitCallback||n.amsAfterInit,document,s,o,a),s.trigger("after-init.ams.resizable",[s,o])}})),a(n)}))}),s):a(null)}))}function d(e){return new Promise(((a,s)=>{const n=t(".dropzone",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(t.fn.dropzone,`${MyAMS.env.baseURL}../ext/dropzone.min.js`).then((e=>{const s=[];e&&s.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/dropzone${MyAMS.env.extext}.css`,"dropzone")),t.when.apply(t,s).then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data(),r={paramName:n.amsDropzoneParamName||n.amsParamName||"form.widgets.data",url:n.amsDropzoneUrl||n.amsUrl||"upload-file.json",uploadMultiple:!1!==n.amsDropzoneUploadMultiple&&!1!==n.amsUploadMultiple,parallelUploads:n.amsDropzoneParallelUploads||n.amsParallelUploads||10,maxFilesize:n.amsDropzoneMaxFilesize||n.amsMaxFilesize,thumbnailWidth:n.amsDropzoneThumbnailWidth||n.amsThumbnailWidth||128,thumbnailHeight:n.amsDropzoneThumbnailHeight||n.amsThumbnailHeight||128,thumbnailMethod:n.amsDropzoneThumbnailMethod||n.amsThumbnailMethod||"contain",clickable:0!=n.amsDropzoneClickable&&!1!==n.amsCLickable,acceptedFiles:n.amsDropzoneAcceptedFiles||n.amsAcceptedFiles,success:MyAMS.core.getFunctionByName(n.amsDropzoneSuccess||n.amsSuccess)||function(e,t,a){MyAMS.ajax.handleJSON(t)}};let o=t.extend({},r,n.amsDropzoneOptions||n.amsOptions);o=MyAMS.core.executeFunctionByName(n.amsDropzoneInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.dropzone",[s,o,i]),i.veto)return;const c=s.dropzone(o);s.trigger("after-init.ams.dropzone",[s,c])})),a(n)}))}),s)}),s):a(null)}))}function u(e){return new Promise(((a,s)=>{const n=t(".editor textarea",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(window.ace,`${MyAMS.env.baseURL}../ext/ace/ace${MyAMS.env.extext}.js`).then((e=>{const s=window.ace,r=[];e&&(s.config.set("basePath",`${MyAMS.env.baseURL}../ext/ace`),r.push(MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/ace/ext-modelist${MyAMS.env.extext}.js`))),t.when.apply(t,r).then((()=>{n.each(((e,a)=>{const n=t(a),r=n.parents(".editor"),o=n.data(),i=s.require("ace/ext/modelist"),c=o.amsEditorMode||o.amsMode||i.getModeForPath(o.amsEditorFilename||o.amsFilename||"text.txt").mode;setTimeout((()=>{const e=t("<div>",{position:"absolute",width:n.width(),height:n.height(),class:n.attr("class")}).insertBefore(n);n.css("display","none");const a={mode:c,fontSize:"12px",tabSize:4,useSoftTabs:!1,showGutter:!0,showLineNumbers:!0,printMargin:132,showInvisibles:!0};let i=t.extend({},a,o.amsEditorOptions||o.amsOptions);i=MyAMS.core.executeFunctionByName(o.amsEditorInitCallback||o.amsInit,document,n,i)||i;const l={veto:!1};if(n.trigger("before-init.ams.editor",[n,i,l]),l.veto)return;const m=s.edit(e[0]);m.setOptions(i),"darkmode"===MyAMS.theme?m.setTheme("ace/theme/dracula"):m.setTheme("ace/theme/textmate"),m.session.setValue(n.val()),n.attr("disabled")&&m.setReadOnly(!0),m.session.on("change",(()=>{n.val(m.session.getValue())})),r.data("editor",m),MyAMS.core.executeFunctionByName(o.amsEditorAfterEditCallback||o.amsAfterInit,document,n,m,i),n.trigger("after-init.ams.editor",[n,m])}),200)})),a(n)}))}))}),s):a(null)}))}function p(e){return new Promise(((a,s)=>{const n=t(".custom-file-input",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(window.bsCustomFileInput,`${MyAMS.env.baseURL}../ext/bs-custom-file-input${MyAMS.env.extext}.js`).then((()=>{setTimeout((()=>{n.each(((e,a)=>{const s=t(a),n=s.attr("id"),r=n?`#${n}`:s.attr("name"),o=t(a.form),i=o.attr("id"),c=i?`#${i}`:o.attr("name"),l={veto:!1};s.trigger("before-init.ams.fileinput",[s,l]),l.veto||(bsCustomFileInput.init(r,c),s.trigger("after-init.ams.fileinput",[s]))})),a(n)}),250)}),s)}),s):a(null)}))}function M(e){return new Promise(((a,s)=>{const n=t(".imgareaselect",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(t.fn.imgAreaSelect,`${MyAMS.env.baseURL}../ext/jquery-imgareaselect${MyAMS.env.extext}.js`).then((e=>{const r=[];e&&r.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/imgareaselect-animated${MyAMS.env.extext}.css`,"imgareaselect")),t.when.apply(t,r).then((()=>{n.each(((e,a)=>{const s=t(a);if(s.data("imgAreaSelect"))return;const n=s.data(),r=n.amsImgareaselectParent||n.amsParent,o=r?s.parents(r):"body",i={instance:!0,handles:!0,parent:o,x1:n.amsImgareaselectX1||n.amsX1||0,y1:n.amsImgareaselectY1||n.amsY1||0,x2:n.amsImgareaselectX2||n.amsX2||n.amsImgareaselectImageWidth||n.amsImageWidth,y2:n.amsImgareaselectY2||n.amsY2||n.amsImgareaselectImageHeight||n.amsImageHeight,imageWidth:n.amsImgareaselectImageWidth||n.amsImageWidth,imageHeight:n.amsImgareaselectImageHeight||n.amsImageHeight,imgWidth:n.amsImgareaselectThumbWidth||n.amsThumbWidth,imgHeight:n.amsImgareaselectThumbHeight||n.amsThumbHeight,minWidth:128,minHeight:128,aspectRatio:n.amsImgareaselectAspectRatio||n.amsAspectRatio,onSelectEnd:MyAMS.core.getFunctionByName(n.amsImgareaselectSelectEnd||n.amsSelectedEnd)||function(e,a){const s=n.amsImgareaselectTargetField||n.amsTargetField||"image_";t(`input[name="${s}x1"]`,o).val(a.x1),t(`input[name="${s}y1"]`,o).val(a.y1),t(`input[name="${s}x2"]`,o).val(a.x2),t(`input[name="${s}y2"]`,o).val(a.y2)}};let c=t.extend({},i,n.amsImgareaselectOptions||n.amsOptions);c=MyAMS.core.executeFunctionByName(n.amsImgareaselectInitCallback||n.amsInit,document,s,c)||c;const l={veto:!1};s.trigger("before-init.ams.imgareaselect",[s,c,l]),l.veto||setTimeout((()=>{const e=s.imgAreaSelect(c);s.trigger("after-init.ams.imgareaselect",[s,e])}),200)})),a(n)}),s)}),s)}),s):a(null)}))}function y(e){return new Promise(((a,s)=>{const n=t("input[data-input-mask]",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(t.fn.inputmask,`${MyAMS.env.baseURL}../ext/jquery-inputmask${MyAMS.env.extext}.js`).then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data();let r;r="object"==typeof n.inputMask?n.inputMask:{mask:n.inputMask.toString()};let o=t.extend({},r,n.amsInputMaskOptions||n.amsOptions);o=MyAMS.core.executeFunctionByName(n.amsInputmaskInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.inputmask",[s,o,i]),i.veto)return;const c=s.inputmask(o);MyAMS.core.executeFunctionByName(n.amsInputmaskAfterInitCallback||n.amsAfterInit,document,s,c,o),s.trigger("after-init.ams.inputmask",[s,c])})),a(n)}),s)}),s):a(null)}))}const g={select2UpdateHiddenField:e=>{const t=[];e.parent().find("ul.select2-selection__rendered").children("li[title]").each(((a,s)=>{t.push(e.children(`option[data-content="${s.title}"]`).attr("value"))})),e.data("select2-target").val(t.join(e.data("ams-select2-separator")||","))},select2AjaxParamsHelper:(e,t)=>Object.assign({},e,t)};function h(e){return new Promise(((a,s)=>{const n=t(".select2",e);n.length>0?MyAMS.require("ajax","helpers").then((()=>{MyAMS.ajax.check(t.fn.select2,`${MyAMS.env.baseURL}../ext/select2/select2${MyAMS.env.extext}.js`).then((e=>{const r=[];e&&r.push(MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/select2/i18n/${MyAMS.i18n.language}.js`)),t.when.apply(t,r).then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data();if(n.select2)return;const r={theme:n.amsSelect2Theme||n.amsTheme||"bootstrap4",language:n.amsSelect2Language||n.amsLanguage||MyAMS.i18n.language,escapeMarkup:MyAMS.core.getFunctionByName(n.amsSelect2EscapeMarkup||n.amsEscapeMarkup),matcher:MyAMS.core.getFunctionByName(n.amsSelect2Matcher||n.amsMatcher),sorter:MyAMS.core.getFunctionByName(n.amsSelect2Sorter||n.amsSorter),templateResult:MyAMS.core.getFunctionByName(n.amsSelect2TemplateResult||n.amsTemplateResult),templateSelection:MyAMS.core.getFunctionByName(n.amsSelect2TemplateSelection||n.amsTemplateSelection),tokenizer:MyAMS.core.getFunctionByName(n.amsSelect2Tokenizer||n.amsTokenizer)};if(n.amsSelect2AjaxUrl||n.amsAjaxUrl||n["ajax-Url"]){let e;const t=MyAMS.core.getFunctionByName(n.amsSelect2AjaxParams||n.amsAjaxParams||n["ajax-Params"])||n.amsSelect2AjaxParams||n.amsAjaxParams||n["ajax-Params"];"function"==typeof t?e=t:t&&(e=e=>g.select2AjaxParamsHelper(e,t)),r.ajax={url:MyAMS.core.getFunctionByName(n.amsSelect2AjaxUrl||n.amsAjaxUrl)||n.amsSelect2AjaxUrl||n.amsAjaxUrl,data:e||MyAMS.core.getFunctionByName(n.amsSelect2AjaxData||n.amsAjaxData)||n.amsSelect2AjaxData||n.amsAjaxData,processResults:MyAMS.core.getFunctionByName(n.amsSelect2AjaxProcessResults||n.amsAjaxProcessResults)||n.amsSelect2AjaxProcessResults||n.amsAjaxProcessResults,transport:MyAMS.core.getFunctionByName(n.amsSelect2AjaxTransport||n.amsAjaxTransport)||n.amsSelect2AjaxTransport||n.amsAjaxTransport},r.minimumInputLength=n.amsSelect2MinimumInputLength||n.amsMinimumInputLength||n.minimumInputLength,void 0===r.minimumInputLength&&(r.minimumInputLength=1)}if(s.hasClass("sortable")){const e=t(`<input type="hidden" name="${s.attr("name")}">`).insertAfter(s);e.val(t("option:selected",s).listattr("value").join(n.amsSelect2Separator||",")),s.data("select2-target",e).removeAttr("name"),r.templateSelection=e=>{const a=t(e.element);return a.attr("data-content",a.html()),e.text}}let o=t.extend({},r,n.amsSelect2Options||n.amsOptions);o=MyAMS.core.executeFunctionByName(n.amsSelect2InitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.select2",[s,o,i]),i.veto)return;const c=s.select2(o);s.on("select2:opening select2:selecting select2:unselecting select2:clearing",(e=>{if(t(e.target).is(":disabled"))return!1})),s.on("select2:opening",(e=>{const a=t(e.currentTarget).parents(".modal").first();if(a.exists()){const e=parseInt(a.css("z-index"));c.data("select2").$dropdown.css("z-index",e+1)}})),s.on("select2:open",(()=>{setTimeout((()=>{const e=t(".select2-search__field",c.data("select2").$dropdown);e.exists()&&e.get(0).focus()}),50)})),s.hasClass("sortable")&&MyAMS.ajax.check(t.fn.sortable,`${MyAMS.env.baseURL}../ext/jquery-ui${MyAMS.env.extext}.js`).then((()=>{s.parent().find("ul.select2-selection__rendered").sortable({containment:"parent",update:()=>{g.select2UpdateHiddenField(s)}}),s.on("select2:select select2:unselect",(e=>{const a=e.params.data.id,s=t(e.currentTarget),n=s.children(`option[value="${a}"]`);MyAMS.helpers.moveElementToParentEnd(n),s.trigger("change"),g.select2UpdateHiddenField(s)}))})),MyAMS.core.executeFunctionByName(n.amsSelect2AfterInitCallback||n.amsAfterInit,document,s,c,o),s.trigger("after-init.ams.select2",[s,c])})),a(n)}),s)}),s)}),s):a(null)}))}function b(e){return new Promise((a=>{const s=t(".svg-container",e);s.length>0?(s.each(((e,a)=>{const s=t(a),n=t("svg",s),r=n.attr("width"),o=n.attr("height");r&&o&&a.setAttribute("viewBox",`0 0 ${Math.round(parseFloat(r))} ${Math.round(parseFloat(o))}`),n.attr("width","100%").attr("height","auto")})),a(s)):a(null)}))}function S(e){return new Promise((a=>{const s=t("legend.switcher",e);s.length>0?(s.each(((e,a)=>{const s=t(a),n=s.parent("fieldset"),r=s.data(),o=r.amsSwitcherState||r.amsState,i=r.amsSwitcherMinusClass||r.amsMinusClass||"chevron-down",c=r.amsSwitcherPlusClass||r.amsPlusClass||"chevron-right";if(!r.amsSwitcher){const e={veto:!1};if(s.trigger("before-init.ams.switcher",[s,r,e]),e.veto)return;t(`<i class="fa fa-fw fa-${"open"===o?i:c} mr-2"></i>`).prependTo(s),s.on("click",(e=>{e.preventDefault();const a={};if(s.trigger("before-switch.ams.switcher",[s,a]),!a.veto)if(n.hasClass("switched")){n.removeClass("switched"),MyAMS.core.switchIcon(t("i",s),c,i),s.trigger("opened.ams.switcher",[s]);const e=s.attr("id");e&&t(`legend.switcher[data-ams-switcher-sync="${e}"]`,n).each(((e,a)=>{const s=t(a);s.parents("fieldset").hasClass("switched")&&s.click()}))}else n.addClass("switched"),MyAMS.core.switchIcon(t("i",s),i,c),s.trigger("closed.ams.switcher",[s])})),"open"!==o&&n.addClass("switched"),s.trigger("after-init.ams.switcher",[s]),s.data("ams-switcher",!0)}})),a(s)):a(null)}))}function x(e){return new Promise(((a,s)=>{const n=t(".tinymce",e);n.length>0?MyAMS.require("ajax","i18n").then((()=>{const e=`${MyAMS.env.baseURL}../ext/tinymce${MyAMS.env.devmode?"/dev":""}`;MyAMS.ajax.check(window.tinymce,`${e}/tinymce${MyAMS.env.extext}.js`).then((r=>{const o=[];r&&(x.baseURL=e,x.suffix=MyAMS.env.extext,o.push(MyAMS.core.getScript(`${e}/jquery.tinymce.min.js`)),o.push(MyAMS.core.getScript(`${e}/themes/silver/theme${MyAMS.env.extext}.js`)),t(document).on("focusin",(e=>{t(e.target).closest(".tox-tinymce, .tox-tinymce-aux, .moxman-window, .tam-assetmanager-root").length&&e.stopImmediatePropagation()})),t(document).on("clear.ams.content",((e,a,s)=>{t(".tinymce",s).each(((e,a)=>{const s=t(a).attr("id"),n=window.tinymce.get(s);null!==n&&n.remove()}))}))),t.when.apply(t,o).then((()=>{n.each(((a,s)=>{const n=t(s),r=n.data(),o={selector:`textarea#${n.attr("id")}`,base_url:e,theme:r.amsTinymceTheme||r.amsTheme||"silver",language:MyAMS.i18n.language,menubar:!1!==r.amsTinymceMenubar&&!1!==r.amsMenubar,statusbar:!1!==r.amsTinymceStatusbar&&!1!==r.amsStatusbar,plugins:r.amsTinymcePlugins||r.amsPlugins||["advlist autosave autolink lists link charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime nonbreaking save table contextmenu directionality","emoticons paste textcolor colorpicker textpattern autoresize"],toolbar:r.amsTinymceToolbar||r.amsToolbar,toolbar1:!1!==r.amsTinymceToolbar1&&!1!==r.amsToolbar1&&(r.amsTinymceToolbar1||r.amsToolbar1||"undo redo | pastetext | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent"),toolbar2:!1!==r.amsTinymceToolbar2&&!1!==r.amsToolbar2&&(r.amsTinymceToolbar2||r.amsToolbar2||"forecolor backcolor emoticons | charmap link image media | fullscreen preview print | code"),content_css:r.amsTinymceContentCss||r.amsContentCss,formats:r.amsTinymceFormats||r.amsFormats,style_formats:r.amsTinymceStyleFormats||r.amsStyleFormats,block_formats:r.amsTinymceBlockFormats||r.amsBlockFormats,valid_classes:r.amsTinymceValidClasses||r.amsValidClasses,relative_urls:!1,remove_script_host:!1,convert_urls:!1,image_advtab:!0,image_list:MyAMS.core.getFunctionByName(r.amsTinymceImageList||r.amsImageList)||r.amsTinymceImageList||r.amsImageList,image_class_list:r.amsTinymceImageClassList||r.amsImageClassList,link_list:MyAMS.core.getFunctionByName(r.amsTinymceLinkList||r.amsLinkList)||r.amsTinymceLinkList||r.amsLinkList,link_class_list:r.amsTinymceLinkClassList||r.amsLinkClassList,paste_as_text:void 0===r.amsTinymcePasteAsText&&void 0===r.amsPasteAsText||(r.amsTinymcePasteAsText||r.amsPasteAsText),paste_auto_cleanup_on_paste:void 0===r.amsTinymcePasteAutoCleanup&&void 0===r.amsPasteAutoCleanup||(r.amsTinymcePasteAutoCleanup||r.amsPasteAutoCleanup),paste_strip_class_attributes:r.amsTinymcePasteStripClassAttributes||r.amsPasteStripClassAttributes||"all",paste_remove_spans:void 0===r.amsTinymcePasteRemoveSpans&&void 0===r.amsPasteRemoveSpans||(r.amsTinymcePasteRemoveSpans||r.amsPasteRemoveSpans),paste_remove_styles:void 0===r.amsTinymcePasteRemoveStyles||void 0===r.amsPasteRemoveStyles||(r.amsTinymcePasteRemoveStyles||r.amsPasteRemoveStyles),height:r.amsTinymceHeight||r.amsHeight||50,min_height:50,resize:!0,autoresize_min_height:50,autoresize_max_height:500},i=r.amsTinymceExternalPlugins||r.amsExternalPlugins;if(i){const e=i.split(/\s+/);for(const t of e){const e=n.data(`ams-tinymce-plugin-${t}`)||n.data(`ams-plugin-${t}`);window.tinymce.PluginManager.load(t,MyAMS.core.getSource(e))}}let c=t.extend({},o,r.amsTinymceOptions||r.amsOptions);c=MyAMS.core.executeFunctionByName(r.amsTinymceInitCallback||r.amsInit,document,n,c)||c;const l={veto:!1};n.trigger("before-init.ams.tinymce",[n,c,l]),l.veto||setTimeout((()=>{const e=n.tinymce(c);MyAMS.core.executeFunctionByName(r.amsTinymceAfterInitCallback||r.amsAfterInit,document,n,e,c),n.trigger("after-init.ams.tinymce",[n,c])}),250)})),a(n)}),s)}),s)}),s):a(null)}))}function A(e){return new Promise(((a,s)=>{const n=t(".treeview",e);n.length>0?MyAMS.require("ajax").then((()=>{MyAMS.ajax.check(t.fn.treview,`${MyAMS.env.baseURL}../ext/bootstrap-treeview${MyAMS.env.extext}.js`).then((e=>{const r=[];e&&r.push(MyAMS.core.getCSS(`${MyAMS.env.baseURL}../../css/ext/bootstrap-treeview${MyAMS.env.extext}.css`,"treeview")),t.when.apply(t,r).then((()=>{n.each(((e,a)=>{const s=t(a),n=s.data(),r={data:n.amsTreeviewData,levels:n.amsTreeviewLevels,injectStyle:n.amsTreeviewInjectStyle,expandIcon:n.amsTreeviewExpandIcon||"far fa-fw fa-plus-square",collapseIcon:n.amsTreeviewCollaspeIcon||"far fa-fw fa-minus-square",emptyIcon:n.amsTreeviewEmptyIcon,nodeIcon:n.amsTreeviewNodeIcon,selectedIcon:n.amsTreeviewSelectedIcon,checkedIcon:n.amsTreeviewCheckedIcon||"far fa-fw fa-check-square",uncheckedIcon:n.amsTreeviewUncheckedIcon||"far fa-fw fa-square",color:n.amsTreeviewColor,backColor:n.amsTreeviewBackColor,borderColor:n.amsTreeviewBorderColor,onHoverColor:n.amsTreeviewHoverColor,selectedColor:n.amsTreeviewSelectedColor,selectedBackColor:n.amsTreeviewSelectedBackColor,unselectableColor:n.amsTreeviewUnselectableColor||"rgba(1,1,1,0.25)",unselectableBackColor:n.amsTreeviewUnselectableBackColor||"rgba(1,1,1,0.25)",enableLinks:n.amsTreeviewEnableLinks,highlightSelected:n.amsTreeviewHighlightSelected,highlightSearchResults:n.amsTreeviewhighlightSearchResults,showBorder:n.amsTreeviewShowBorder,showIcon:n.amsTreeviewShowIcon,showCheckbox:n.amsTreeviewShowCheckbox,showTags:n.amsTreeviewShowTags,toggleUnselectable:n.amsTreeviewToggleUnselectable,multiSelect:n.amsTreeviewMultiSelect,onNodeChecked:MyAMS.core.getFunctionByName(n.amsTreeviewNodeChecked),onNodeCollapsed:MyAMS.core.getFunctionByName(n.amsTreeviewNodeCollapsed),onNodeDisabled:MyAMS.core.getFunctionByName(n.amsTreeviewNodeDisabled),onNodeEnabled:MyAMS.core.getFunctionByName(n.amsTreeviewNodeEnabled),onNodeExpanded:MyAMS.core.getFunctionByName(n.amsTreeviewNodeExpanded),onNodeSelected:MyAMS.core.getFunctionByName(n.amsTreeviewNodeSelected),onNodeUnchecked:MyAMS.core.getFunctionByName(n.amsTreeviewNodeUnchecked),onNodeUnselected:MyAMS.core.getFunctionByName(n.amsTreeviewNodeUnselected),onSearchComplete:MyAMS.core.getFunctionByName(n.amsTreeviewSearchComplete),onSearchCleared:MyAMS.core.getFunctionByName(n.amsTreeviewSearchCleared)};let o=t.extend({},r,n.amsTreeviewOptions);o=MyAMS.core.executeFunctionByName(n.amsTreeviewInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.treeview",[s,o,i]),i.veto)return;const c=s.treeview(o);MyAMS.core.executeFunctionByName(n.amsTreeviewAfterInitCallback||n.amsAfterInit,document,s,c,o),s.trigger("after-init.ams.treeview",[s,c])})),a(n)}),s)}),s)}),s):a(null)}))}function f(e){return new Promise(((a,s)=>{const n=t("form:not([novalidate])",e);n.length>0&&MyAMS.require("ajax","i18n").then((()=>{MyAMS.ajax.check(t.fn.validate,`${MyAMS.env.baseURL}../ext/validate/jquery-validate${MyAMS.env.extext}.js`).then((e=>{e&&"en"!==MyAMS.i18n.language&&MyAMS.core.getScript(`${MyAMS.env.baseURL}../ext/validate/i18n/messages_${MyAMS.i18n.language}${MyAMS.env.extext}.js`).then((()=>{})),n.each(((e,a)=>{const s=t(a),n=s.data(),r={ignore:null,invalidHandler:MyAMS.core.getFunctionByName(n.amsValidateInvalidHandler)||((e,a)=>{t("span.is-invalid",s).remove(),t(".is-invalid",s).removeClass("is-invalid");for(const e of a.errorList){const a=t(e.element),s=a.parents(".tab-pane");a.parents("fieldset.switched").each(((e,a)=>{t("legend.switcher",a).click()})),s.each(((e,a)=>{const s=t(a),n=s.parents(".tab-content").siblings(".nav-tabs");t(`li:nth-child(${s.index()+1})`,n).addClass("is-invalid"),t("li.is-invalid:first a",n).click()}))}}),errorElement:n.amsValidateErrorElement||"span",errorClass:n.amsValidateErrorClass||"is-invalid",errorPlacement:MyAMS.core.getFunctionByName(n.amsValidateErrorPlacement)||((e,t)=>{e.addClass("invalid-feedback"),t.closest(".form-widget").append(e)}),submitHandler:MyAMS.core.getFunctionByName(n.amsValidateSubmitHandler)||(void 0!==s.attr("data-async")?()=>{MyAMS.require("form").then((()=>{MyAMS.form.submit(s)}))}:()=>{s.get(0).submit()})};t("[data-ams-validate-rules]",s).each(((e,a)=>{0===e&&(r.rules={}),r.rules[t(a).attr("name")]=t(a).data("ams-validate-rules")})),t("[data-ams-validate-messages]",s).each(((e,a)=>{0===e&&(r.messages={}),r.messages[t(a).attr("name")]=t(a).data("ams-validate-messages")}));let o=t.extend({},r,n.amsValidateOptions||n.amsOptions);o=MyAMS.core.executeFunctionByName(n.amsValidateInitCallback||n.amsInit,document,s,o)||o;const i={veto:!1};if(s.trigger("before-init.ams.validate",[s,o,i]),i.veto)return;const c=s.validate(o);MyAMS.core.executeFunctionByName(n.amsValidateAfterInitCallback||n.amsAfterInit,document,s,c,o),s.trigger("after-init.ams.validate",[s,c])})),a(n)}),s)}),s)}))}window.MyAMS&&(MyAMS.registry.register(a,"calendar"),MyAMS.registry.register(n,"checker"),MyAMS.registry.register(r,"colorPicker"),MyAMS.registry.register(o,"contextMenu"),MyAMS.registry.register(c,"datatables"),MyAMS.registry.register(l,"datetime"),MyAMS.registry.register(m,"dragdrop"),MyAMS.registry.register(d,"dropzone"),MyAMS.registry.register(u,"editor"),MyAMS.registry.register(p,"fileInput"),MyAMS.registry.register(M,"imgAreaSelect"),MyAMS.registry.register(y,"inputMask"),MyAMS.registry.register(h,"select2"),MyAMS.registry.register(b,"svg"),MyAMS.registry.register(S,"switcher"),MyAMS.registry.register(x,"tinymce"),MyAMS.registry.register(A,"treeview"),MyAMS.registry.register(f,"validate"),MyAMS.config.modules.push("plugins"),MyAMS.env.bundle||console.debug("MyAMS: plugins module loaded..."))}));