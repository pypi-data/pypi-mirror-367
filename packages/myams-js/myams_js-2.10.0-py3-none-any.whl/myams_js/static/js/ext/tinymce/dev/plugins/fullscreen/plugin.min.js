!function(){"use strict";var n=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(n){return{isFullscreen:function(){return null!==n.get()}}},t=function(n){return function(e){return t=typeof(r=e),(null===r?"null":"object"===t&&(Array.prototype.isPrototypeOf(r)||r.constructor&&"Array"===r.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(r)||r.constructor&&"String"===r.constructor.name)?"string":t)===n;var r,t}},o=function(n){return function(e){return typeof e===n}},i=t("string"),u=t("array"),c=o("boolean"),a=function(n){return!function(n){return null==n}(n)},s=o("function"),f=o("number"),l=function(){},m=function(n){return function(){return n}},d=function(n){return n};function h(n){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var o=e.concat(r);return n.apply(null,o)}}var v,g,p=m(!1),w=m(!0),y=function(){return b},b={fold:function(n,e){return n()},isSome:p,isNone:w,getOr:g=d,getOrThunk:v=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(void 0),or:g,orThunk:v,map:y,each:l,bind:y,exists:p,forall:w,filter:function(){return y()},toArray:function(){return[]},toString:m("none()")},S=function(n){var e=m(n),r=function(){return o},t=function(e){return e(n)},o={fold:function(e,r){return r(n)},isSome:w,isNone:p,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:r,orThunk:r,map:function(e){return S(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?o:b},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},x={some:S,none:y,from:function(n){return null==n?b:S(n)}},O=function(){return(O=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},E=function(e){var r=n(x.none()),t=function(){return r.get().each(e)};return{clear:function(){t(),r.set(x.none())},isSet:function(){return r.get().isSome()},get:function(){return r.get()},set:function(n){t(),r.set(x.some(n))}}},F=function(){return E((function(n){return n.unbind()}))},T=Array.prototype.push,k=function(n,e){for(var r=n.length,t=new Array(r),o=0;o<r;o++){var i=n[o];t[o]=e(i,o)}return t},C=function(n,e){for(var r=0,t=n.length;r<t;r++){e(n[r],r)}},D=function(n,e){for(var r=[],t=0,o=n.length;t<o;t++){var i=n[t];e(i,t)&&r.push(i)}return r},A=function(n,e){return function(n,e,r){for(var t=0,o=n.length;t<o;t++){var i=n[t];if(e(i,t))return x.some(i);if(r(i,t))break}return x.none()}(n,e,p)},R=function(n,e){return function(n){for(var e=[],r=0,t=n.length;r<t;++r){if(!u(n[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+n);T.apply(e,n[r])}return e}(k(n,e))},L=function(n){return function(n,e){return e>=0&&e<n.length?x.some(n[e]):x.none()}(n,0)},P=Object.keys,M=function(n,e){return-1!==n.indexOf(e)},N=function(n){return void 0!==n.style&&s(n.style.getPropertyValue)},H=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},W={fromHtml:function(n,e){var r=(e||document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return H(r.childNodes[0])},fromTag:function(n,e){var r=(e||document).createElement(n);return H(r)},fromText:function(n,e){var r=(e||document).createTextNode(n);return H(r)},fromDom:H,fromPoint:function(n,e,r){return x.from(n.dom.elementFromPoint(e,r)).map(H)}};"undefined"!=typeof window?window:Function("return this;")();var q=function(n){return function(e){return function(n){return n.dom.nodeType}(e)===n}},B=q(1),I=q(3),j=q(9),V=q(11),X=function(){return _(0,0)},_=function(n,e){return{major:n,minor:e}},z={nu:_,detect:function(n,e){var r=String(e).toLowerCase();return 0===n.length?X():function(n,e){var r=function(n,e){for(var r=0;r<n.length;r++){var t=n[r];if(t.test(e))return t}}(n,e);if(!r)return{major:0,minor:0};var t=function(n){return Number(e.replace(r,"$"+n))};return _(t(1),t(2))}(n,r)},unknown:X},U=function(n,e){return function(n,e){for(var r=0;r<n.length;r++){var t=e(n[r],r);if(t.isSome())return t}return x.none()}(e.brands,(function(e){var r=e.brand.toLowerCase();return A(n,(function(n){var e;return r===(null===(e=n.brand)||void 0===e?void 0:e.toLowerCase())})).map((function(n){return{current:n.name,version:z.nu(parseInt(e.version,10),0)}}))}))},$=function(n,e){var r=String(e).toLowerCase();return A(n,(function(n){return n.search(r)}))},K=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Y=function(n){return function(e){return M(e,n)}},G=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return M(n,"edge/")&&M(n,"chrome")&&M(n,"safari")&&M(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,K],search:function(n){return M(n,"chrome")&&!M(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return M(n,"msie")||M(n,"trident")}},{name:"Opera",versionRegexes:[K,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Y("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Y("firefox")},{name:"Safari",versionRegexes:[K,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(M(n,"safari")||M(n,"mobile/"))&&M(n,"applewebkit")}}],J=[{name:"Windows",search:Y("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return M(n,"iphone")||M(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Y("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Y("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Y("linux"),versionRegexes:[]},{name:"Solaris",search:Y("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Y("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Y("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Q={browsers:m(G),oses:m(J)},Z=function(n){var e=n.current,r=n.version,t=function(n){return function(){return e===n}};return{current:e,version:r,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t("Firefox"),isSafari:t("Safari")}},nn={unknown:function(){return Z({current:void 0,version:z.unknown()})},nu:Z,edge:m("Edge"),chrome:m("Chrome"),ie:m("IE"),opera:m("Opera"),firefox:m("Firefox"),safari:m("Safari")},en=function(n){var e=n.current,r=n.version,t=function(n){return function(){return e===n}};return{current:e,version:r,isWindows:t("Windows"),isiOS:t("iOS"),isAndroid:t("Android"),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t("Solaris"),isFreeBSD:t("FreeBSD"),isChromeOS:t("ChromeOS")}},rn={unknown:function(){return en({current:void 0,version:z.unknown()})},nu:en,windows:m("Windows"),ios:m("iOS"),android:m("Android"),linux:m("Linux"),osx:m("OSX"),solaris:m("Solaris"),freebsd:m("FreeBSD"),chromeos:m("ChromeOS")},tn=function(n,e,r){var t=Q.browsers(),o=Q.oses(),i=e.bind((function(n){return U(t,n)})).orThunk((function(){return function(n,e){return $(n,e).map((function(n){var r=z.detect(n.versionRegexes,e);return{current:n.name,version:r}}))}(t,n)})).fold(nn.unknown,nn.nu),u=function(n,e){return $(n,e).map((function(n){var r=z.detect(n.versionRegexes,e);return{current:n.name,version:r}}))}(o,n).fold(rn.unknown,rn.nu),c=function(n,e,r,t){var o=n.isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||t("(pointer:coarse)"),a=o||!i&&u&&t("(min-device-width:768px)"),s=i||u&&!a,f=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),l=!s&&!a&&!f;return{isiPad:m(o),isiPhone:m(i),isTablet:m(a),isPhone:m(s),isTouch:m(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:m(f),isDesktop:m(l)}}(u,i,n,r);return{browser:i,os:u,deviceType:c}},on=function(n){return window.matchMedia(n).matches},un=function(n){var e,r=!1;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r||(r=!0,e=n.apply(null,t)),e}}((function(){return tn(navigator.userAgent,x.from(navigator.userAgentData),on)})),cn=function(n,e){var r=n.dom;if(1!==r.nodeType)return!1;var t=r;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},an=function(n){return W.fromDom(n.dom.ownerDocument)},sn=function(n){return function(n){return x.from(n.dom.parentNode).map(W.fromDom)}(n).map(fn).map((function(e){return D(e,(function(e){return r=e,!(n.dom===r.dom);var r}))})).getOr([])},fn=function(n){return k(n.dom.childNodes,W.fromDom)},ln=s(Element.prototype.attachShadow)&&s(Node.prototype.getRootNode),mn=m(ln),dn=ln?function(n){return W.fromDom(n.dom.getRootNode())}:function(n){return j(n)?n:an(n)},hn=function(n){var e,r=dn(n);return V(e=r)&&a(e.dom.host)?x.some(r):x.none()},vn=function(n){return W.fromDom(n.dom.host)},gn=function(n){return a(n.dom.shadowRoot)},pn=function(n){var e=I(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var r,t,o=e.ownerDocument;return hn(W.fromDom(e)).fold((function(){return o.body.contains(e)}),(r=pn,t=vn,function(n){return r(t(n))}))},wn=function(n,e,r){!function(n,e,r){if(!(i(r)||c(r)||f(r)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")}(n.dom,e,r)},yn=function(n,e){var r=n.dom.getAttribute(e);return null===r?void 0:r},bn=function(n,e){n.dom.removeAttribute(e)},Sn=function(n,e){var r=n.dom;!function(n,e){for(var r=P(n),t=0,o=r.length;t<o;t++){var i=r[t];e(n[i],i)}}(e,(function(n,e){!function(n,e,r){if(!i(r))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);N(n)&&n.style.setProperty(e,r)}(r,e,n)}))},xn=function(n,e){return N(n)?n.style.getPropertyValue(e):""},On=function(n){var e,r,t=W.fromDom(function(n){if(mn()&&a(n.target)){var e=W.fromDom(n.target);if(B(e)&&gn(e)&&n.composed&&n.composedPath){var r=n.composedPath();if(r)return L(r)}}return x.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},i=function(){return n.preventDefault()},u=(e=i,r=o,function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(r.apply(null,n))});return function(n,e,r,t,o,i,u){return{target:n,x:e,y:r,stop:t,prevent:o,kill:i,raw:u}}(t,n.clientX,n.clientY,o,i,u,n)},En=function(n,e,r,t,o){var i=function(n,e){return function(r){n(r)&&e(On(r))}}(r,t);return n.dom.addEventListener(e,i,o),{unbind:h(Fn,n,e,i,o)}},Fn=function(n,e,r,t){n.dom.removeEventListener(e,r,t)},Tn=w,kn=function(n,e,r){return function(n,e,r,t){return En(n,e,r,t,!1)}(n,e,Tn,r)},Cn=function(n,e){return{left:n,top:e,translate:function(r,t){return Cn(n+r,e+t)}}},Dn=Cn,An=function(n){var e=void 0===n?window:n;return un().browser.isFirefox()?x.none():x.from(e.visualViewport)},Rn=function(n,e,r,t){return{x:n,y:e,width:r,height:t,right:n+r,bottom:e+t}},Ln=function(n){var e=void 0===n?window:n,r=e.document,t=function(n){var e=void 0!==n?n.dom:document,r=e.body.scrollLeft||e.documentElement.scrollLeft,t=e.body.scrollTop||e.documentElement.scrollTop;return Dn(r,t)}(W.fromDom(r));return An(e).fold((function(){var n=e.document.documentElement,r=n.clientWidth,o=n.clientHeight;return Rn(t.left,t.top,r,o)}),(function(n){return Rn(Math.max(n.pageLeft,t.left),Math.max(n.pageTop,t.top),n.width,n.height)}))},Pn=function(n,e,r){return An(r).map((function(r){var t=function(n){return e(On(n))};return r.addEventListener(n,t),{unbind:function(){return r.removeEventListener(n,t)}}})).getOrThunk((function(){return{unbind:l}}))},Mn=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Nn=tinymce.util.Tools.resolve("tinymce.Env"),Hn=tinymce.util.Tools.resolve("tinymce.util.Delay"),Wn=function(n,e){n.fire("FullscreenStateChanged",{state:e})},qn=function(n){return n.getParam("fullscreen_native",!1,"boolean")},Bn=function(n){var e=W.fromDom(n.getElement());return hn(e).map(vn).getOrThunk((function(){return function(n){var e=n.dom.body;if(null==e)throw new Error("Body is not available yet");return W.fromDom(e)}(an(e))}))},In=function(n){return n.dom===(void 0!==(e=an(n).dom).fullscreenElement?e.fullscreenElement:void 0!==e.msFullscreenElement?e.msFullscreenElement:void 0!==e.webkitFullscreenElement?e.webkitFullscreenElement:null);var e},jn=function(n,e,r){return D(function(n,e){for(var r=s(e)?e:p,t=n.dom,o=[];null!==t.parentNode&&void 0!==t.parentNode;){var i=t.parentNode,u=W.fromDom(i);if(o.push(u),!0===r(u))break;t=i}return o}(n,r),e)},Vn=function(n){return function(n,e){var r,t=void 0===e?document:e.dom;return 1!==(r=t).nodeType&&9!==r.nodeType&&11!==r.nodeType||0===r.childElementCount?[]:k(t.querySelectorAll(n),W.fromDom)}(n)},Xn=function(n,e,r){return jn(n,(function(n){return cn(n,e)}),r)},_n=function(n,e){return function(n,e){return D(sn(n),e)}(n,(function(n){return cn(n,e)}))},zn="data-ephox-mobile-fullscreen-style",Un="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",$n=Nn.os.isAndroid(),Kn=function(n){var e=function(n,e){var r=n.dom,t=window.getComputedStyle(r).getPropertyValue(e);return""!==t||pn(n)?t:xn(r,e)}(n,"background-color");return void 0!==e&&""!==e?"background-color:"+e+"!important":"background-color:rgb(255,255,255)!important;"},Yn=Mn.DOM,Gn=An().fold((function(){return{bind:l,unbind:l}}),(function(n){var e,r=(e=E(l),O(O({},e),{on:function(n){return e.get().each(n)}})),t=F(),o=F(),i=Hn.throttle((function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame((function(){r.on((function(e){return Sn(e,{top:n.offsetTop+"px",left:n.offsetLeft+"px",height:n.height+"px",width:n.width+"px"})}))}))}),50);return{bind:function(n){r.set(n),i(),t.set(Pn("resize",i)),o.set(Pn("scroll",i))},unbind:function(){r.on((function(){t.clear(),o.clear()})),r.clear()}}})),Jn=function(n,e){var r,t,o,i,u=document.body,c=document.documentElement,a=n.getContainer(),s=W.fromDom(a),f=Bn(n),l=e.get(),m=W.fromDom(n.getBody()),d=Nn.deviceType.isTouch(),h=a.style,v=n.iframeElement.style,g=function(n){n(u,"tox-fullscreen"),n(c,"tox-fullscreen"),n(a,"tox-fullscreen"),hn(s).map((function(n){return vn(n).dom})).each((function(e){n(e,"tox-fullscreen"),n(e,"tox-shadowhost")}))},p=function(){var r,t;d&&(r=n.dom,t=Vn("["+zn+"]"),C(t,(function(n){var e=yn(n,zn);"no-styles"!==e?Sn(n,r.parseStyle(e)):bn(n,"style"),bn(n,zn)}))),g(Yn.removeClass),Gn.unbind(),x.from(e.get()).each((function(n){return n.fullscreenChangeHandler.unbind()}))};if(l)l.fullscreenChangeHandler.unbind(),qn(n)&&In(f)&&(t=an(f),(o=t.dom).exitFullscreen?o.exitFullscreen():o.msExitFullscreen?o.msExitFullscreen():o.webkitCancelFullScreen&&o.webkitCancelFullScreen()),v.width=l.iframeWidth,v.height=l.iframeHeight,h.width=l.containerWidth,h.height=l.containerHeight,h.top=l.containerTop,h.left=l.containerLeft,r=l.scrollPos,window.scrollTo(r.x,r.y),e.set(null),Wn(n,!1),p(),n.off("remove",p);else{var w=kn(an(f),void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange",(function(r){qn(n)&&(In(f)||null===e.get()||Jn(n,e))})),y={scrollPos:Ln(window),containerWidth:h.width,containerHeight:h.height,containerTop:h.top,containerLeft:h.left,iframeWidth:v.width,iframeHeight:v.height,fullscreenChangeHandler:w};d&&function(n,e,r){var t=function(e){return function(r){var t=yn(r,"style"),o=void 0===t?"no-styles":t.trim();o!==e&&(wn(r,zn,o),Sn(r,n.parseStyle(e)))}},o=Xn(e,"*"),i=R(o,(function(n){return _n(n,"*:not(.tox-silver-sink)")})),u=Kn(r);C(i,t("display:none!important;")),C(o,t("position:absolute!important;"+Un+u)),t((!0===$n?"":"position:absolute!important;")+Un+u)(e)}(n.dom,s,m),v.width=v.height="100%",h.width=h.height="",g(Yn.addClass),Gn.bind(s),n.on("remove",p),e.set(y),qn(n)&&((i=f.dom).requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.webkitRequestFullScreen&&i.webkitRequestFullScreen()),Wn(n,!0)}},Qn=function(n,e){n.addCommand("mceFullScreen",(function(){Jn(n,e)}))},Zn=function(n,e){return function(r){r.setActive(null!==e.get());var t=function(n){return r.setActive(n.state)};return n.on("FullscreenStateChanged",t),function(){return n.off("FullscreenStateChanged",t)}}},ne=function(n,e){var r=function(){return n.execCommand("mceFullScreen")};n.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:r,onSetup:Zn(n,e)}),n.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:r,onSetup:Zn(n,e)})};e.add("fullscreen",(function(e){var t=n(null);return e.inline?r(t):(Qn(e,t),ne(e,t),e.addShortcut("Meta+Shift+F","","mceFullScreen"),r(t))}))}();
