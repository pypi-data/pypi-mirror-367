/*! RowReorder 1.5.0
 * Â© SpryMedia Ltd - datatables.net/license
 */
!function(t){if("function"==typeof define&&define.amd)define(["jquery","datatables.net"],(function(e){return t(e,window,document)}));else if("object"==typeof exports){var e=require("jquery"),o=function(t,e){e.fn.dataTable||require("datatables.net")(t,e)};"undefined"==typeof window?module.exports=function(r,n){return r||(r=window),n||(n=e(r)),o(r,n),t(n,r,r.document)}:(o(window,e),module.exports=t(e,window,window.document))}else t(jQuery,window,document)}((function(t,e,o){"use strict";var r=t.fn.dataTable,n=function(e,o){if(!r.versionCheck||!r.versionCheck("1.11"))throw"DataTables RowReorder requires DataTables 1.11 or newer";this.c=t.extend(!0,{},r.defaults.rowReorder,n.defaults,o),this.s={bodyTop:null,dt:new r.Api(e),getDataFn:r.util.get(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:r.util.set(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[],rowIndex:0},windowHeight:0,documentOuterHeight:0,domCloneOuterHeight:0,dropAllowed:!0},this.dom={clone:null,cloneParent:null,dtScroll:t("div.dataTables_scrollBody, div.dt-scroll-body",this.s.dt.table().container())};var i=this.s.dt.settings()[0],s=i.rowreorder;if(s)return s;this.dom.dtScroll.length||(this.dom.dtScroll=t(this.s.dt.table().container(),"tbody")),i.rowreorder=this,this._constructor()};t.extend(n.prototype,{_constructor:function(){var e=this,o=this.s.dt,r=t(o.table().node());"static"===r.css("position")&&r.css("position","relative"),t(o.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,(function(r){if(e.c.enable){if(t(r.target).is(e.c.excludedChildren))return!0;var n=t(this).closest("tr"),i=o.row(n);return i.any()?(e._emitEvent("pre-row-reorder",{node:i.node(),index:i.index()}),e._mouseDown(r,n),!1):void 0}})),o.on("destroy.rowReorder",(function(){t(o.table().container()).off(".rowReorder"),o.off(".rowReorder")})),this._keyup=this._keyup.bind(this)},_cachePositions:function(){var r=this.s.dt,n=t(r.table().node()).find("thead").outerHeight(),i=t.unique(r.rows({page:"current"}).nodes().toArray()),s=t.map(i,(function(e,o){var r=t(e).position().top-n;return(r+r+t(e).outerHeight())/2}));this.s.middles=s,this.s.bodyTop=t(r.table().body()).offset().top,this.s.windowHeight=t(e).height(),this.s.documentOuterHeight=t(o).outerHeight(),this.s.bodyArea=this._calcBodyArea()},_clone:function(e){var o=this.s.dt,r=t(o.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(e.clone(!1)),n=e.outerWidth(),i=e.outerHeight(),s=t(t(this.s.dt.table().node()).parent()),d=s.width(),a=s.scrollLeft(),l=e.children().map((function(){return t(this).width()}));r.width(n).height(i).find("tr").children().each((function(t){this.style.width=l[t]+"px"}));var c=t("<div>").addClass("dt-rowReorder-float-parent").width(d).append(r).appendTo("body").scrollLeft(a);this.dom.clone=r,this.dom.cloneParent=c,this.s.domCloneOuterHeight=r.outerHeight()},_clonePosition:function(t){var e,o=this.s.start,r=this._eventToPage(t,"Y")-o.top,n=this._eventToPage(t,"X")-o.left,i=this.c.snapX,s=r+o.offsetTop;e=!0===i?o.offsetLeft:"number"==typeof i?o.offsetLeft+i:n+o.offsetLeft+this.dom.cloneParent.scrollLeft(),s<0?s=0:s+this.s.domCloneOuterHeight>this.s.documentOuterHeight&&(s=this.s.documentOuterHeight-this.s.domCloneOuterHeight),this.dom.cloneParent.css({top:s,left:e})},_emitEvent:function(e,o){var r;return this.s.dt.iterator("table",(function(n,i){var s=t(n.nTable).triggerHandler(e+".dt",o);void 0!==s&&(r=s)})),r},_eventToPage:function(t,e){return-1!==t.type.indexOf("touch")?t.originalEvent.touches[0]["page"+e]:t["page"+e]},_mouseDown:function(r,n){var i=this,s=this.s.dt,d=this.s.start,a=this.c.cancelable,l=n.offset();d.top=this._eventToPage(r,"Y"),d.left=this._eventToPage(r,"X"),d.offsetTop=l.top,d.offsetLeft=l.left,d.nodes=t.unique(s.rows({page:"current"}).nodes().toArray()),this._cachePositions(),this._clone(n),this._clonePosition(r);var c=this._eventToPage(r,"Y")-this.s.bodyTop;d.rowIndex=this._calcRowIndexByPos(c),this.dom.target=n,n.addClass("dt-rowReorder-moving"),t(o).on("mouseup.rowReorder touchend.rowReorder",(function(t){i._mouseUp(t)})).on("mousemove.rowReorder touchmove.rowReorder",(function(t){i._mouseMove(t)})),t(e).width()===t(o).width()&&t(o.body).addClass("dt-rowReorder-noOverflow");var h=this.dom.dtScroll;this.s.scroll={windowHeight:t(e).height(),windowWidth:t(e).width(),dtTop:h.length?h.offset().top:null,dtLeft:h.length?h.offset().left:null,dtHeight:h.length?h.outerHeight():null,dtWidth:h.length?h.outerWidth():null},a&&t(o).on("keyup",this._keyup)},_mouseMove:function(e){this._clonePosition(e);var o=this.s.start,r=this.c.cancelable;if(r){var n=this.s.bodyArea,i=this._calcCloneParentArea();this.s.dropAllowed=this._rectanglesIntersect(n,i),this.s.dropAllowed?t(this.dom.cloneParent).removeClass("drop-not-allowed"):t(this.dom.cloneParent).addClass("drop-not-allowed")}for(var s=this._eventToPage(e,"Y")-this.s.bodyTop,d=this.s.middles,a=null,l=0,c=d.length;l<c;l++)if(s<d[l]){a=l;break}null===a&&(a=d.length),r&&(this.s.dropAllowed||(a=o.rowIndex>this.s.lastInsert?o.rowIndex+1:o.rowIndex),this.dom.target.toggleClass("dt-rowReorder-moving",this.s.dropAllowed)),this._moveTargetIntoPosition(a),this._shiftScroll(e)},_mouseUp:function(e){var o,r,n=this,i=this.s.dt,s=this.c.dataSrc;if(this.s.dropAllowed){var d=this.s.start.nodes,a=t.unique(i.rows({page:"current"}).nodes().toArray()),l={},c=[],h=[],u=this.s.getDataFn,f=this.s.setDataFn;for(o=0,r=d.length;o<r;o++)if(d[o]!==a[o]){var w=i.row(a[o]).id(),p=i.row(a[o]).data(),g=i.row(d[o]).data();w&&(l[w]=u(g)),c.push({node:a[o],oldData:u(p),newData:u(g),newPosition:o,oldPosition:t.inArray(a[o],d)}),h.push(a[o])}var v=[c,{dataSrc:s,nodes:h,values:l,triggerRow:i.row(this.dom.target),originalEvent:e}];if(!1!==this._emitEvent("row-reorder",v)){this._cleanupDragging();var m=function(){if(n.c.update){for(o=0,r=c.length;o<r;o++){var t=i.row(c[o].node).data();f(t,c[o].newData),i.columns().every((function(){this.dataSrc()===s&&i.cell(c[o].node,this.index()).invalidate("data")}))}n._emitEvent("row-reordered",v),i.draw(!1)}};this.c.editor?(this.c.enable=!1,this.c.editor.edit(h,!1,t.extend({submit:"changed"},this.c.formOptions)).multiSet(s,l).one("preSubmitCancelled.rowReorder",(function(){n.c.enable=!0,n.c.editor.off(".rowReorder"),i.draw(!1)})).one("submitUnsuccessful.rowReorder",(function(){i.draw(!1)})).one("submitSuccess.rowReorder",(function(){m()})).one("submitComplete",(function(){n.c.enable=!0,n.c.editor.off(".rowReorder")})).submit()):m()}else n._cancel()}else n._cancel()},_moveTargetIntoPosition:function(e){var o=this.s.dt;if(null===this.s.lastInsert||this.s.lastInsert!==e){var r=t.unique(o.rows({page:"current"}).nodes().toArray()),n="";e>this.s.lastInsert?(this.dom.target.insertAfter(r[e-1]),n="after"):(this.dom.target.insertBefore(r[e]),n="before"),this._cachePositions(),this.s.lastInsert=e,this._emitEvent("row-reorder-changed",{insertPlacement:n,insertPoint:e,row:o.row(this.dom.target)})}},_cleanupDragging:function(){var e=this.c.cancelable;this.dom.clone.remove(),this.dom.cloneParent.remove(),this.dom.clone=null,this.dom.cloneParent=null,this.dom.target.removeClass("dt-rowReorder-moving"),t(o).off(".rowReorder"),t(o.body).removeClass("dt-rowReorder-noOverflow"),clearInterval(this.s.scrollInterval),this.s.scrollInterval=null,e&&t(o).off("keyup",this._keyup)},_shiftScroll:function(r){var n,i,s=this,d=this.s.scroll,a=!1,l=r.pageY-o.body.scrollTop;l<t(e).scrollTop()+65?n=-5:l>d.windowHeight+t(e).scrollTop()-65&&(n=5),null!==d.dtTop&&r.pageY<d.dtTop+65?i=-5:null!==d.dtTop&&r.pageY>d.dtTop+d.dtHeight-65&&(i=5),n||i?(d.windowVert=n,d.dtVert=i,a=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null),!this.s.scrollInterval&&a&&(this.s.scrollInterval=setInterval((function(){if(d.windowVert){var e=t(o).scrollTop();if(t(o).scrollTop(e+d.windowVert),e!==t(o).scrollTop()){var r=parseFloat(s.dom.cloneParent.css("top"));s.dom.cloneParent.css("top",r+d.windowVert)}}if(d.dtVert){var n=s.dom.dtScroll[0];d.dtVert&&(n.scrollTop+=d.dtVert)}}),20))},_calcBodyArea:function(e){var o=this.s.dt,r=t(o.table().body()).offset();return{left:r.left,top:r.top,right:r.left+t(o.table().body()).width(),bottom:r.top+t(o.table().body()).height()}},_calcCloneParentArea:function(e){var o=t(this.dom.cloneParent).offset();return{left:o.left,top:o.top,right:o.left+t(this.dom.cloneParent).width(),bottom:o.top+t(this.dom.cloneParent).height()}},_rectanglesIntersect:function(t,e){return!(t.left>=e.right||e.left>=t.right||t.top>=e.bottom||e.top>=t.bottom)},_calcRowIndexByPos:function(e){var o=this.s.dt,r=t.unique(o.rows({page:"current"}).nodes().toArray()),n=-1,i=t(o.table().node()).find("thead").outerHeight();return t.each(r,(function(o,r){var s=t(r).position().top-i,d=s+t(r).outerHeight();e>=s&&e<=d&&(n=o)})),n},_keyup:function(t){this.c.cancelable&&27===t.which&&(t.preventDefault(),this._cancel())},_cancel:function(){var t=this.s.start,e=t.rowIndex>this.s.lastInsert?t.rowIndex+1:t.rowIndex;this._moveTargetIntoPosition(e),this._cleanupDragging(),this._emitEvent("row-reorder-canceled",[this.s.start.rowIndex])}}),n.defaults={dataSrc:0,editor:null,enable:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0,excludedChildren:"a",cancelable:!1};var i=t.fn.dataTable.Api;return i.register("rowReorder()",(function(){return this})),i.register("rowReorder.enable()",(function(t){return void 0===t&&(t=!0),this.iterator("table",(function(e){e.rowreorder&&(e.rowreorder.c.enable=t)}))})),i.register("rowReorder.disable()",(function(){return this.iterator("table",(function(t){t.rowreorder&&(t.rowreorder.c.enable=!1)}))})),n.version="1.5.0",t.fn.dataTable.RowReorder=n,t.fn.DataTable.RowReorder=n,t(o).on("init.dt.dtr",(function(e,o,i){if("dt"===e.namespace){var s=o.oInit.rowReorder,d=r.defaults.rowReorder;if(s||d){var a=t.extend({},s,d);!1!==s&&new n(o,a)}}})),r}));