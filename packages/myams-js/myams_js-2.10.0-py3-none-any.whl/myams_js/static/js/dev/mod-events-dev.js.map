{"version":3,"file":"mod-events-dev.js","names":["$","MyAMS","_initialized","events","_exports","init","document","on","clickHandler","changeHandler","triggerEvent","initElement","element","each","idx","elt","source","handlers","data","selector","context","parents","event","handler","Object","entries","options","length","core","executeFunctionByName","getHandlers","result","push","currentTarget","amsClickHandler","amsPreventDefault","amsClickPreventDefault","preventDefault","amsStopPropagation","amsClickStopPropagation","stopPropagation","split","callback","getFunctionByName","undefined","call","amsClickHandlerOptions","prop","amsChangeHandler","amsKeepDefault","amsChangeKeepDefault","amsChangeStopPropagation","amsChangeHandlerOptions","target","trigger","env","bundle","config","modules","console","debug"],"sources":["mod-events.js"],"sourcesContent":["/* global MyAMS */\n/**\n * MyAMS events management\n */\n\nconst $ = MyAMS.$;\n\nlet _initialized = false;\n\n\nexport const events = {\n\n\tinit: () => {\n\n\t\tif (_initialized) {\n\t\t\treturn;\n\t\t}\n\t\t_initialized = true;\n\n\t\t// Initialize custom click handlers\n\t\t$(document).on('click', '[data-ams-click-handler]', MyAMS.events.clickHandler);\n\n\t\t// Initialize custom change handlers\n\t\t$(document).on('change', '[data-ams-change-handler]', MyAMS.events.changeHandler);\n\n\t\t// Initialize custom event on click\n\t\t$(document).on('click', '[data-ams-click-event]', MyAMS.events.triggerEvent);\n\n\t},\n\n\tinitElement: (element) => {\n\t\t$('[data-ams-events-handlers]', element).each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tsource = $(elt),\n\t\t\t\thandlers = source.data('ams-events-handlers');\n\t\t\tif (handlers) {\n\t\t\t\tconst\n\t\t\t\t\tselector = source.data('ams-events-handlers-context'),\n\t\t\t\t\tcontext = selector ? source.parents(selector) : source;\n\t\t\t\tfor (const [event, handler] of Object.entries(handlers)) {\n\t\t\t\t\tcontext.on(event, (event, ...options) => {\n\t\t\t\t\t\tif (options.length > 0) {\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(handler, document, event, ...options);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(handler, document, event,\n\t\t\t\t\t\t\t\tsource.data('ams-events-options') || {});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Get events handlers on given element for a specific event\n\t *\n\t * @param element: the checked element\n\t * @param event: event for which handlers lookup is made\n\t * @returns: an array of elements for which the event handler is defined\n\t */\n\tgetHandlers: (element, event) => {\n\n\t\tconst\n\t\t\tresult = [],\n\t\t\thandlers = element.data('ams-events-handlers');\n\t\tif (handlers && handlers[event]) {\n\t\t\tresult.push(element);\n\t\t}\n\t\t$('[data-ams-events-handlers]', element).each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tcontext = $(elt),\n\t\t\t\thandlers = context.data('ams-events-handlers');\n\t\t\tif (handlers && handlers[event]) {\n\t\t\t\tresult.push(context);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\t/**\n\t * Generic click event handler\n\t */\n\tclickHandler: (event) => {\n\t\tconst\n\t\t\tsource = $(event.currentTarget),\n\t\t\thandlers = source.data('ams-disabled-handlers');\n\t\tif ((handlers === true) || (handlers === 'click') || (handlers === 'all')) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = source.data();\n\t\tif (data.amsClickHandler) {\n\t\t\tif ((data.amsPreventDefault !== false) && (data.amsClickPreventDefault !== false)) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tif ((data.amsStopPropagation !== false) && (data.amsClickStopPropagation !== false)) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t\tfor (const handler of data.amsClickHandler.split(/[\\s,;]+/)) {\n\t\t\t\tconst callback = MyAMS.core.getFunctionByName(handler);\n\t\t\t\tif (callback !== undefined) {\n\t\t\t\t\tcallback.call(document, event, data.amsClickHandlerOptions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Generic change event handler\n\t */\n\tchangeHandler: (event) => {\n\t\tconst source = $(event.currentTarget);\n\t\t// Disable change handlers for readonly inputs\n\t\t// These change handlers are activated by IE!!!\n\t\tif (source.prop('readonly')) {\n\t\t\treturn;\n\t\t}\n\t\tconst handlers = source.data('ams-disabled-handlers');\n\t\tif ((handlers === true) || (handlers === 'change') || (handlers === 'all')) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = source.data();\n\t\tif (data.amsChangeHandler) {\n\t\t\tif ((data.amsKeepDefault !== false) && (data.amsChangeKeepDefault !== false)) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tif ((data.amsStopPropagation !== false) && (data.amsChangeStopPropagation !== false)) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t\tfor (const handler of data.amsChangeHandler.split(/[\\s,;]+/)) {\n\t\t\t\tconst callback = MyAMS.core.getFunctionByName(handler);\n\t\t\t\tif (callback !== undefined) {\n\t\t\t\t\tcallback.call(document, event, data.amsChangeHandlerOptions);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Generic click event trigger\n\t */\n\ttriggerEvent: (event) => {\n\t\tconst source = $(event.currentTarget);\n\t\t$(event.target).trigger(source.data('ams-click-event'),\n\t\t\tsource.data('ams-click-event-options'));\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (MyAMS.env.bundle) {\n\tMyAMS.config.modules.push('events');\n} else {\n\tMyAMS.events = events;\n\tconsole.debug(\"MyAMS: events module loaded...\");\n}\n"],"mappings":"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","ignoreList":[]}