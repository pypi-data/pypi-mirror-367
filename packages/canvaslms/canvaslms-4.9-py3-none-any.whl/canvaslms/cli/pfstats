#!/bin/bash

COURSE="$1"
ASSIGNMENT="$2"
shift 2

results=$(mktemp)
canvaslms submissions -c $COURSE -a "$ASSIGNMENT" $@ | cut -f 4- > $results

function get_results() {
  cat $results
}

function print_stats() {
  total=$(get_results | wc -l)
  echo "Total:     $total (100%)"
  Ps=$(get_results | grep ^P | wc -l)
  echo "Ps:        $Ps ($(((100 * $Ps / $total)))%)"
  Fs=$(get_results | grep ^F | wc -l)
  echo "Fs:        $Fs ($(((100 * $Fs / $total)))%)"
  remaining=$(get_results | egrep "^[^PF].*[0-9]{4}-[0-9]{2}-[0-9]{2}" | wc -l)
  echo "Remaining: $remaining ($(((100 * $remaining / $total)))%)"
  nothing=$(get_results | grep "^[^a-fA-F0-9]*$" | wc -l)
  echo "Nothing:   $nothing ($(((100 * $nothing / $total)))%)"
}

print_stats
