import{w as Te,u as ke}from"./store-BDLt0vbv.js";import{q as _e,x as Ce,p as Ee,r as y,l as e}from"./chunk-GNGMS2XR-KLeu_BA0.js";import{a as de,L as De,Z as B,W as P}from"./Layout-CP5Hc7nX.js";import{K as Me}from"./KickoffNavigation-DfJcBmsR.js";import{C as b,a as W,b as Z,c as w,d as Y}from"./card-DNPziUKJ.js";import{T as Se,a as Le,b as L,c as $}from"./tabs-BvsZBTz_.js";import{B as _}from"./badge-CzGG4LGd.js";import{S as ee,I as te,T as $e,a as Ae,b as Ie,A as se,c as ae,d as re,e as ie}from"./scroll-area-DZ28jUC5.js";import{C as Oe,a as Ue}from"./separator-CuiPnxqD.js";import{C as J}from"./clock-D9RgnNZI.js";import{L as ne}from"./play-BgHo1Tz0.js";import{C as le}from"./circle-alert-CVY5oy2y.js";import"./index-BKaxNvVC.js";import"./chevron-down-BlJJcPQY.js";import"./transform-BEtJ_6wc.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],R=de("Brain",Ve);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Fe=de("Users",qe);function it(){return[{title:"CrewAI - Execution Traces"},{name:"description",content:"View execution traces for your CrewAI agents"}]}const nt=Te(function(){_e(),Ce();const{isDarkMode:Pe}=ke(),[ce]=Ee(),A=ce.get("crewId"),[z,oe]=y.useState([]),[t,G]=y.useState(null),[H,K]=y.useState(!0),[X,me]=y.useState(null),[xe,he]=y.useState("overview"),[I,Q]=y.useState(null),[We,C]=y.useState(null),ue=y.useMemo(()=>{var v,M;if(!t)return[];console.log("Creating timeline spans for trace:",{traceId:t.id,hasLLMCalls:!!t.llmCalls,llmCallsCount:((v=t.llmCalls)==null?void 0:v.length)||0,hasToolExecutions:!!t.toolExecutions,toolExecutionsCount:((M=t.toolExecutions)==null?void 0:M.length)||0,agentsCount:Object.keys(t.agents||{}).length,tasksCount:Object.keys(t.tasks||{}).length});const a=[],r=new Date(t.start_time),s=t.end_time?new Date(t.end_time):null,h=s?s.getTime()-r.getTime():0,l={id:t.id,name:`Crew: ${t.crew_name}`,startTime:r,endTime:s,status:t.status,depth:0,duration:h,serviceName:"crew",operation:"execution",children:[]};a.push(l),t.agents&&typeof t.agents=="object"&&Object.values(t.agents).forEach(n=>{const j=new Date(n.start_time),m=n.end_time?new Date(n.end_time):null,p=m?m.getTime()-j.getTime():0,T={id:n.id,name:`Agent: ${n.name}`,startTime:j,endTime:m,status:n.status,parentId:t.id,depth:1,duration:p,serviceName:"agent",operation:n.role,children:[]};a.push(T),n.llmCalls&&n.llmCalls.length>0&&n.llmCalls.forEach((x,S)=>{const f=new Date(x.timestamp),k=x.duration?new Date(f.getTime()+x.duration):x.status==="completed"?new Date(f.getTime()+2e3):null,i={id:`${n.id}-llm-${S}`,name:`LLM Call: ${x.model||"Unknown Model"}`,startTime:f,endTime:k,status:x.status,parentId:n.id,depth:2,duration:x.duration||(k?k.getTime()-f.getTime():0),serviceName:"llm",operation:x.type,children:[]};a.push(i)}),n.toolExecutions&&n.toolExecutions.length>0&&n.toolExecutions.forEach((x,S)=>{const f=new Date(x.timestamp),k=x.duration?new Date(f.getTime()+x.duration):x.status==="completed"?new Date(f.getTime()+1e3):null,i={id:`${n.id}-tool-${S}`,name:`Tool: ${x.tool_name||"Unknown Tool"}`,startTime:f,endTime:k,status:x.status,parentId:n.id,depth:2,duration:x.duration||(k?k.getTime()-f.getTime():0),serviceName:"tool",operation:x.type,children:[]};a.push(i)})}),t.tasks&&typeof t.tasks=="object"&&Object.values(t.tasks).forEach(n=>{const j=new Date(n.start_time),m=n.end_time?new Date(n.end_time):null,p=m?m.getTime()-j.getTime():0,T={id:n.id,name:n.description.length>30?`${n.description.substring(0,30)}...`:n.description,startTime:j,endTime:m,status:n.status,parentId:n.agent_id||t.id,depth:2,duration:p,serviceName:"task",operation:"execution",children:[]};a.push(T)}),t.llmCalls&&t.llmCalls.length>0&&t.llmCalls.forEach((n,j)=>{if(!n.agent_id){const m=new Date(n.timestamp),p=n.duration?new Date(m.getTime()+n.duration):n.status==="completed"?new Date(m.getTime()+2e3):null,T={id:`crew-llm-${j}`,name:`LLM Call: ${n.model||"Unknown Model"}`,startTime:m,endTime:p,status:n.status,parentId:t.id,depth:1,duration:n.duration||(p?p.getTime()-m.getTime():0),serviceName:"llm",operation:n.type,children:[]};a.push(T)}}),t.toolExecutions&&t.toolExecutions.length>0&&t.toolExecutions.forEach((n,j)=>{if(!n.agent_id){const m=new Date(n.timestamp),p=n.duration?new Date(m.getTime()+n.duration):n.status==="completed"?new Date(m.getTime()+1e3):null,T={id:`crew-tool-${j}`,name:`Tool: ${n.tool_name||"Unknown Tool"}`,startTime:m,endTime:p,status:n.status,parentId:t.id,depth:1,duration:n.duration||(p?p.getTime()-m.getTime():0),serviceName:"tool",operation:n.type,children:[]};a.push(T)}});const o=new Map;return a.forEach(n=>o.set(n.id,n)),a.forEach(n=>{n.parentId&&o.has(n.parentId)&&o.get(n.parentId).children.push(n)}),a},[t]);y.useMemo(()=>{if(!t)return 0;const a=new Date(t.start_time).getTime();return(t.end_time?new Date(t.end_time).getTime():Date.now())-a},[t]);const ge=a=>{Q(a)};y.useEffect(()=>{async function a(){try{K(!0);const r=await fetch(`/api/crews/${A}/traces`);if(!r.ok)throw new Error(`Failed to fetch traces: ${r.statusText}`);const h=(await r.json()).map(l=>{const o={...l,agents:l.agents||{},tasks:l.tasks||{},events:l.events||[]},v=pe(o);return{...o,telemetryMetrics:v.metrics,llmCalls:v.llmCalls,toolExecutions:v.toolExecutions}});if(oe(h),h.length>0){const l=h[0];G(l),l.llmCalls&&l.toolExecutions&&l.telemetryMetrics&&C({llmCalls:l.llmCalls,toolExecutions:l.toolExecutions,metrics:l.telemetryMetrics})}}catch(r){console.error("Error fetching traces:",r),me(r instanceof Error?r.message:String(r))}finally{K(!1)}}a()},[A]);const pe=a=>{const r=[],s=[],h=a.events||[],l=new Map,o=new Map;h.forEach(i=>{if(i.type.startsWith("llm.")){const g=`${i.data.agent_id||"unknown"}-${i.data.task_id||"unknown"}`;l.has(g)||l.set(g,{});const d=l.get(g);i.type==="llm.started"?d.started=i:i.type==="llm.completed"?d.completed=i:i.type==="llm.failed"&&(d.failed=i)}else if(i.type.startsWith("tool.")){const g=`${i.data.agent_id||"unknown"}-${i.data.tool_name||"unknown"}`;o.has(g)||o.set(g,{});const d=o.get(g);i.type==="tool.started"?d.started=i:i.type==="tool.completed"?d.completed=i:i.type==="tool.failed"&&(d.failed=i)}}),l.forEach((i,g)=>{var E;const d=i.started,c=i.completed||i.failed;if(d||c){const u=c||d,V=d?new Date(d.timestamp).getTime():new Date(u.timestamp).getTime(),D=c?new Date(c.timestamp).getTime():null,q=D?D-V:void 0,F={id:u.data.id||`llm-${g}-${u.timestamp}`,type:c?c.type:d.type,timestamp:d?d.timestamp:u.timestamp,model:u.data.model||"Unknown Model",prompt:u.data.prompt,completion:c==null?void 0:c.data.completion,tokens:c==null?void 0:c.data.tokens,status:i.completed?"completed":i.failed?"failed":"started",agent_id:u.data.agent_id,agent_name:u.data.agent_name,task_id:u.data.task_id,error:(E=i.failed)==null?void 0:E.data.error,duration:q};r.push(F)}}),o.forEach((i,g)=>{var E;const d=i.started,c=i.completed||i.failed;if(d||c){const u=c||d,V=d?new Date(d.timestamp).getTime():new Date(u.timestamp).getTime(),D=c?new Date(c.timestamp).getTime():null,q=D?D-V:void 0,F={id:u.data.id||`tool-${g}-${u.timestamp}`,type:c?c.type:d.type,timestamp:d?d.timestamp:u.timestamp,tool_name:u.data.tool_name||"Unknown Tool",inputs:u.data.inputs,outputs:c==null?void 0:c.data.outputs,status:i.completed?"completed":i.failed?"failed":"started",agent_id:u.data.agent_id,agent_name:u.data.agent_name,error:(E=i.failed)==null?void 0:E.data.error,duration:q};s.push(F)}});const v=r.length,M=r.filter(i=>i.status==="completed").length,n=r.filter(i=>i.status==="failed").length,j=s.length,m=s.filter(i=>i.status==="completed").length,p=s.filter(i=>i.status==="failed").length,T=r.reduce((i,g)=>i+(g.tokens||0),0),x=a.start_time?new Date(a.start_time).getTime():0,f=(a.end_time?new Date(a.end_time).getTime():Date.now())-x,k={totalLLMCalls:v,totalToolExecutions:j,totalTokens:T,executionTime:f,completedLLMCalls:M,failedLLMCalls:n,completedToolExecutions:m,failedToolExecutions:p};return Object.values(a.agents||{}).forEach(i=>{i.llmCalls=r.filter(g=>g.agent_id===i.id),i.toolExecutions=s.filter(g=>g.agent_id===i.id)}),console.log("Extracted telemetry data:",{llmCallsCount:r.length,toolExecutionsCount:s.length,llmCalls:r.map(i=>({id:i.id,model:i.model,agent_id:i.agent_id,duration:i.duration})),toolExecutions:s.map(i=>({id:i.id,tool_name:i.tool_name,agent_id:i.agent_id,duration:i.duration}))}),{llmCalls:r,toolExecutions:s,metrics:k}};y.useEffect(()=>{t&&t.llmCalls&&t.toolExecutions&&t.telemetryMetrics?C({llmCalls:t.llmCalls,toolExecutions:t.toolExecutions,metrics:t.telemetryMetrics}):C(null)},[t]);const N=a=>new Date(a).toLocaleString(),O=(a,r)=>{if(!a||!r)return"N/A";try{const s=new Date(a).getTime(),l=new Date(r).getTime()-s;if(l<1e3)return`${l}ms`;if(l<6e4)return`${(l/1e3).toFixed(2)}s`;{const o=Math.floor(l/6e4),v=(l%6e4/1e3).toFixed(2);return`${o}m ${v}s`}}catch{return"Invalid time"}},U=a=>{switch(a.toLowerCase()){case"running":case"initializing":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300 border-blue-200 dark:border-blue-800";case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300 border-green-200 dark:border-green-800";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300 border-red-200 dark:border-red-800";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300 border-yellow-200 dark:border-yellow-800";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300 border-gray-200 dark:border-gray-800"}},je=()=>H?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx(ne,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("span",{children:"Loading traces..."})]}):X?e.jsx("div",{className:"p-4 text-red-500",children:X}):z.length===0?e.jsx("div",{className:"p-4 text-gray-500 dark:text-gray-400",children:"No traces found."}):e.jsx("div",{className:"space-y-2",children:z.map(a=>e.jsxs("div",{className:`p-4 rounded-lg cursor-pointer hover:bg-accent/50 ${(t==null?void 0:t.id)===a.id?"bg-accent/50 border border-accent":"border"}`,onClick:()=>{G(a),Q(null),a.llmCalls&&a.toolExecutions&&a.telemetryMetrics?C({llmCalls:a.llmCalls,toolExecutions:a.toolExecutions,metrics:a.telemetryMetrics}):C(null)},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-medium",children:a.crew_name}),e.jsx(_,{variant:a.status==="completed"?"outline":a.status==="running"?"default":"destructive",children:a.status})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground mt-1",children:[e.jsx("div",{children:N(a.start_time)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:[a.agents&&typeof a.agents=="object"?Object.keys(a.agents).length:0," agents"]}),e.jsxs("span",{children:[a.tasks&&typeof a.tasks=="object"?Object.keys(a.tasks).length:0," tasks"]})]})]})]},a.id))}),fe=()=>{if(!t)return null;const a=Object.keys(t.agents).length,r=Object.keys(t.tasks).length,s=t.events.length,h=Object.values(t.agents).filter(o=>o.status==="completed").length,l=Object.values(t.tasks).filter(o=>o.status==="completed").length;return e.jsxs("div",{className:"space-y-6",children:[t.telemetryMetrics&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Telemetry Metrics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(b,{children:e.jsx(w,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.telemetryMetrics.totalLLMCalls}),e.jsx("div",{className:"text-sm text-gray-500",children:"LLM Calls"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[t.telemetryMetrics.completedLLMCalls," completed, ",t.telemetryMetrics.failedLLMCalls," failed"]})]}),e.jsx(R,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(b,{children:e.jsx(w,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.telemetryMetrics.totalToolExecutions}),e.jsx("div",{className:"text-sm text-gray-500",children:"Tool Executions"}),e.jsxs("div",{className:"text-xs text-gray-400",children:[t.telemetryMetrics.completedToolExecutions," completed, ",t.telemetryMetrics.failedToolExecutions," failed"]})]}),e.jsx(P,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(b,{children:e.jsx(w,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.telemetryMetrics.totalTokens.toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Tokens"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Across all LLM calls"})]}),e.jsx(B,{className:"h-8 w-8 text-purple-500"})]})})}),e.jsx(b,{children:e.jsx(w,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.telemetryMetrics.executionTime<6e4?`${(t.telemetryMetrics.executionTime/1e3).toFixed(1)}s`:`${(t.telemetryMetrics.executionTime/6e4).toFixed(1)}m`}),e.jsx("div",{className:"text-sm text-gray-500",children:"Execution Time"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Total duration"})]}),e.jsx($e,{className:"h-8 w-8 text-orange-500"})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(b,{children:e.jsxs(w,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:a}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Agents (",h," completed)"]})]})}),e.jsx(b,{children:e.jsxs(w,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:r}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Tasks (",l," completed)"]})]})}),e.jsx(b,{children:e.jsxs(w,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold",children:s}),e.jsx("div",{className:"text-sm text-gray-500",children:"Events"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Execution Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Crew ID"}),e.jsx("div",{className:"text-sm font-mono",children:t.crew_id}),e.jsx("div",{className:"text-sm text-gray-500",children:"Trace ID"}),e.jsx("div",{className:"text-sm font-mono",children:t.id}),e.jsx("div",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("div",{children:e.jsx(_,{className:U(t.status),children:t.status})}),e.jsx("div",{className:"text-sm text-gray-500",children:"Start Time"}),e.jsx("div",{className:"text-sm",children:N(t.start_time)}),t.end_time&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"End Time"}),e.jsx("div",{className:"text-sm",children:N(t.end_time)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Duration"}),e.jsx("div",{className:"text-sm",children:O(t.start_time,t.end_time)})]})]})]}),e.jsxs(b,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(Z,{className:"text-lg",children:"Execution Timeline"}),e.jsx(Y,{children:"A hierarchical view of the execution spans"})]}),e.jsx(w,{children:e.jsx(Ae,{spans:ue,onSpanClick:ge})})]}),I&&e.jsxs(b,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(Z,{className:"text-lg",children:"Span Details"}),e.jsxs(Y,{children:["Detailed information for the selected span: ",I.name]})]}),e.jsx(w,{children:e.jsx(Ie,{span:I})})]})]})},ye=()=>{if(!t)return null;const a=t.agents&&typeof t.agents=="object"?Object.values(t.agents):[];return a.length===0?e.jsx("div",{className:"p-4 text-gray-500 dark:text-gray-400",children:"No agent data available."}):e.jsx("div",{className:"space-y-4",children:e.jsx(se,{type:"single",collapsible:!0,className:"w-full",children:a.map(r=>e.jsxs(ae,{value:r.id,children:[e.jsx(re,{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 px-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:U(r.status),variant:"outline",children:r.status}),e.jsx("span",{className:"ml-2 font-medium",children:r.name}),e.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:["(",r.role,")"]})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:O(r.start_time,r.end_time)})]})}),e.jsx(ie,{className:"px-4 py-2 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Agent ID"}),e.jsx("div",{className:"text-sm font-mono",children:r.id}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Start Time"}),e.jsx("div",{children:N(r.start_time)}),r.end_time&&e.jsxs("div",{className:"grid grid-cols-2 col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"End Time"}),e.jsx("div",{children:N(r.end_time)})]}),r.llmCalls&&r.llmCalls.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2 flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"LLM Calls (",r.llmCalls.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.llmCalls.map((s,h)=>e.jsxs("div",{className:"border rounded-md p-3 bg-blue-50 dark:bg-blue-900/20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:s.status==="completed"?"default":s.status==="failed"?"destructive":"secondary",children:s.status}),s.model&&e.jsx("span",{className:"text-sm font-mono",children:s.model})]}),e.jsx("span",{className:"text-xs text-gray-500",children:N(s.timestamp)})]}),s.tokens&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:[e.jsx(B,{className:"h-3 w-3 inline mr-1"}),s.tokens," tokens"]}),s.prompt&&e.jsxs("details",{className:"mb-2",children:[e.jsx("summary",{className:"text-sm font-medium cursor-pointer hover:text-blue-600",children:"View Prompt"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-800 rounded text-xs font-mono whitespace-pre-wrap",children:s.prompt.length>500?`${s.prompt.substring(0,500)}...`:s.prompt})]}),s.completion&&e.jsxs("details",{children:[e.jsx("summary",{className:"text-sm font-medium cursor-pointer hover:text-blue-600",children:"View Response"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-800 rounded text-xs font-mono whitespace-pre-wrap",children:s.completion.length>500?`${s.completion.substring(0,500)}...`:s.completion})]}),s.error&&e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:[e.jsx(le,{className:"h-3 w-3 inline mr-1"}),s.error]})]},h))})]}),r.toolExecutions&&r.toolExecutions.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2 flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Tool Executions (",r.toolExecutions.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.toolExecutions.map((s,h)=>e.jsxs("div",{className:"border rounded-md p-3 bg-green-50 dark:bg-green-900/20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:s.status==="completed"?"default":s.status==="failed"?"destructive":"secondary",children:s.status}),s.tool_name&&e.jsx("span",{className:"text-sm font-mono",children:s.tool_name})]}),e.jsx("span",{className:"text-xs text-gray-500",children:N(s.timestamp)})]}),s.inputs&&e.jsxs("details",{className:"mb-2",children:[e.jsx("summary",{className:"text-sm font-medium cursor-pointer hover:text-green-600",children:"View Inputs"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-800 rounded text-xs font-mono",children:JSON.stringify(s.inputs,null,2)})]}),s.outputs&&e.jsxs("details",{children:[e.jsx("summary",{className:"text-sm font-medium cursor-pointer hover:text-green-600",children:"View Outputs"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-100 dark:bg-gray-800 rounded text-xs font-mono",children:JSON.stringify(s.outputs,null,2)})]}),s.error&&e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:[e.jsx(le,{className:"h-3 w-3 inline mr-1"}),s.error]})]},h))})]})]})})]},r.id))})})},Ne=()=>{if(!t)return null;const a=t.tasks&&typeof t.tasks=="object"?Object.values(t.tasks):[];return a.length===0?e.jsx("div",{className:"p-4 text-gray-500 dark:text-gray-400",children:"No task data available."}):e.jsx("div",{className:"space-y-4",children:e.jsx(se,{type:"single",collapsible:!0,className:"w-full",children:a.map(r=>e.jsxs(ae,{value:r.id,children:[e.jsx(re,{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50 px-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:U(r.status),variant:"outline",children:r.status}),e.jsx("span",{className:"ml-2 font-medium truncate max-w-md",children:r.description})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:O(r.start_time,r.end_time)})]})}),e.jsx(ie,{className:"px-4 py-2 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Task ID"}),e.jsx("div",{className:"text-sm font-mono",children:r.id}),r.agent_id&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Assigned Agent"}),e.jsx("div",{className:"text-sm font-mono",children:r.agent_id})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Start Time"}),e.jsx("div",{children:N(r.start_time)}),r.end_time&&e.jsxs("div",{className:"grid grid-cols-2 col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"End Time"}),e.jsx("div",{children:N(r.end_time)})]}),r.output&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Output"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 p-2 rounded-md text-sm whitespace-pre-wrap font-mono",children:r.output})]})]})})]},r.id))})})},ve=a=>a.includes("completed")?{color:"text-green-600",bgColor:"bg-green-100 dark:bg-green-900/30",icon:Oe}:a.includes("failed")||a.includes("error")?{color:"text-red-600",bgColor:"bg-red-100 dark:bg-red-900/30",icon:Ue}:a.includes("started")?{color:"text-blue-600",bgColor:"bg-blue-100 dark:bg-blue-900/30",icon:J}:a.includes("llm")?{color:"text-purple-600",bgColor:"bg-purple-100 dark:bg-purple-900/30",icon:R}:a.includes("tool")?{color:"text-orange-600",bgColor:"bg-orange-100 dark:bg-orange-900/30",icon:P}:{color:"text-gray-600",bgColor:"bg-gray-100 dark:bg-gray-900/30",icon:te},be=()=>{if(!t)return null;const a=Array.isArray(t.events)?t.events:[];if(a.length===0)return e.jsx("div",{className:"p-4 text-gray-500 dark:text-gray-400",children:"No event data available."});const r=[...a].sort((s,h)=>new Date(s.timestamp).getTime()-new Date(h.timestamp).getTime());return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Events Timeline (",r.length,")"]})}),e.jsx(ee,{className:"h-[600px]",children:e.jsx("div",{className:"space-y-3",children:r.map((s,h)=>{const l=ve(s.type),o=l.icon;return e.jsxs("div",{className:`border rounded-lg p-4 ${l.bgColor} hover:shadow-md transition-shadow`,children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:`h-5 w-5 ${l.color} flex-shrink-0`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"outline",className:`${l.color} border-current`,children:s.type}),s.data.agent_name&&e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Agent: ",s.data.agent_name]}),s.data.task_id&&e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Task: ",s.data.task_id]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:N(s.timestamp)})]})]})}),s.data.model&&e.jsxs("div",{className:"mt-2 text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Model:"})," ",s.data.model]}),s.data.tokens&&e.jsxs("div",{className:"mt-1 text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Tokens:"})," ",s.data.tokens]}),s.data.tool_name&&e.jsxs("div",{className:"mt-1 text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Tool:"})," ",s.data.tool_name]}),s.data.error&&e.jsxs("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:[e.jsx("strong",{children:"Error:"})," ",s.data.error]}),Object.keys(s.data).length>0&&e.jsxs("details",{className:"mt-3",children:[e.jsx("summary",{className:"text-sm font-medium cursor-pointer hover:text-blue-600 dark:hover:text-blue-400",children:"View Raw Event Data"}),e.jsx("div",{className:"mt-2 text-xs font-mono bg-gray-50 dark:bg-gray-800 p-3 rounded border overflow-x-auto",children:e.jsx("pre",{children:JSON.stringify(s.data,null,2)})})]})]},h)})})})]})},we=e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Traces"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select a trace to view details"})]}),e.jsx(ee,{className:"h-[500px] border rounded-md",children:e.jsx("div",{className:"p-4",children:je()})})]});return e.jsx(De,{rightSidebar:we,children:e.jsxs("div",{className:"w-full",children:[e.jsx(Me,{crewId:A||void 0}),e.jsx("div",{className:"w-full",children:t?e.jsxs(b,{children:[e.jsx(W,{children:e.jsx(Z,{children:t.crew_name})}),e.jsx(w,{children:e.jsxs(Se,{defaultValue:"overview",value:xe,onValueChange:he,className:"w-full",children:[e.jsxs(Le,{className:"grid grid-cols-4 mb-4",children:[e.jsxs(L,{value:"overview",className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Overview"})]}),e.jsxs(L,{value:"agents",className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Agents"})]}),e.jsx(L,{value:"tasks",children:"Tasks"}),e.jsxs(L,{value:"events",className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Events"})]})]}),e.jsx($,{value:"overview",children:fe()}),e.jsx($,{value:"agents",children:ye()}),e.jsx($,{value:"tasks",children:Ne()}),e.jsx($,{value:"events",children:be()})]})})]}):H?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(ne,{className:"h-8 w-8 animate-spin"})}):e.jsx("div",{className:"text-center p-8 text-gray-500",children:"Select a trace to view details"})})]})})});export{nt as default,it as meta};
