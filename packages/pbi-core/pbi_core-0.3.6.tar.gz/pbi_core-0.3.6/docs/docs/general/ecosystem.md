# Power BI Libraries Overview

**pbi_core**: The main library. This library provides the core functionality for working with Power BI reports. It can:
- Independently create an SSAS backend and load a Power BI report file (.pbix), allowing for programmatic manipulation of Power BI reports.
- Run performance traces and extract the data for visuals, measures, columns, and tables in the Power BI report.
- Provides a full [Pydantic](https://docs.pydantic.dev/latest/) model for the Power BI layout. 

**pbi_parsers**: A library that provides parsers for the DAX and M Query languages used in Power BI. This library allows deeper introspection of the queries used in a report. It also implements basic auto-formatting for DAX queries.

**pbi_translation**: A simple library providing an interface to translate the VisualContainers' Prototype Query to DAX Query. It uses the same library as the PowerBI Desktop to ensure that the DAX Query is identical to the one generated by PowerBI Desktop. This library is used by the pbi_core library to convert the Prototype Query to DAX Query. Please refer to the flowchart below for the process of populating data in Power BI visuals.

**pbi_ruff**: Currently residing in the pbi_core repository, this is a collection of ruff-style rules for Power BI reports. Rules are used to ensure that Power BI reports follow best practices and maintainability standards. Rules are applied to the layout, DAX, and PowerQuery entities in the Power BI report.

**pyadomd**: A fork of the [original pyadomd library](https://github.com/S-C-O-U-T/Pyadomd), which is a Python client for the Microsoft Analysis Services Tabular Data Model. Adds logging, more typing at the C# and python level, and some additional features such as support for streaming results. Additions were done to support various downstream libraries.

**pbi_gui**: A graphical user interface for the PBI_CORE library, providing a user-friendly way to interact with the functionality of the PBI_CORE and pbi_ruff libraries. 

**pbi_server**: A server that provides a REST API for the pbi_core library, allowing for remote access to the functionality of the pbi_core and pbi_ruff libraries. The server is designed to be used in conjunction with the pbi_gui library, but can also be used independently.

```mermaid
flowchart TD
    pbi_server
    pbi_gui
    pbi_core
    pbi_ruff
    pyadomd
    pbi_translation
    pbi_parsers

    pbi_gui -- Uses as a REST API --> pbi_server
    pbi_server -- Uses to retrieve data from reports --> pbi_core
    pbi_server -- Uses to identify issues in reports --> pbi_ruff
    pbi_ruff -- Uses to retrieve data from reports --> pbi_core
    pbi_core -- Used to connect with SSAS backend --> pyadomd
    pbi_core -- Uses to translate Prototype Query to DAX Query --> pbi_translation
    pbi_ruff -- Uses to introspect DAX and M Queries --> pbi_parsers
    ```
## Populating Data in Power BI Visuals

```mermaid
sequenceDiagram
    PowerBI Libs->> Front End: Initializes Frontend from Layout JSON
    PowerBI Libs->> SSAS Backend: Initializes Backend from Datamodel blob
    SSAS Backend->> Front End: Returns reference to Data Model
    Front End->> PowerBI Libs: Requests conversion of the Prototype Query to DAX Query matching the data model found in the SSAS Backend
    PowerBI Libs->> Front End: Returns DAX Query
    Front End->> SSAS Backend: Executes DAX Query
    SSAS Backend->> Front End: Returns Data
```