# Чек-лист для получения цен с маркетплейсов

## Перед началом работы

### ✅ Обязательная подготовка:

- [ ] Убедиться, что используется MCP Playwright сервер
- [ ] Проверить настройки User-Agent
- [ ] Настроить задержки между запросами (2-3 сек)
- [ ] Подготовить обработку ошибок и капчи

## Алгоритм поиска цены

### 1. Переход на маркетплейс

- [ ] Открыть официальный сайт маркетплейса
- [ ] НЕ использовать Google/Yandex поиск
- [ ] Дождаться полной загрузки главной страницы

### 2. Поиск товара

- [ ] Найти поисковую строку на сайте
- [ ] Ввести название товара
- [ ] Дождаться результатов поиска
- [ ] Выбрать наиболее подходящий товар

### 3. Переход на страницу товара

- [ ] Кликнуть на товар из результатов поиска
- [ ] НЕ брать цену из результатов поиска
- [ ] Дождаться полной загрузки страницы товара

### 4. Извлечение данных

- [ ] Найти актуальную цену на странице
- [ ] Проверить наличие товара
- [ ] Учесть скидки и акции
- [ ] Сохранить URL страницы товара

### 5. Валидация данных

- [ ] Проверить соответствие товара искомому
- [ ] Убедиться в разумности цены
- [ ] Проверить валюту (RUB)
- [ ] Убедиться, что товар в наличии

## Специфика маркетплейсов

### KOMUS.RU

- [ ] URL: `https://www.komus.ru`
- [ ] Селекторы цены: `.price-current, .product-price`
- [ ] Особенности: стандартный поиск

### VSEINSTRUMENTI.RU

- [ ] URL: `https://www.vseinstrumenti.ru`
- [ ] Селекторы цены: `.ui-price-current, .product-buy__price`
- [ ] Особенности: динамическая загрузка цен

### OZON.RU

- [ ] URL: `https://www.ozon.ru`
- [ ] Селекторы цены: `[data-widget="webPrice"], .price-current`
- [ ] ⚠️ Особенности: сильная антибот-защита!

### WILDBERRIES.RU

- [ ] URL: `https://www.wildberries.ru`
- [ ] Селекторы цены: `.price-block__final-price, .product-page__price`
- [ ] Особенности: региональные различия цен

### OFFICEMAG.RU

- [ ] URL: `https://www.officemag.ru`
- [ ] Селекторы цены: `.price, .product-price__current`
- [ ] Особенности: простая структура

## Что НЕ делать

### ❌ Запрещенные действия:

- [ ] НЕ использовать Google поиск `"товар site:komus.ru"`
- [ ] НЕ брать цены из поисковых сниппетов
- [ ] НЕ использовать агрегаторы цен
- [ ] НЕ сохранять цены товаров "нет в наличии"
- [ ] НЕ игнорировать проверку соответствия товара

## Сохранение результатов

### ✅ Правильный формат данных:

```json
{
  "marketplace": "komus.ru",
  "price": 1250.0,
  "currency": "RUB",
  "availability": "в наличии",
  "product_url": "https://www.komus.ru/catalog/...",
  "scraped_at": "2025-01-08T15:30:45"
}
```

### ❌ Неправильный формат:

```json
{
  "marketplace": "google.com",
  "price": 0.0,
  "currency": "USD",
  "availability": "нет в наличии",
  "product_url": "https://google.com/search?q=..."
}
```

## Обработка ошибок

### При возникновении проблем:

- [ ] Капча: сообщить об ошибке, не пытаться обойти
- [ ] Блокировка IP: увеличить задержки, сменить User-Agent
- [ ] Товар не найден: попробовать альтернативные запросы
- [ ] Сайт недоступен: пропустить маркетплейс, записать в лог

## Финальная проверка

### Перед сохранением в базу данных:

- [ ] Цена больше 0
- [ ] Валюта = RUB
- [ ] URL ведет на страницу товара
- [ ] Товар соответствует искомому
- [ ] Товар в наличии или доступен для заказа
