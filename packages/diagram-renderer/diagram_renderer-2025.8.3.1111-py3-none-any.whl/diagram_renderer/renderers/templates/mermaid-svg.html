<!DOCTYPE html>
<html>
<head>
    <script>
{mermaid_js_content}
    </script>
</head>
<body>
    <div id="mermaid-output"></div>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                mermaid.initialize({
                    startOnLoad: false,
                    theme: '{theme}',
                    securityLevel: 'loose'
                });
                
                const {svg} = await mermaid.render('diagram', `{clean_code}`);
                document.getElementById('mermaid-output').innerHTML = svg;
                
                // For CLI extraction, we'll just show the SVG
                console.log('SVG_START');
                console.log(svg);
                console.log('SVG_END');
            } catch (error) {
                console.error('Mermaid rendering error:', error);
                document.getElementById('mermaid-output').innerHTML = '<div>Error: ' + error.message + '</div>';
            }
        });
    </script>
</body>
</html>