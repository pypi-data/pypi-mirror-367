{"version":3,"file":"Dashboard.Resource.CQshvyO2.js","sources":["../../src/pages/Dashboard/Resource.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { DashboardCore } from '@splunk/dashboard-core';\nimport { DashboardContextProvider } from '@splunk/dashboard-context';\nimport EnterpriseViewOnlyPreset from '@splunk/dashboard-presets/EnterpriseViewOnlyPreset';\nimport {\n    getActionButtons,\n    waitForElementToDisplay,\n    waitForElementToDisplayAndMoveThemToCanvas,\n} from './utils';\n\nexport const ResourceDashboard = ({\n    dashboardDefinition,\n}: {\n    dashboardDefinition: Record<string, unknown>;\n}) => {\n    useEffect(() => {\n        waitForElementToDisplayAndMoveThemToCanvas(\n            '[data-input-id=\"resource_tab_input\"]',\n            '#resource_tab_description_viz'\n        );\n    }, []);\n\n    useEffect(() => {\n        const modifyNoSearchData = (parentElement: HTMLElement) => {\n            const messageContainer = parentElement.querySelector(\n                '[data-test=\"viz-waiting-for-input-message\"]'\n            );\n\n            if (messageContainer?.textContent === 'No search results returned') {\n                messageContainer.textContent =\n                    'No results found. Resource consumption may not be supported for your operating system.';\n            }\n        };\n\n        const config = { childList: true, subtree: true };\n        const callback = (mutationsList: MutationRecord[]) => {\n            mutationsList.forEach((mutation: MutationRecord) => {\n                if (\n                    mutation.type === 'childList' &&\n                    mutation.addedNodes.length > 0 &&\n                    (mutation.target as HTMLElement).dataset.test === 'viz-size-wrapper'\n                ) {\n                    modifyNoSearchData(mutation.target as HTMLElement);\n                }\n            });\n        };\n        // mutation is used to detect if no data text was displayed\n        // todo: do a better solution\n        const observer = new MutationObserver(callback);\n\n        waitForElementToDisplay(\n            '#resource_tab_cpu_consumption_viz',\n            '#resource_tab_memory_consumption_viz',\n            () => {\n                const cpuConsumption = document.querySelector('#resource_tab_cpu_consumption_viz');\n                const memoryConsumption = document.querySelector(\n                    '#resource_tab_memory_consumption_viz'\n                );\n                if (cpuConsumption) {\n                    modifyNoSearchData(cpuConsumption as HTMLElement);\n                    observer.observe(cpuConsumption, config);\n                }\n\n                if (memoryConsumption) {\n                    modifyNoSearchData(memoryConsumption as HTMLElement);\n                    observer.observe(memoryConsumption, config);\n                }\n            },\n            400,\n            4000\n        );\n\n        return () => {\n            observer.disconnect();\n        };\n    }, [dashboardDefinition]);\n\n    return dashboardDefinition ? (\n        <DashboardContextProvider\n            preset={EnterpriseViewOnlyPreset}\n            initialDefinition={dashboardDefinition}\n        >\n            <DashboardCore width=\"100%\" height=\"auto\" actionMenus={getActionButtons('error')} />\n        </DashboardContextProvider>\n    ) : null;\n};\n\nexport default ResourceDashboard;\n"],"names":["ResourceDashboard","dashboardDefinition","useEffect","waitForElementToDisplayAndMoveThemToCanvas","modifyNoSearchData","parentElement","messageContainer","config","callback","mutationsList","mutation","observer","waitForElementToDisplay","cpuConsumption","memoryConsumption","jsx","DashboardContextProvider","EnterpriseViewOnlyPreset","DashboardCore","getActionButtons"],"mappings":"+UAUO,MAAMA,EAAoB,CAAC,CAC9B,oBAAAC,CACJ,KAGIC,EAAAA,UAAU,IAAM,CACZC,EACI,uCACA,+BAAA,CAER,EAAG,CAAA,CAAE,EAELD,EAAAA,UAAU,IAAM,CACZ,MAAME,EAAsBC,GAA+B,CACvD,MAAMC,EAAmBD,EAAc,cACnC,6CAAA,EAGAC,GAAkB,cAAgB,+BAClCA,EAAiB,YACb,yFAEZ,EAEMC,EAAS,CAAE,UAAW,GAAM,QAAS,EAAA,EACrCC,EAAYC,GAAoC,CAClDA,EAAc,QAASC,GAA6B,CAE5CA,EAAS,OAAS,aAClBA,EAAS,WAAW,OAAS,GAC5BA,EAAS,OAAuB,QAAQ,OAAS,oBAElDN,EAAmBM,EAAS,MAAqB,CAEzD,CAAC,CACL,EAGMC,EAAW,IAAI,iBAAiBH,CAAQ,EAE9C,OAAAI,EACI,oCACA,uCACA,IAAM,CACF,MAAMC,EAAiB,SAAS,cAAc,mCAAmC,EAC3EC,EAAoB,SAAS,cAC/B,sCAAA,EAEAD,IACAT,EAAmBS,CAA6B,EAChDF,EAAS,QAAQE,EAAgBN,CAAM,GAGvCO,IACAV,EAAmBU,CAAgC,EACnDH,EAAS,QAAQG,EAAmBP,CAAM,EAElD,EACA,IACA,GAAA,EAGG,IAAM,CACTI,EAAS,WAAA,CACb,CACJ,EAAG,CAACV,CAAmB,CAAC,EAEjBA,EACHc,EAAAA,IAACC,EAAAA,yBAAA,CACG,OAAQC,EACR,kBAAmBhB,EAEnB,SAAAc,EAAAA,IAACG,iBAAc,MAAM,OAAO,OAAO,OAAO,YAAaC,EAAiB,OAAO,CAAA,CAAG,CAAA,CAAA,EAEtF"}