<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Loading and Examining Data &#8212; Stoner Pacakge API Documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/better.css?v=58ad701a" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=0b74bb8b" />
    <script src="../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plotting Data" href="plotfile.html" />
    <link rel="prev" title="Installation of Stoner Package" href="install.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  </head><body>
    <header id="pageheader"><h1><a href="../index.html ">
        Stoner Pacakge API Documentation
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="install.html" title="Previous document">Installation of Stoner Package</a>
        </li>
        <li>
          <a href="plotfile.html" title="Next document">Plotting Data</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../index.html">Stoner Package</a></li>
      <li>
        <a href="ugindex.html">The Stoner Python Package User Guide</a>
      </li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="loading-and-examining-data">
<h1>Loading and Examining Data<a class="headerlink" href="#loading-and-examining-data" title="Link to this heading">¶</a></h1>
<section id="loading-a-data-file">
<h2>Loading a data file<a class="headerlink" href="#loading-a-data-file" title="Link to this heading">¶</a></h2>
<p>The first step in using the Stoner module is to load some data from a
measurement.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Stoner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Data</span>
<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="s1">&#39;my_data.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example we have loaded data from <code class="docutils literal notranslate"><span class="pre">my_data.txt</span></code> which should be in the
current directory</p>
<p>The <strong>Stoner.Data</strong> class is actually a shorthand for importing the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.core.data.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stoner.core.data.Data</span></code></a>
class which in turn is a superset of many of the classes in the Stoner package. This includes code to automatically
detect the format of many of the measurement files that we use in our research.</p>
<p>The native file format for the Stoner package is known as the <em>TDI 1.5</em> format - a tab delimited text file
that stores arbitrary metadata and a single 2D data set. It closely matches the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> class of the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">Stoner</span></code> module.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> will also read a related text format where the first column of the first line contains the string
<em>TDI Format=Text 1.0</em> which are produced by some of the LabVIEW rigs used by the Device Materials Group in
Cambridge.</p>
</div>
<section id="the-various-flavours-of-the-data-class">
<h3>The Various Flavours of the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> Class<a class="headerlink" href="#the-various-flavours-of-the-data-class" title="Link to this heading">¶</a></h3>
<p>To support a variety of different input file formats, the Stoner package provides a slew of subclasses of the base
<a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> class. Each subclass typically provides its own version of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Data._load()</span></code> method that
understands how to reqad the relevant file.</p>
<section id="base-classes-and-generic-formats">
<h4>Base Classes and Generic Formats<a class="headerlink" href="#base-classes-and-generic-formats" title="Link to this heading">¶</a></h4>
<blockquote>
<div><dl class="simple">
<dt><a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a></dt><dd><p>Tagged Data Interchange Format 1.5 – the default format produced by the LabVIEW measurement rigs in the
CM Physics group in Leeds</p>
</dd>
</dl>
</div></blockquote>
<p>These classes can be used directly to load data from the appropriate format.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">Stoner</span>
<span class="n">d</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_data.txt&quot;</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_VSM_data.fld&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">formats</span><span class="o">.</span><span class="n">instruments</span><span class="o">.</span><span class="n">VSMFile</span><span class="p">)</span>
<span class="n">c</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;, filetype=Stoner.formats.generic.CSVFile)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="../classes/Stoner.Data.load.html#Stoner.Data.load" title="Stoner.Data.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.load()</span></code></a> is a class method, meaning it creates (and returns) a new
instance of the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> class. Most of the methods of <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> objects will return a copy of
the modified instance, allowing a several methods to be chained together into a single operation.</p>
</div>
<p>Sometimes you won’t know exactly which subclass of <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> is the one
to use. Unfortunately, there is no sure fire way of telling, but <a class="reference internal" href="../classes/Stoner.Data.load.html#Stoner.Data.load" title="Stoner.Data.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.load()</span></code></a> will try to do
the best it can and will try all of the subclasses in memory in turn to see if one will
load the file without throwing an error. If this succeeds then the actual type of file that
worked is stored in the metadata of the loaded file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The automatic loading assumes that each load routine does sufficient sanity checking that it will
throw and error if it gets bad data. Whilst one might wish this was always true it relies on
whoever writes the load method to make sure of this ! If you want to stop the automatic guessing
from happening use the <code class="docutils literal notranslate"><span class="pre">auto_load=False</span></code> keyword in the <em>load()</em> method, or provide an explicit <em>filetype</em>
parameter.</p>
</div>
<p>You can also specify a <em>filetype</em> parameter to the <a class="reference internal" href="../classes/Stoner.Data.load.html#Stoner.Data.load" title="Stoner.Data.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.load()</span></code></a> method or directly to the
<a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stoner.Data</span></code></a> constructor as illustrated below to load a simple text file of un labelled numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Stoner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Data</span>
<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="s2">&quot;numbers.txt&quot;</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;JustNumbers&quot;</span><span class="p">,</span><span class="n">column_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">,</span><span class="s2">&quot;I&quot;</span><span class="p">,</span><span class="s2">&quot;dI&quot;</span><span class="p">],</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xye&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If <em>filetype</em> is a string, it can match either the complete name of the subclass to use to load the file, or
part of it.</p>
</section>
</section>
<section id="loading-data-from-a-string-or-iterable-object">
<h3>Loading Data from a string or iterable object<a class="headerlink" href="#loading-data-from-a-string-or-iterable-object" title="Link to this heading">¶</a></h3>
<p>In some circumstances you may have a string representation of a <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object and want to
transform this into a proper <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object. This might be, for example, from transmitting
the data over a network connection or receiving it from another program. In these situations the
<em>left shift operator</em> <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> can be used.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">string_of_data</span>
<span class="n">data</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">iterable_object</span>
</pre></div>
</div>
<p>The second example would allow any object that can be iterated (i.e. has a <em>next()</em> method that returns lines
of the data file, to be used as the source of the data. The <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data()</span></code></a> creates an empty object so
that the left shift operator calls the method in <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> to read the data in. It also
determines the type of the object <code class="docutils literal notranslate"><span class="pre">data</span></code>. This also provides an alternative syntax for reading a file
from disk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;File on Disk.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="constructing-data-s-from-scratch">
<h3>Constructing <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> s from Scratch<a class="headerlink" href="#constructing-data-s-from-scratch" title="Link to this heading">¶</a></h3>
<p>The constructor <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a>, <a class="reference internal" href="../classes/Stoner.Data.__init__.html#Stoner.Data.__init__" title="Stoner.Data.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.__init__()</span></code></a> will try its best to guess what your intention
was in constructing a new instance of a Data. First of all a constructor function is called based on the number of positional
arguments were passed:</p>
<section id="single-argument-constructor">
<h4>Single Argument Constructor<a class="headerlink" href="#single-argument-constructor" title="Link to this heading">¶</a></h4>
<p>A single argument passed to <a class="reference internal" href="../classes/Stoner.Data.__init__.html#Stoner.Data.__init__" title="Stoner.Data.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.__init__()</span></code></a> is interpreted as follows:</p>
<ul class="simple">
<li><p>A string is assumed to be a filename, and therefore a Data is created by loading a file.</p></li>
<li><p>A 2D numpy array is taken as the numeric data for the new Data</p></li>
<li><p>A list or other iterable of strings is assumed to represent the column headers</p></li>
<li><p>A list or other iterable of numpy arrays is assumed to represent a sequence of columns</p></li>
<li><p>A dictionary with string keys and numpy array values of equal length is taken as a set of columns whose
header labels are the keys of the dictionaries.</p></li>
<li><p>A <em>pandas.DataFrame</em> is used to provide data, column headers and if it has a suitable multi-level column index,
the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Stoner.Data.setas</span></code></a> attribute.</p></li>
<li><p>Otherwise a dictionary is treated as the metadata for the new Data instance.</p></li>
</ul>
</section>
<section id="two-argument-constructor">
<h4>Two Argument Constructor<a class="headerlink" href="#two-argument-constructor" title="Link to this heading">¶</a></h4>
<p>If the second argument is a dictionary or a list or other iterables of strings, then the first argument interpreted as for
the sibgle argument constructors above, and then the second argument is interpreted in the same way. (Internally this done by calling the
single argument constructor function twice, once for each argument.)</p>
</section>
<section id="many-argument-constructor">
<h4>Many Argument Constructor<a class="headerlink" href="#many-argument-constructor" title="Link to this heading">¶</a></h4>
<p>If there are more than two arguments and they are numpy arrays, then they are used as the columns of the new Data.</p>
</section>
<section id="keyword-arguments-in-constructor">
<h4>Keyword Arguments in Constructor<a class="headerlink" href="#keyword-arguments-in-constructor" title="Link to this heading">¶</a></h4>
<p>After the positional arguments are dealt with, any keywords that match attriobutes of the Data are used to set the corresponding
attribute.</p>
</section>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a file from disc, set the setas attribute and column headers</span>
<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="s2">&quot;filename.txt&quot;</span><span class="p">,</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">column_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X-Data&quot;</span><span class="p">,</span><span class="s2">&quot;Y-Data&quot;</span><span class="p">])</span>
<span class="c1"># Create a Data from a dictionary:</span>
<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">({</span><span class="s2">&quot;Temperature&quot;</span><span class="p">:</span><span class="n">temp_array</span><span class="p">,</span><span class="s2">&quot;Resistance&quot;</span><span class="p">:</span><span class="n">res_data</span><span class="p">})</span>
<span class="c1"># The same, but set metadata too</span>
<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">({</span><span class="s2">&quot;Temperature&quot;</span><span class="p">:</span><span class="n">temp_array</span><span class="p">,</span><span class="s2">&quot;Resistance&quot;</span><span class="p">:</span><span class="n">res_data</span><span class="p">},{</span><span class="s2">&quot;User&quot;</span><span class="p">:</span><span class="s2">&quot;Fred&quot;</span><span class="p">,</span><span class="s2">&quot;Sample&quot;</span><span class="p">:</span><span class="s2">&quot;X234_a&quot;</span><span class="p">,</span><span class="s2">&quot;Field&quot;</span><span class="p">:</span><span class="mf">2.4</span><span class="p">})</span>
<span class="c1"># From a pandas DataFrame</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">d</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="examining-and-basic-manipulations-of-data">
<h2>Examining and Basic Manipulations of Data<a class="headerlink" href="#examining-and-basic-manipulations-of-data" title="Link to this heading">¶</a></h2>
<section id="data-structure">
<h3>Data Structure<a class="headerlink" href="#data-structure" title="Link to this heading">¶</a></h3>
<section id="data-column-headers-and-metadata">
<h4>Data, Column headers and metadata<a class="headerlink" href="#data-column-headers-and-metadata" title="Link to this heading">¶</a></h4>
<p>Having loaded some data, the next stage might be to take a look at it.
Internally, data is represented as a 2D numpy masked array of floating point numbers,
along with a list of column headers and a dictionary that keeps the metadata and
also keeps track of the expected type of the metadata (ie the meta-metadata).
These can be accessed like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">data</span>
<span class="n">d</span><span class="o">.</span><span class="n">column_headers</span>
<span class="n">d</span><span class="o">.</span><span class="n">metadata</span>
</pre></div>
</div>
<a class="reference external image-reference" href="https://www.youtube.com/watch?v=D67-VZeg7gc"><img alt="Data, column headers and metadata" src="https://i.imgur.com/2wBGSYh.png" style="width: 320px;" />
</a>
</section>
<section id="masked-data-and-why-you-care">
<span id="maskeddata"></span><h4>Masked Data and Why You Care<a class="headerlink" href="#masked-data-and-why-you-care" title="Link to this heading">¶</a></h4>
<p>Masked data arrays differ from normal data arrays in that they include an option to mask or hide individual data elements.
This can be useful to temporarily discount parts of your data when, for example, fitting a curve or calculating a mean
value or plotting some data. One could, of course, simply ignore the masking option and use the data as is,
however, masking does have a number of practical uses.</p>
<p>The data mask can be accessed via the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.mask" title="Stoner.Data.mask"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.mask</span></code></a> attribute of <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy.ma</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ma</span>
<span class="nb">print</span> <span class="n">d</span><span class="o">.</span><span class="n">mask</span>
<span class="n">d</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="kc">False</span>
<span class="n">d</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="n">ma</span><span class="o">.</span><span class="n">nomask</span>
<span class="n">d</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">Fale</span><span class="p">,</span><span class="o">...</span><span class="kc">False</span><span class="p">],</span><span class="o">...</span><span class="p">,[</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="o">...</span><span class="kc">True</span><span class="p">]])</span>
<span class="n">d</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">50</span>
<span class="n">d</span><span class="o">.</span><span class="n">mask</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">50</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
<p>The first line is simply the import statement for the numpy masked arrays in order to get the <em>nomask</em>
symbol. The second line will simply print the current mask. The next two examples will unmask all the data
i.e. make the values visible and usable. The next example illustrates using a numpy array of booleans to
set the mask - every element in the mask array that evaluates as a boolean True will be masked and every
False value unmasked. So far the semantics here are the same as if one had accessed the mask directly on
the data via <code class="docutils literal notranslate"><span class="pre">d.data.mask</span></code> but the final two examples illustrate an extension that setting the
<a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> mask attribute allows. If you pass a callable object to the mask attribute it will
be executed, passing each row of the data array to the user supplied function as a numpy array. The user
supplied function can then either return a single boolean value – in which case it will be used to mask
the entire row – or a list of boolean values to mask individual cells in the current row.</p>
<p>By default when the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object is printed or saved, data values that have been masked are replaced
with a “fill” value of 10^20.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is somewhat dangerous behaviour. Be very careful to remove a mask before saving data if there is any
chance that you will need the masked data values again later !</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Strictgly speaking, the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.data" title="Stoner.Data.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.data</span></code></a> attribute is a sub-class of the numpy masked array, <code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code>.
This works the same way as a masked array, but supports some additional magic indexing and attributes discussed below.</p>
</div>
</section>
</section>
<section id="marking-columns-as-dimensions-the-magic-setas-attribute">
<span id="setas"></span><h3>Marking Columns as Dimensions: the magic <em>setas</em> attribute<a class="headerlink" href="#marking-columns-as-dimensions-the-magic-setas-attribute" title="Link to this heading">¶</a></h3>
<p>Often in a calculation with some data you will be using one column for ‘x’ values and one or more ‘y’ columns
or indeed having ‘z’ column data and uncertainties in all of these (conventionally we call these ‘d’, ‘e’ and ‘f’ columns
so that ‘e’ data is the error in the y data). <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> has a concept of marking a column as containing such data and
will then use these by default in many methods when appropriate to have ‘x’ and ‘y’ data.</p>
<p>In addition to identifying columns as ‘x’,’y’, or ‘z’, for data that describes a vector field, you can mark the columns as containing
‘u’, ‘v’, ‘w’ data where (u,v,w) is the vector value at  the point (x,y,z). There’s no support at present for uncertainties in (u,v,w) being marked.</p>
<a class="reference external image-reference" href="https://www.youtube.com/watch?v=LbSIqxTD9Xc"><img alt="Data, column headers and metadata" src="https://i.imgur.com/vwBUO25.png" style="width: 320px;" />
</a>
<section id="setting-column-types">
<h4>Setting Column Types<a class="headerlink" href="#setting-column-types" title="Link to this heading">¶</a></h4>
<p>To set which columns contain ‘x’,’y’ etc data use the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute. This attribute can take
a list of single character strings from the set ‘x’,’y’,’z’,’d’,’e’, ‘f’, ‘u’, ‘v’, ‘w’ or ‘.’ where each element of the list refers to
the columns of data in order. To specify that a column has unmarked data use the ‘.’ string. The string ‘-’ can also be used - this
indicats that the current assignment is to be left as is.</p>
<p>Alternately, you can pass <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> a string. In the simplest case, the string is just read in the same way that
the list would have been  - each character corresponds to one column. However, if the string contains an integer, then the next
non-numeric character will be interpreted that many times, so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;3.xy&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;...xy&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>There are still more ways of setting column types with the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">seetas</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;x&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">(</span><span class="s2">&quot;3.xy&quot;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">([</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>All achieve the same effect of setting the same columns as containing x and y data.</p>
<p>Once you have identified columns for the various types, you also have access to utility attributes to access those columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;3.xye&#39;</span>
<span class="n">d</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">e</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that if <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> is not set then attempting to use the quick access column attributes will
result in an exception. Once the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute is set, a further set of <em>virtual</em> or <em>derived</em> column attributes
become available.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xyz&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">r</span> <span class="c1"># The magnitude of the point x,y,z</span>
<span class="n">d</span><span class="o">.</span><span class="n">q</span> <span class="c1"># The angle in the x-y plane relative to the x axis</span>
<span class="n">d</span><span class="o">.</span><span class="n">p</span> <span class="c1"># The angle relative to the z axis</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xyz..uvw&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">r</span> <span class="c1"># the magnitude of (u,v,w)</span>
<span class="n">d</span><span class="o">.</span><span class="n">q</span> <span class="c1"># The angle in the x-y plane of (u,v) relative to +x</span>
<span class="n">d</span><span class="o">.</span><span class="n">p</span> <span class="c1"># The angle of (u,v,w) relatiuve to +z</span>
</pre></div>
</div>
<p>Where fewer than 3 or 6 dimensions are specified, these virtual columns fallback to working with the appropriate
reduced number dimensions.</p>
<p>There are some more convenience ways to set which columns to use as x,y,z etc.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">:</span><span class="s2">&quot;Y Column title&quot;</span><span class="p">}</span>
 <span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span>
 <span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;Y Column title&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;y&quot;</span>
</pre></div>
</div>
<p>In each of these cases, the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> will try to work out what you intended to achieve for maximum flexibility
and convenience when writing code. However it can be fooled if one of your columns is called ‘x’ or ‘y’ !</p>
</section>
<section id="reading-column-types">
<h4>Reading Column Types<a class="headerlink" href="#reading-column-types" title="Link to this heading">¶</a></h4>
<p>The normal representation of <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> is as a list, but it also has a string conversion available. You can also find which column
has been assigned as ‘x’, ‘y’ etc. by treating the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> as a dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">column_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;One&quot;</span><span class="p">,</span><span class="s2">&quot;Two&quot;</span><span class="p">,</span><span class="s2">&quot;three&quot;</span><span class="p">,</span><span class="s2">&quot;Four&quot;</span><span class="p">]</span>
<span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xy.z&quot;</span>

<span class="nb">print</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">)</span> <span class="c1">#[&#39;x&#39;,&#39;y&#39;,&#39;.&#39;,&#39;z&#39;]</span>
<span class="nb">print</span> <span class="n">d</span><span class="o">.</span><span class="n">setas</span> <span class="c1">#&#39;xy.z&#39;</span>
<span class="nb">print</span> <span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="c1"># &quot;One&quot;</span>
<span class="nb">print</span> <span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="p">[</span><span class="s2">&quot;#x&quot;</span><span class="p">]</span> <span class="c1"># 0</span>
</pre></div>
</div>
<p>Note that the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute supports reading keys that are either the single letter t get the name of the column or the letter
preceded by a # character to get the number of the column.</p>
<p>Alternatively, and equivalently, you can access the column indexes via attributes of <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a>:</p>
<blockquote>
<div><p>d.setas.has_xcol # True
d.setas.has_ucol # False
d.setas.ycol # [1]
d.setas.xcol # 0</p>
</div></blockquote>
</section>
<section id="implied-column-assignments">
<h4>Implied Column Assignments<a class="headerlink" href="#implied-column-assignments" title="Link to this heading">¶</a></h4>
<p>If you do not specify the column types via the setas attributes, then <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> will try to guess sensible columns assignments based on the number
of columns in your data file. These default assignments are only done at the point at which the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute is consulted. The default
assignments are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Number of Columns</p></th>
<th class="head"><p>Assignments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2</p></td>
<td><p>x, y</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>x, y, e</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>x, d, y, e</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>x, y, u, v, w</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>x, y, z, u, v, w</p></td>
</tr>
</tbody>
</table>
</section>
<section id="swapping-and-rotating-column-assignments">
<h4>Swapping and Rotating Column Assignments<a class="headerlink" href="#swapping-and-rotating-column-assignments" title="Link to this heading">¶</a></h4>
<p>Finally, if the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute has been set with <em>x</em>, <em>y</em> (and <em>z</em>) columns then these assignments can be
swapped around by the <strong>invert</strong> operator <strong>~</strong>. This either swaps <em>x</em> and <em>y</em> with eir associated errorbars for 2-D datasets, or rotates
<em>x</em> to <em>y</em>, <em>y</em> to <em>z</em> and <em>z</em> to <em>x</em> )again with their associated errors bars.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xye&quot;</span>
<span class="nb">print</span> <span class="n">d</span><span class="o">.</span><span class="n">setas</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">]</span>
<span class="n">e</span><span class="o">=~</span><span class="n">d</span>
<span class="nb">print</span> <span class="n">e</span><span class="o">.</span><span class="n">setas</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="printing-the-complete-data">
<h3>Printing the Complete <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a><a class="headerlink" href="#printing-the-complete-data" title="Link to this heading">¶</a></h3>
<p>If the optional <em>tabulate</em> package is installed, then a pretty formatted representation of the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> can be generated using:</p>
<blockquote>
<div><p>print(repr(d))</p>
</div></blockquote>
<p>This will give something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">================================</span>  <span class="o">=============</span>  <span class="o">============</span>  <span class="o">===========</span>
<span class="n">TDI</span> <span class="n">Format</span> <span class="mf">1.5</span>                    <span class="n">Temperature</span>    <span class="n">Resistance</span>     <span class="n">Column</span> <span class="mi">2</span>
<span class="n">index</span>                                  <span class="mi">0</span>              <span class="mi">1</span>             <span class="mi">2</span>
<span class="o">================================</span>  <span class="o">=============</span>  <span class="o">============</span>  <span class="o">===========</span>
<span class="n">Stoner</span><span class="o">.</span><span class="n">class</span><span class="p">{</span><span class="n">String</span><span class="p">}</span><span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;Data&#39;&quot;</span>   <span class="mf">291.6</span>          <span class="mf">4.7878</span>        <span class="mf">0.04687595</span>
<span class="n">Measurement</span> <span class="n">Title</span><span class="p">{</span><span class="n">String</span><span class="p">}</span><span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;&#39;&quot;</span>  <span class="mf">291.6</span>          <span class="mf">4.78736</span>       <span class="mf">1.125022</span>
<span class="n">Timestamp</span><span class="p">{</span><span class="n">String</span><span class="p">}</span><span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;&#39;&quot;</span>          <span class="mf">291.6</span>          <span class="mf">4.78788</span>       <span class="mf">2.187542</span>
<span class="n">User</span><span class="p">{</span><span class="n">String</span><span class="p">}</span><span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;&#39;&quot;</span>               <span class="mf">291.6</span>          <span class="mf">4.78758</span>       <span class="mf">3.250062</span>
<span class="n">TDI</span> <span class="n">Format</span><span class="p">{</span><span class="n">Double</span> <span class="n">Float</span><span class="p">}</span><span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;1.5&#39;</span>  <span class="mf">291.6</span>          <span class="mf">4.78782</span>       <span class="mf">4.312583</span>
<span class="n">Loaded</span> <span class="k">as</span><span class="p">{</span><span class="n">String</span><span class="p">}</span><span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;Data&#39;&quot;</span>  <span class="mf">291.6</span>          <span class="mf">4.7878</span>        <span class="mf">5.375103</span>
                                  <span class="mf">291.6</span>          <span class="mf">4.78748</span>       <span class="mf">6.453249</span>
                                  <span class="mf">291.6</span>          <span class="mf">4.7878</span>        <span class="mf">7.515769</span>
                                  <span class="mf">291.6</span>          <span class="mf">4.78789</span>       <span class="mf">8.57829</span>
</pre></div>
</div>
<p>If more columns exist in the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> then the <em>repr</em> method attempts to pick ‘interesting’ columns. Thealgorithm will prioritise showing columns
that have been assigned a meaning with the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute. If there are space for further columns, then the last column will be shown
and other columns that follow from any that are marked in <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a>. If no columns are marked as interesting, then the first n-2 columns and
the last column will be shown.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====================</span>  <span class="o">=====================</span>  <span class="o">=====================</span>  <span class="o">====================</span>  <span class="o">===================</span>  <span class="o">=============</span>  <span class="o">==============</span>
<span class="n">TDI</span> <span class="n">Format</span> <span class="mf">1.5</span>        <span class="n">Magnetic</span> <span class="n">Field</span> <span class="p">(</span><span class="n">Oe</span><span class="p">)</span>       <span class="n">Moment</span> <span class="p">(</span><span class="n">emu</span><span class="p">)</span>        <span class="n">M</span><span class="o">.</span> <span class="n">Std</span><span class="o">.</span> <span class="n">Err</span><span class="o">.</span> <span class="p">(</span><span class="n">emu</span><span class="p">)</span>     <span class="n">Transport</span> <span class="n">Action</span>           <span class="o">....</span>          <span class="n">Map</span> <span class="mi">16</span>
<span class="n">index</span>                        <span class="mi">3</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>                  <span class="mi">4</span> <span class="p">(</span><span class="n">y</span><span class="p">)</span>                    <span class="mi">5</span>                     <span class="mi">6</span>                                  <span class="mi">71</span>
<span class="o">====================</span>  <span class="o">=====================</span>  <span class="o">=====================</span>  <span class="o">====================</span>  <span class="o">===================</span>  <span class="o">=============</span>  <span class="o">==============</span>
<span class="n">Stoner</span><span class="o">.</span><span class="n">class</span><span class="p">{</span><span class="n">String</span><span class="p">}</span>  <span class="mf">0.990880310535431</span>      <span class="o">-</span><span class="mf">5.83640043200129e-06</span>  <span class="mf">8.83351337362955e-09</span>  <span class="mf">1.0</span>                                 <span class="n">nan</span>
<span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;Data&#39;&quot;</span>           <span class="mf">0.965473115444183</span>      <span class="o">-</span><span class="mf">5.82915649064088e-06</span>  <span class="mf">1.23199616933718e-08</span>  <span class="mf">1.0</span>                  <span class="o">...</span>            <span class="n">nan</span>
<span class="n">Title</span><span class="p">,{</span><span class="n">String</span><span class="p">}</span><span class="o">=</span>       <span class="mf">1.16873073577881</span>       <span class="o">-</span><span class="mf">5.82160118818014e-06</span>  <span class="mf">8.92093033864879e-09</span>  <span class="mf">1.0</span>                  <span class="o">...</span>            <span class="n">nan</span>
<span class="sa">b</span><span class="s1">&#39;None&#39;</span>               <span class="mf">1.13061988353729</span>       <span class="o">-</span><span class="mf">5.8201045325249e-06</span>   <span class="mf">1.07142611311115e-08</span>  <span class="mf">1.0</span>                  <span class="o">...</span>            <span class="n">nan</span>
<span class="n">Fileopentime</span><span class="p">{</span><span class="n">String</span><span class="p">}</span>  <span class="mf">1.33387744426727</span>       <span class="o">-</span><span class="mf">5.83922456812945e-06</span>  <span class="mf">1.02539653165381e-08</span>  <span class="mf">1.0</span>                  <span class="o">...</span>            <span class="n">nan</span>
<span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&#39;3540392668.062   1.49902403354645       -5.81961870971478e-06  1.04490646832536e-08  1.0                  ...            nan</span>
</pre></div>
</div>
<p>The table header lists the column titles, numerical indices for each column and the assignment in the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute.</p>
<p>If the file has more than 256 rowns, then the first 128 rows and last 128 rows will be shown with a row of <em>…</em> to show the split.</p>
<p>Many of the methods in the Stoner package return a copy of the current <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stoner.Data</span></code></a> object and in ipython consoles and jupyter notebooks
these will get printed out using the table formats above. This may be more than is required, in which case you can set options in the Stoner
package to control the output format.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>from Stoner import Options
Options.short_data_repr = True # or &quot;short_repr&quot; for short representations of all objects.
print(repr(d))
&gt;&gt;&gt; TDI_Format_RT.txt(&lt;class &#39;Stoner.Data&#39;&gt;) of shape (1676, 3) (xy.) and 6 items of metadata
</pre></div>
</div>
</section>
<section id="working-with-columns-of-data">
<h3>Working with columns of data<a class="headerlink" href="#working-with-columns-of-data" title="Link to this heading">¶</a></h3>
<p>This is all very well, but often you want to examine a particular column of data
or a particular row:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">([</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>In the first example, the first column of numeric data will be returned. In the
second example, the column headers will first be checked for one labeled exactly
<em>Temperature</em> and then if no column is found, the column headers will be
searched using <em>Temperature</em> as a regular expression. This would then
match <em>Temperature (K)</em> or <em>Sample Temperature</em>.  The third
example results in a 2 dimensional numpy array containing two columns in the
order that they appear in the list (ie not the order that they are in the data
file). For completeness, the <a class="reference internal" href="../classes/Stoner.Data.column.html#Stoner.Data.column" title="Stoner.Data.column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.column()</span></code></a> method also allows one to
pass slices to select columns and should do the expected thing.</p>
<p>There are a couple of convenient short cuts. Firstly the <em>floormod</em> operator //
is an alias for the <a class="reference internal" href="../classes/Stoner.Data.column.html#Stoner.Data.column" title="Stoner.Data.column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.column()</span></code></a> method and secondly for working
with cases where the column headers are not the same as the names of any of the attributes
of the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">//</span><span class="s2">&quot;Temperature&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">Temperature</span>
<span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>all return the same data.</p>
<p>Whenever the Stoner package needs to refer to a column of data, you cn specify it in a number of ways:-</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>As an integer where the first column on the left is index 0</p></li>
<li><dl class="simple">
<dt>As a string. if the string matches a column header exactly then the index of that column is returned.</dt><dd><p>If the string fails to match any column header it is compiled as a regular expression and then that
is tried as a match. If multiple columns match then only the first is returned.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>As a regular expression directly - this is similar to the case above with a string, but allows you to pass a pre-compiled regular</dt><dd><p>expression in directly with any extra options (like case insensitivity flags) set.</p>
</dd>
</dl>
</li>
<li><p>As a slice object (ee.g. <code class="docutils literal notranslate"><span class="pre">0:10:2</span></code>) this is expanded to a list of integers.</p></li>
<li><dl class="simple">
<dt>As a list of any of the above, in which case the column finding routine is called recursively in turn for each element of the list and</dt><dd><p>the final result would be to use a list of column indices.</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<dl class="simple">
<dt>For example::</dt><dd><p>import re
col=re.compile(‘^temp’,re.IGNORECASE)
d.column(col)</p>
</dd>
</dl>
</section>
<section id="working-with-complete-rows-of-data">
<h3>Working with complete rows of data<a class="headerlink" href="#working-with-complete-rows-of-data" title="Link to this heading">¶</a></h3>
<p>Rows don’t have labels, so are accessed directly by number:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>The second example uses a slice to pull out more than one row. This syntax also
supports the full slice syntax which allows one to, for example, decimate the
rows, or directly pull out the last fews rows in the file.</p>
</section>
<section id="special-magic-when-working-with-subsets-of-data">
<h3>Special Magic When Working with Subsets of Data<a class="headerlink" href="#special-magic-when-working-with-subsets-of-data" title="Link to this heading">¶</a></h3>
<p>As mentioned above, the data in a <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> is a special siubclass of numpy’s Masked Array - <code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code>.
A DataArray understands that columns can have names and can be assigned to hold specific types of data - x,y,z values etc. In
fact, the logic used for the column names and setas attribute in a <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> is actually supplied by the
<code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code>. When you index a Data or it’s data, the resulting data remembers it’s column names and assignments
and these can be used directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="nb">print</span> <span class="n">r</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">r</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
<p>In addition to the column assignments, <code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code> also keeps a track of the row numbers and makes them available via
the <em>i</em> attribute.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">i</span> <span class="c1"># [0,1,2,3...,len(d)]</span>
<span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">r</span><span class="o">.</span><span class="n">i</span> <span class="c1"># 10</span>
<span class="n">r</span><span class="o">.</span><span class="n">column_headers</span>
</pre></div>
</div>
<p>You can reset the row numbers by assigning a value to the <em>i</em> attribute.</p>
<p>A single column of data also gains a <em>.name</em> attribute that matches its column_header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">=</span><span class="n">d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">column_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#True</span>
</pre></div>
</div>
</section>
<section id="manipulating-the-metadata">
<h3>Manipulating the metadata<a class="headerlink" href="#manipulating-the-metadata" title="Link to this heading">¶</a></h3>
<p>What happens if you use a string and not a number in the above examples ?:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;User&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>in this case, it is assumed that you meant the metadata with key <em>User</em>.
To get a list of possible keys in the metadata, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">dir</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">dir</span><span class="p">(</span><span class="s1">&#39;Option\:.*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the first case, all of the keys will be returned in a list. In the second,
only keys matching the pattern will be returned – all keys containing
<em>Option:</em>. For compatibility with normal opython semantics: <a class="reference internal" href="../classes/Stoner.Data.keys.html#Stoner.Data.keys" title="Stoner.Data.keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.keys()</span></code></a> is
synonymous with <a class="reference internal" href="../classes/Stoner.Data.dir.html#Stoner.Data.dir" title="Stoner.Data.dir"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.dir()</span></code></a>.</p>
<p>If the string you supply to get the metadata item does not exactly match an item of
metadata, then it is interpreted as a regular expression to try and match against all the
items of metadata. In this case, rather than returning a single item, all of the
matching metadata is returned as a dictionary. PAssing a compiled regular epxression
as the item name also has the same effect - this is useful if the regular expression
you want to match is also an exact match to one particular metadata name.</p>
<p>We mentioned above that the metadata also keeps a note of the expected type of
the data. You can get at the metadata type for a particular key like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>to get a dictionary of all of the types associated with each key you could do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">dir</span><span class="p">(),</span><span class="n">d</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">dir</span><span class="p">())))</span>
</pre></div>
</div>
<p>but an easier way would be to use the <code class="xref py py-attr docutils literal notranslate"><span class="pre">typeHintedDict.types</span></code> attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">types</span>
</pre></div>
</div>
</section>
<section id="more-on-indexing-the-data">
<h3>More on Indexing the data<a class="headerlink" href="#more-on-indexing-the-data" title="Link to this heading">¶</a></h3>
<p>There are a number o other forms of indexing supported for <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a>
objects.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">,[</span><span class="s1">&#39;Voltage&#39;</span><span class="p">,</span><span class="s1">&#39;Temp&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The first variant just returns the data in the 11th row, first column (remember
indexing starts at 0). The second variant returns the first 10 values in the
first column. The third variant demonstrates that columns can be indexed by
string as well as number, and the last variant demonstrates indexing
multiplerows and columns – in this case the first 10 values of the Voltage and
Temp columns.</p>
<p>You might think of the data as being a list of records, where each column is a
field in the record. Numpy supports this type of structured record view of data
and the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object provides the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.records" title="Stoner.Data.records"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.records</span></code></a>
attribute to d this. This read-only attribute is just providing an alternative
view of the same data.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">records</span>
</pre></div>
</div>
<p>Finally the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.dict_records" title="Stoner.Data.dict_records"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.dict_records</span></code></a> atrtibute does the same thing, but presetns the data as an array of dictionaries, where the
keys are the column names and each dictionary represents a single row.</p>
<section id="selecting-individual-rows-and-columns-of-data">
<h4>Selecting Individual rows and columns of data<a class="headerlink" href="#selecting-individual-rows-and-columns-of-data" title="Link to this heading">¶</a></h4>
<p>Many of the function in the Stoner module index columns by searching the column
headings. If one wishes to find the numeric index of a column then the
<a class="reference internal" href="../classes/Stoner.Data.find_col.html#Stoner.Data.find_col" title="Stoner.Data.find_col"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.find_col()</span></code></a> method can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="s1">&#39;Temp.*&#39;</span><span class="p">)</span>
<span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">([</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Resistance&#39;</span><span class="p">])</span>
<span class="n">index</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">find_col</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[A-Z]&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><a class="reference internal" href="../classes/Stoner.Data.find_col.html#Stoner.Data.find_col" title="Stoner.Data.find_col"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.find_col()</span></code></a> takes a number of different forms. If the argument
is an integer then it returns (trivially) the same integer, a string argument is
first checked to see if it exactly matches one of the column headers in which
case the number of the matching column heading is returned. If no exact match is
found then a regular expression search is carried out on the column headings. In
both cases, only the first match is returned. If the string still doesn’t match, then
the string is checked to see if it can be cast to an integer, in which case the integer value is used.</p>
<p>The final three examples given above
both return a list of indices, firstly using a slice construct - in this case
the result is trivially the same as the slice itself, and in the second example by
passing a list of column headers to look for. The final example uses a compiled
regular expression. Unlike passing a string which contains a regular expression,
passing a compiled regular expression will return a list of all columns that
match. This distinction allows you to use a unique partial string to match just
one column - but if you really want all possible columns that would match the
pattern, then you can compile the regular expression and pass that instead.</p>
<p>This is the function that is used internally by <a class="reference internal" href="../classes/Stoner.Data.column.html#Stoner.Data.column" title="Stoner.Data.column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.column()</span></code></a>,
<a class="reference internal" href="../classes/Stoner.Data.search.html#Stoner.Data.search" title="Stoner.Data.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.search()</span></code></a> etc and for this reason the trivial integer and slice
forms are implemented to allow these other functions to work with multiple
columns.</p>
<p>Sometimes you may want to iterate over all of the rows or columns in a data set.
This can be done quite easily:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">rows</span><span class="p">():</span>
      <span class="nb">print</span> <span class="n">row</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">columns</span><span class="p">():</span>
      <span class="nb">print</span> <span class="n">column</span>
<span class="o">......</span>
</pre></div>
</div>
<p>If there is no mask set, then the first example could also have been written more compactly as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
      <span class="nb">print</span> <span class="n">row</span>
<span class="o">......</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../classes/Stoner.Data.rows.html#Stoner.Data.rows" title="Stoner.Data.rows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.rows()</span></code></a> and <a class="reference internal" href="../classes/Stoner.Data.columns.html#Stoner.Data.columns" title="Stoner.Data.columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.columns()</span></code></a> both take an optional parameter <em>not_masked</em>. If this is True then these iterator
methods will skip over any rows/columns with masked out data values. When iterating over the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> instance directly the
masked rows are skipped over.</p>
</div>
</section>
<section id="searching-sectioning-and-filtering-the-data">
<h4>Searching, sectioning and filtering the data<a class="headerlink" href="#searching-sectioning-and-filtering-the-data" title="Link to this heading">¶</a></h4>
<section id="searching">
<h5>Searching<a class="headerlink" href="#searching" title="Link to this heading">¶</a></h5>
<p>In many cases you do not know which rows in the data file are of interest - in
this case you want to search the data.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="mf">4.2</span><span class="p">,</span><span class="n">accuracy</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="mf">4.2</span><span class="p">,[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="s1">&#39;Resistance&#39;</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">10</span> <span class="ow">and</span>
              <span class="n">x</span><span class="o">&lt;</span><span class="mi">1000</span> <span class="ow">and</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1000</span><span class="p">,[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="s1">&#39;Resistance&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The general form is <code class="docutils literal notranslate"><span class="pre">Data.search(&lt;search</span> <span class="pre">column&gt;,&lt;search</span> <span class="pre">term&gt;[,&lt;listof</span> <span class="pre">return</span> <span class="pre">columns&gt;])</span></code></p>
<p>The first example will return all the rows where the value of the
<em>Tenperature</em> column is 4.2. The second example is the same, but only
returns the values from the <em>Temperature</em>, and <em>Resistance</em>
columns. The rules for selecting the columns are the same as for the
Data.column method above – strings are matched against column headers and
integers select column by number.</p>
<p>The third and fourth examples above demonstrate the use of a function as the
search value. This allows quite complex search criteria to be used. The function
passed to the search routine should take two parameters – a floating point
number and a numpy array of floating point numbers and should return either
<strong>True</strong> or <strong>False</strong>. The function is evaluated for each row in the
data file and is passed the value corresponding to the search column as the
first parameter while the second parameter contains a list of all of the values
in the row to be returned. If the search function returns True, then the row is
returned, otherwise it isn’t. In thr last example, the final parameter can
either be a list of columns or a single column. The rules for indexing columns
are the same as used for the <a class="reference internal" href="../classes/Stoner.Data.find_col.html#Stoner.Data.find_col" title="Stoner.Data.find_col"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.find_col()</span></code></a> method.</p>
<p>The ‘accuracy’ keyword parameter sets the level of accuracy to accept when testing
equality or ranges (i.e. when the value parameter is a float or a tuple) - this avoids
the problem of rounding errors with floating point arithmetic. The default is accuracy is 0.0.</p>
</section>
<section id="filtering">
<h5>Filtering<a class="headerlink" href="#filtering" title="Link to this heading">¶</a></h5>
<p>Sometimes you may want not to get the rows of data that you are looking for as a
separate array, but merely mark them for inclusion (or exclusion) from subsequent
operations. This is where the masked array (see ‘<a class="reference internal" href="#maskeddata"><span class="std std-ref">Masked Data and Why You Care</span></a>) comes into its own.
To select which rows of data have been masked off, use the <a class="reference internal" href="../classes/Stoner.Data.filter.html#Stoner.Data.filter" title="Stoner.Data.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.filter()</span></code></a> method.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">,[</span><span class="s1">&#39;Temp&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>With just a single argument, the filter method takes a complete row at a time and passes it
to the first argument, expecting to get a boolean response (or list olf booleans equal in length
to the number of columns). With a second argument as in the second example, you can specify which
columns are passed to the filtering function in what order. The second argument must be a list
of things which can be used to index a column (ie strings, integers, regular expressions).</p>
</section>
<section id="selecting">
<h5>Selecting<a class="headerlink" href="#selecting" title="Link to this heading">¶</a></h5>
<p>A very powerful way to get at just the dat rows you want is to make use of the <a class="reference internal" href="../classes/Stoner.Data.select.html#Stoner.Data.select" title="Stoner.Data.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.select()</span></code></a> method.
This offers a simple way to query which rows have columns matching some criteria.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">Temp</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">Temp__ge</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">T1__lt</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">T2__lt</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">Res__between</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
</pre></div>
</div>
<p>The general form is to provide keyword arguments that are something that can be used to index a column, followed by a double
underscore, followed by and operator. Where more than one keyword argument is supplied, the results of testing each row are logically
ORed. The result of chaining together two separate calls to select will, however, logically AND the two tests. So, in the examples above,
the, first line will assume an implicit equality test and give only those rows with a column <em>Temp</em> equal to 250. The second line gives an
explicit greater than or equal to test for the same column. The third line will select first those rows that have column T1 less than 4.2 <em>or</em>
column T2 less than 5 and then from those select those rows which have a column Res between 100 and 200. The full list of operators is given in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Stoner.Folders.baseFolder.select()</span></code>.</p>
</section>
<section id="sectioning">
<h5>Sectioning<a class="headerlink" href="#sectioning" title="Link to this heading">¶</a></h5>
<p>Another option is to construct a new <cite>Data</cite> object from a section of the data - this is
particularly useful where the <cite>Data</cite> represents data correspondi ng to a set of (x,y,z)
points. For this case the :py:,eth:<cite>Data.section</cite> method can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;x..y.z.&quot;</span>
<span class="n">slab</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.2</span><span class="p">)</span>
<span class="n">line</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">4.7</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">thick_slab</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">))</span>
<span class="n">arbitrary</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="o">-</span><span class="mi">4</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>After the x, y, z data columns are identified, the <a class="reference internal" href="../classes/Stoner.Data.section.html#Stoner.Data.section" title="Stoner.Data.section"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.section()</span></code></a> method works with
‘x’, ‘y’ and ‘z’ keyword arguments which ar then used to search for matching data rows (the arguments to
these keyword arguments follow the same rules as the <a class="reference internal" href="../classes/Stoner.Data.search.html#Stoner.Data.search" title="Stoner.Data.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.search()</span></code></a> method).</p>
<p>A final way of searching data is to look for the closest row to a given value. For this the eponymous method may be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="mf">10.3</span><span class="p">,</span><span class="n">xcol</span><span class="o">=</span><span class="s2">&quot;Search Col&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="mf">10.3</span><span class="p">)</span>
</pre></div>
</div>
<p>If the <em>xcol</em> parameter is not supplied, the value from the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute is used. Since the returned row
is an instance of the <code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code> that has been taken from the original data, it will know what row number it was and
will make that available via it’s <em>i</em> attribute.</p>
</section>
</section>
<section id="find-out-more-about-the-data">
<h4>Find out more about the data<a class="headerlink" href="#find-out-more-about-the-data" title="Link to this heading">¶</a></h4>
<p>Another question you might want to ask is, what are all the unique
values of data in a given column (or set of columns). The Python numpy
package has a function to do this and we have a direct pass through
from the Data object for this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="s1">&#39;Temp&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">column</span><span class="p">,</span><span class="n">return_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The two optional keywords cause the numpy routine to return the
indices of the unique and all non-unique values in the array. The
column is specified in the same way as the <a class="reference internal" href="../classes/Stoner.Data.column.html#Stoner.Data.column" title="Stoner.Data.column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.column()</span></code></a>
method does.</p>
</section>
<section id="copying-data">
<h4>Copying Data<a class="headerlink" href="#copying-data" title="Link to this heading">¶</a></h4>
<p>One of the characteristics of Python that can confuse those used to other
programming languages is that assignments and argument passing is by reference
and not by value. This can lead to unexpected results as you can end up modifying variables
you were not expecting ! To help with creating genuine copies of data Python provides the copy module.
Whilst this works with Data objects, for convenience, the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.clone" title="Stoner.Data.clone"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.clone</span></code></a> attribute is
provided to make a deep copy of a Data object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an attribute not a method, so there are no brackets here !</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">clone</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="modifying-data">
<h2>Modifying Data<a class="headerlink" href="#modifying-data" title="Link to this heading">¶</a></h2>
<section id="appending-data">
<h3>Appending data<a class="headerlink" href="#appending-data" title="Link to this heading">¶</a></h3>
<p>The simplest way to modify some data might be to append some columns or rows.
The Stoner module redefines two standard operators, <code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to
have special meanings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="s1">&#39;some_new_data.txt&#39;</span><span class="p">)</span>
<span class="n">add_rows</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="n">a</span>
<span class="n">add_columns</span><span class="o">=</span><span class="n">d</span><span class="o">&amp;</span><span class="n">a</span>
</pre></div>
</div>
<p>In these example, <em>a</em> is a second Data object that contains some
data. In the first example, a new Data object is created where the contents
of <em>a</em> are added as new rows after the data in <em>d</em>. Any metadata
that is in <em>a</em> and not in <em>d</em> are added to the metadata as well.
There is a requirement, however, that the column headers of <em>d</em> and
<em>a</em> are the same – ie that the two Data objects appear to represent
similar data.</p>
<p>In the second example, the data in <em>a</em> is added as new columns after the
data from <em>d</em>. In this case, there is a requirement that the two Data
objects have the same number of rows.</p>
<p>These operators are not limited just to Data objects, you can also add numpy
arrays to the Data object to append additional data.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">new_data</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="n">x</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">],[</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">],[</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">]])</span>
<span class="n">new_data</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="n">y</span>
<span class="n">z</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">:</span><span class="mf">2.1</span><span class="p">,</span><span class="s2">&quot;Z&quot;</span><span class="p">:</span><span class="mf">7.5</span><span class="p">}</span>
<span class="n">new_data</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="n">z</span>
<span class="n">new_data</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span>
<span class="n">column</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">new_data</span><span class="o">=</span><span class="n">d</span><span class="o">&amp;</span><span class="n">column</span>
</pre></div>
</div>
<p>In the first example above, we add a single row of data to <em>d</em>. This
assumes that the number of elements in the array matches the number of columns
in the data file. The second example is similar but this time appends a 2
dimensional numpy array to the data. The third example demonstrates adding data from a dictionary.
In this case the keys of the dictionary are used to determine which column the values are added
to. If their columns that don’t match one of the dictionary keys, then a <code class="docutils literal notranslate"><span class="pre">NaN</span></code> is inserted. If there
are keys that don’t match columns labels, then new columns are added to the data set, filled with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.
In the fourth example, each element in the list is added in turn to <em>d</em>. A similar effect would be achieved by doing
<code class="docutils literal notranslate"><span class="pre">new_data=d+x+y+z</span></code>.</p>
<p>The last example appends a numpy array as
a column to <em>d</em>. In this case the requirement is that the numpy array has
the same or fewer rows of data as <em>d</em>.</p>
</section>
<section id="id1">
<h3>Working with Columns of Data<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<section id="changing-individual-columns-of-data">
<h4>Changing Individual Columns of Data<a class="headerlink" href="#changing-individual-columns-of-data" title="Link to this heading">¶</a></h4>
<p>The <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.data" title="Stoner.Data.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.data</span></code></a> attribute is not simply a 2D numpy array, but a special subclass <code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code>, but still
can be directly modified like any other numpy array like class might be. If, however, the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data.setas" title="Stoner.Data.setas"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Data.setas</span></code></a> attribute has
been used to identify columns as containing x,y,z,u,v,w,d,e or f type data, then the correspondign attributes can be written
to as well as read to directly modify the data without having to keep track any further of which column(s) is indexed.
Thus the following will work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;x..y..z&quot;</span>
<span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="mf">5.0</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="o">/</span><span class="n">d</span><span class="o">.</span><span class="n">z</span>
<span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span>
<span class="n">d</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</pre></div>
</div>
<p>When writing to the column attriobutes you must supply a numpy array with the correct number of elements (although Data will
try to spot and correct if the array needs to be transposed first). If you specify more than one column has a particular type
then you should supply a 2D array with the corresponding number of columns of data setting the attribute.</p>
<p>In order to preserve the behaviour that allows you to set the column assignments by setting the attribute to an index type, the
<a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> checks to see if you are setting something that might be a column index or a numpy array. Thus the following
also works:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Temp&quot;</span> <span class="c1"># Set the Temp column to be x data</span>
<span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="c1"># And set the column to contain a linear array of values from 0 to 300.</span>
</pre></div>
</div>
<p>You cannot set the p,q, or r attributes like this as they are calculated on the fly from the cartesian coordinates.
On the otherhand you can do an efficient conversion to polar coordinates with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">setas</span><span class="o">=</span><span class="s2">&quot;xyz&quot;</span>
<span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">q</span><span class="p">,</span><span class="n">d</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="rearranging-columns-of-data">
<h4>Rearranging Columns of Data<a class="headerlink" href="#rearranging-columns-of-data" title="Link to this heading">¶</a></h4>
<p>Sometimes it is useful to rearrange columns of data. <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> offers a couple of methods to help with this.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">swap_column</span><span class="p">(</span><span class="s1">&#39;Resistance&#39;</span><span class="p">,</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">swap_column</span><span class="p">(</span><span class="s1">&#39;Resistance&#39;</span><span class="p">,</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="n">headers_too</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">setas_too</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">swap_column</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;Temp&#39;</span><span class="p">,</span><span class="s1">&#39;Volt&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Curr&#39;</span><span class="p">)])</span>
<span class="n">d</span><span class="o">.</span><span class="n">reorder_columns</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Volt&#39;</span><span class="p">,</span><span class="s1">&#39;Temp&#39;</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">reorder_columns</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Volt&#39;</span><span class="p">,</span><span class="s1">&#39;Temp&#39;</span><span class="p">],</span><span class="n">header_too</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">setas_too</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../classes/Stoner.Data.swap_column.html#Stoner.Data.swap_column" title="Stoner.Data.swap_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.swap_column()</span></code></a> method takes either a either a tuple (or just a pair of arguments) of column names, indices or a list of such
tuples and swaps the columns accordingly, whilst the <a class="reference internal" href="../classes/Stoner.Data.reorder_columns.html#Stoner.Data.reorder_columns" title="Stoner.Data.reorder_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.reorder_columns()</span></code></a> method takes a
list of column labels or indices and constructs a new data matrix out of those columns in the new order.
The <code class="docutils literal notranslate"><span class="pre">headers_too=False</span></code> options, as the name suggests, cause the column headers not be rearranged.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The addition of the setas_too keyword to swap the column assignments around as well is new in 0.5rc1</p>
</div>
</section>
<section id="renaming-columns-of-data">
<h4>Renaming Columns of Data<a class="headerlink" href="#renaming-columns-of-data" title="Link to this heading">¶</a></h4>
<p>As a convenience, <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> also offers a useful method to rename data columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;old_name&#39;</span><span class="p">,</span><span class="s1">&#39;new_name&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;new_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively,of course, one could just edit the column_headers attribute.</p>
</section>
<section id="inserting-columns-of-data">
<h4>Inserting Columns of Data<a class="headerlink" href="#inserting-columns-of-data" title="Link to this heading">¶</a></h4>
<p>The append columns operator <strong>&amp;</strong> will only add columns to the end of a
dataset. If you want to add a column of data in the middle of the data set then
you should use the <a class="reference internal" href="../classes/Stoner.Data.add_column.html#Stoner.Data.add_column" title="Stoner.Data.add_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.add_column()</span></code></a> method.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Column Header&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)),</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Column Header&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">Index</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Column Header&#39;</span><span class="p">,</span><span class="n">func_args</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>The first example simply adds a column of data to the end of the dataset and
sets the new column headers. The second variant  inserts the new column before
column <em>Index</em>. <em>Index</em> follows the same rules as for the
<a class="reference internal" href="../classes/Stoner.Data.column.html#Stoner.Data.column" title="Stoner.Data.column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.column()</span></code></a> method. In the third example, the new column data is
generated by applying the specified function. The function is passed s dingle
row as a 1D numpy array and any of the keyword, argument pairs passed in a
dictionary to the optional <em>func_args</em> argument.</p>
<p>The <a class="reference internal" href="../classes/Stoner.Data.add_column.html#Stoner.Data.add_column" title="Stoner.Data.add_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.add_column()</span></code></a> method returns a copy of the Data object
itself as well as modifying the object. This is to allow the method to be chained
up with other methods for more compact code writing.</p>
</section>
</section>
<section id="deleting-rows-of-data">
<h3>Deleting Rows of Data<a class="headerlink" href="#deleting-rows-of-data" title="Link to this heading">¶</a></h3>
<p>Removing complete rows of data is achieved using the <a class="reference internal" href="../classes/Stoner.Data.del_rows.html#Stoner.Data.del_rows" title="Stoner.Data.del_rows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.del_rows()</span></code></a>
method.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">(</span><span class="s1">&#39;X Col&#39;</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">(</span><span class="s1">&#39;X Col&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">300</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">(</span><span class="s1">&#39;X Col&#39;</span><span class="p">,(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">(;</span><span class="n">X</span> <span class="n">Col</span><span class="s1">&#39;,(100,200),invert=True)</span>
</pre></div>
</div>
<p>The first variant will delete row 10 from the data set (where the first row will
be row 0). You can also supply a list or slice (as in the second example) to
<a class="reference internal" href="../classes/Stoner.Data.del_rows.html#Stoner.Data.del_rows" title="Stoner.Data.del_rows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.del_rows()</span></code></a> to delete multiple rows.</p>
<p>If you do not know in advance which row to delete, then the remiaining
variants provide more advanced options. The third variant searches for and
deletes all rows in which the specified column contains <em>value</em>. The
fourth variant selects which ros to delete by calling a user supplied function
for each row. The user supplied function is the same in form and definitition as
that used for the <a class="reference internal" href="../classes/Stoner.Data.search.html#Stoner.Data.search" title="Stoner.Data.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.search()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">user_func</span><span class="p">(</span><span class="n">x_val</span><span class="p">,</span><span class="n">row_as_array</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">True</span> <span class="ow">or</span> <span class="kc">False</span>
</pre></div>
</div>
<p>The final two variants above, use a tuple to select the data. The final example makes
use of the <em>invert</em> keyword argument to reverse the sense used to selkect tows. In both cases
rows are deleted(kept for <em>invert</em> = True) if the specified column lies between the maximum and minimum
values of the tuple. The test is done inclusively. Any length two iterable object can be used
for specifying the bounds. Finally, if you call <a class="reference internal" href="../classes/Stoner.Data.del_rows.html#Stoner.Data.del_rows" title="Stoner.Data.del_rows"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.del_rows()</span></code></a> with no arguments at all, then
it removes all rows where at least one column of data is masked out.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># Mask all rows where the first column is greater than 50</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_rows</span><span class="p">()</span> <span class="c1"># Then delete them.</span>
</pre></div>
</div>
<p>For simple caases where the row to be deleted can be expressed as an integer or list of integers,
the subtration operator can be used.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="n">d</span><span class="o">-</span><span class="mi">2</span>
<span class="n">e</span><span class="o">=</span><span class="n">d</span><span class="o">-</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">d</span><span class="o">-=-</span><span class="mi">1</span>
</pre></div>
</div>
<p>The final form looks stranger than it is - it simply deletes the last row of data in place.</p>
</section>
<section id="deleting-columns-of-data">
<h3>Deleting Columns of Data<a class="headerlink" href="#deleting-columns-of-data" title="Link to this heading">¶</a></h3>
<p>Deleting whole columns of data can be done by referring to a column by index or
column header - the indexing rules are the same as used for the
<a class="reference internal" href="../classes/Stoner.Data.column.html#Stoner.Data.column" title="Stoner.Data.column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.column()</span></code></a> method.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">del_column</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">del_column</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, there is an operator that can be used to achieve the same effect, in this
case the modulus operator %.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="n">d</span><span class="o">%</span><span class="s2">&quot;temperature&quot;</span>
<span class="n">e</span><span class="o">=</span><span class="n">d</span><span class="o">%</span><span class="mi">1</span>
<span class="n">d</span><span class="o">%=-</span><span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="sorting-data">
<h3>Sorting Data<a class="headerlink" href="#sorting-data" title="Link to this heading">¶</a></h3>
<p>Data can be sorted by one or more columns, specifying the columns as a number or
string for single columns or a list or tuple of strings or numbers for multiple
columns. Currently only ascending sorts are supported.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;Temp&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;Temp&#39;</span><span class="p">,</span><span class="s1">&#39;Gate&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="saving-data">
<span id="save"></span><h3>Saving Data<a class="headerlink" href="#saving-data" title="Link to this heading">¶</a></h3>
<p>Only saving data in the <em>TDI format</em> and as comma or tab deliminated formats is supported.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">d</span><span class="o">=</span><span class="n">Stoner</span><span class="o">.</span><span class="n">CSVFile</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the first case, the filename used tosave the data is determined from the
filename attribute of the Data object. This will have been set when the
filewas loaded from disc.</p>
<p>If the filename attribute has not been set eg if the Data object was
created from scratch, then the <a class="reference internal" href="../classes/Stoner.Data.save.html#Stoner.Data.save" title="Stoner.Data.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Data.save()</span></code></a> method will cause a dialogue
box to be raised so that the user can supply a filename.</p>
<p>In the second variant, the supplied filename is used and the filename attribute
is changed to match this ie <code class="docutils literal notranslate"><span class="pre">d.filename</span></code> will always return the last
filename used for a load or save operation.</p>
<p>The third is similar but convert the file to <code class="docutils literal notranslate"><span class="pre">cvs</span></code> format while the fourth also
specifies that the eliminator is a tab character.</p>
</section>
<section id="exporting-data-to-pandas">
<h3>Exporting Data to pandas<a class="headerlink" href="#exporting-data-to-pandas" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../classes/Stoner.Data.to_pandas.html#Stoner.Data.to_pandas" title="Stoner.Data.to_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stoner.Data.to_pandas()</span></code></a> method can be used to convert a <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stoner.Data</span></code></a> object to
a <em>pandas.DataFrame</em>. The numerical data will be transferred directly, with the DataFrame columns being set up
as a two level index of column headers and column assignments. The Stoner library registers an additional
<em>metadata</em> extension attribute for DataFrames that provides thin sub-class wrapper around the same regular expression
based and type hinting dictionary that is used to store metadata in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Stoner.Data.metadata</span></code>.</p>
<p>The pandas.DataFrame produced by the <a class="reference internal" href="../classes/Stoner.Data.to_pandas.html#Stoner.Data.to_pandas" title="Stoner.Data.to_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stoner.Data.to_pandas()</span></code></a> method is reversibly convertible back to an identical
<a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stoner.Data</span></code></a> object by passing the DataFrame into the constructor of the <a class="reference internal" href="../classes/Stoner.Data.html#Stoner.Data" title="Stoner.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stoner.Data</span></code></a> object.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/StonerLogo2.png" alt="Logo of Stoner Package"/>
            </a></p>
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Loading and Examining Data</a><ul>
<li><a class="reference internal" href="#loading-a-data-file">Loading a data file</a><ul>
<li><a class="reference internal" href="#the-various-flavours-of-the-data-class">The Various Flavours of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code> Class</a><ul>
<li><a class="reference internal" href="#base-classes-and-generic-formats">Base Classes and Generic Formats</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loading-data-from-a-string-or-iterable-object">Loading Data from a string or iterable object</a></li>
<li><a class="reference internal" href="#constructing-data-s-from-scratch">Constructing <code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code> s from Scratch</a><ul>
<li><a class="reference internal" href="#single-argument-constructor">Single Argument Constructor</a></li>
<li><a class="reference internal" href="#two-argument-constructor">Two Argument Constructor</a></li>
<li><a class="reference internal" href="#many-argument-constructor">Many Argument Constructor</a></li>
<li><a class="reference internal" href="#keyword-arguments-in-constructor">Keyword Arguments in Constructor</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#examining-and-basic-manipulations-of-data">Examining and Basic Manipulations of Data</a><ul>
<li><a class="reference internal" href="#data-structure">Data Structure</a><ul>
<li><a class="reference internal" href="#data-column-headers-and-metadata">Data, Column headers and metadata</a></li>
<li><a class="reference internal" href="#masked-data-and-why-you-care">Masked Data and Why You Care</a></li>
</ul>
</li>
<li><a class="reference internal" href="#marking-columns-as-dimensions-the-magic-setas-attribute">Marking Columns as Dimensions: the magic <em>setas</em> attribute</a><ul>
<li><a class="reference internal" href="#setting-column-types">Setting Column Types</a></li>
<li><a class="reference internal" href="#reading-column-types">Reading Column Types</a></li>
<li><a class="reference internal" href="#implied-column-assignments">Implied Column Assignments</a></li>
<li><a class="reference internal" href="#swapping-and-rotating-column-assignments">Swapping and Rotating Column Assignments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#printing-the-complete-data">Printing the Complete <code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a></li>
<li><a class="reference internal" href="#working-with-columns-of-data">Working with columns of data</a></li>
<li><a class="reference internal" href="#working-with-complete-rows-of-data">Working with complete rows of data</a></li>
<li><a class="reference internal" href="#special-magic-when-working-with-subsets-of-data">Special Magic When Working with Subsets of Data</a></li>
<li><a class="reference internal" href="#manipulating-the-metadata">Manipulating the metadata</a></li>
<li><a class="reference internal" href="#more-on-indexing-the-data">More on Indexing the data</a><ul>
<li><a class="reference internal" href="#selecting-individual-rows-and-columns-of-data">Selecting Individual rows and columns of data</a></li>
<li><a class="reference internal" href="#searching-sectioning-and-filtering-the-data">Searching, sectioning and filtering the data</a><ul>
<li><a class="reference internal" href="#searching">Searching</a></li>
<li><a class="reference internal" href="#filtering">Filtering</a></li>
<li><a class="reference internal" href="#selecting">Selecting</a></li>
<li><a class="reference internal" href="#sectioning">Sectioning</a></li>
</ul>
</li>
<li><a class="reference internal" href="#find-out-more-about-the-data">Find out more about the data</a></li>
<li><a class="reference internal" href="#copying-data">Copying Data</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#modifying-data">Modifying Data</a><ul>
<li><a class="reference internal" href="#appending-data">Appending data</a></li>
<li><a class="reference internal" href="#id1">Working with Columns of Data</a><ul>
<li><a class="reference internal" href="#changing-individual-columns-of-data">Changing Individual Columns of Data</a></li>
<li><a class="reference internal" href="#rearranging-columns-of-data">Rearranging Columns of Data</a></li>
<li><a class="reference internal" href="#renaming-columns-of-data">Renaming Columns of Data</a></li>
<li><a class="reference internal" href="#inserting-columns-of-data">Inserting Columns of Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deleting-rows-of-data">Deleting Rows of Data</a></li>
<li><a class="reference internal" href="#deleting-columns-of-data">Deleting Columns of Data</a></li>
<li><a class="reference internal" href="#sorting-data">Sorting Data</a></li>
<li><a class="reference internal" href="#saving-data">Saving Data</a></li>
<li><a class="reference internal" href="#exporting-data-to-pandas">Exporting Data to pandas</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="install.html"
                          title="previous chapter">Installation of Stoner Package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="plotfile.html"
                          title="next chapter">Plotting Data</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/UserGuide/datafile.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form class="search" action="../search.html" method="get">
  <input type="text" name="q"
   placeholder="type to search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="install.html" title="Previous document">Installation of Stoner Package</a>
        </li>
        <li>
          <a href="plotfile.html" title="Next document">Plotting Data</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../index.html">Stoner Package</a></li>
      <li>
        <a href="ugindex.html">The Stoner Python Package User Guide</a>
      </li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; 2013-15, Gavin Burnell et al.Last updated on Apr 16, 2025.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a>
      8.2.3
        with the <a href="http://github.com/irskep/sphinx-better-theme">
          better</a> theme.

  </footer>

  
  </body>
</html>